/**
 * iToolkit v1.0.0
 * Revised in 2016-01-18 16:01:54
 * Released under the ISC License.
 */

!function(e,t){"use strict";function n(e){var t=U(0),n=e.trim().slice(t.length).match(/^\s*(\S+?)\s*(?:,\s*(\S+))?\s+in\s+(.+)$/);return n?{key:n[1],pos:n[2],val:t+n[3]}:{val:e}}function i(e,t,n){var i={};return i[e.key]=t,e.pos&&(i[e.pos]=n),i}function o(e,t,o){f(e,"each");var a,r=v(e),l=e.outerHTML,u=!!J[r],c=J[r]||{tmpl:l},p=e.parentNode,d=document.createComment("riot placeholder"),m=[],h=g(e);p.insertBefore(d,e),o=n(o),t.one("premount",function(){p.stub&&(p=t.root),e.parentNode.removeChild(e)}).on("update",function(){var n=z(o.val,t);q(n)||(a=n?JSON.stringify(n):"",n=n?Object.keys(n).map(function(e){return i(o,e,n[e])}):[]);for(var l=document.createDocumentFragment(),f=m.length,g=n.length;f>g;)m[--f].unmount(),m.splice(f,1);for(f=0;g>f;++f){var v=!a&&o.key?i(o,n[f],f):n[f];m[f]?m[f].update(v):(m[f]=new s(c,{parent:t,isLoop:!0,hasImpl:u,root:W.test(r)?p:e.cloneNode(),item:v},e.innerHTML),m[f]._item=v,m[f].mount(),l.appendChild(m[f].root)),m[f]._item=v}p.insertBefore(l,d),h&&(t.tags[r]=m)}).one("updated",function(){var e=Object.keys(t);k(p,function(n){1!=n.nodeType||n.isLoop||n._looped||(n._visited=!1,n._looped=!0,I(n,t,e))})})}function a(e,t,n){k(e,function(e){if(1==e.nodeType){e.isLoop=e.isLoop||e.parentNode&&e.parentNode.isLoop||e.getAttribute("each")?1:0;var i=g(e);i&&!e.isLoop&&n.push(m(i,e,t)),e.isLoop||I(e,t,[])}})}function r(e,t,n){function i(e,t,i){if(t.indexOf(U(0))>=0){var o={dom:e,expr:t};n.push(b(o,i))}}k(e,function(e){var n=e.nodeType;if(3==n&&"STYLE"!=e.parentNode.tagName&&i(e,e.nodeValue),1==n){var a=e.getAttribute("each");return a?(o(e,t,a),!1):(p(e.attributes,function(t){var n=t.name,o=n.split("__")[1];return i(e,t.value,{attr:o||n,bool:o}),o?(f(e,n),!1):void 0}),g(e)?!1:void 0)}})}function s(e,n,i){function o(){var e=x&&k?f:v||f;p(O.attributes,function(t){g[t.name]=z(t.value,e)}),p(Object.keys(P),function(t){g[t]=z(P[t],e)})}function s(e){for(var t in N)typeof f[t]!==B&&(f[t]=e[t])}function l(){f.parent&&k&&p(Object.keys(f.parent),function(e){var t=!~R.indexOf(e)&&~j.indexOf(e);(typeof f[e]===B||t)&&(t||j.push(e),f[e]=f.parent[e])})}function u(e){if(p(I,function(t){t[e?"mount":"unmount"]()}),v){var t=e?"on":"off";k?v[t]("unmount",f.unmount):v[t]("update",f.update)[t]("unmount",f.unmount)}}var f=D.observable(this),g=S(n.opts)||{},m=G(e.tmpl),v=n.parent,k=n.isLoop,x=n.hasImpl,N=y(n.item),E=[],I=[],O=n.root,L=e.fn,A=O.tagName.toLowerCase(),P={},j=[];L&&O._tag&&O._tag.unmount(!0),this.isMounted=!1,O.isLoop=k,O._tag=this,this._id=_++,b(this,{parent:v,root:O,opts:g,tags:{}},N),p(O.attributes,function(e){var t=e.value;U(/{.*}/).test(t)&&(P[e.name]=t)}),m.innerHTML&&!/^(select|optgroup|table|tbody|tr|col(?:group)?)$/.test(A)&&(m.innerHTML=T(m.innerHTML,i)),this.update=function(e){e=y(e),l(),e&&typeof N===H&&(s(e),N=e),b(f,e),o(),f.trigger("update",e),c(E,f),f.trigger("updated")},this.mixin=function(){p(arguments,function(e){e=typeof e===M?D.mixin(e):e,p(Object.keys(e),function(t){"init"!=t&&(f[t]=d(e[t])?e[t].bind(f):e[t])}),e.init&&e.init.bind(f)()})},this.mount=function(){if(o(),L&&L.call(f,g),r(m,f,E),u(!0),(e.attrs||x)&&(C(e.attrs,function(e,t){O.setAttribute(e,t)}),r(f.root,f,E)),(!f.parent||k)&&f.update(N),f.trigger("premount"),k&&!x)f.root=O=m.firstChild;else{for(;m.firstChild;)O.appendChild(m.firstChild);O.stub&&(f.root=O=v.root)}!f.parent||f.parent.isMounted?(f.isMounted=!0,f.trigger("mount")):f.parent.one("mount",function(){w(f.root)||(f.parent.isMounted=f.isMounted=!0,f.trigger("mount"))})},this.unmount=function(e){var n,i=O,o=i.parentNode;if(o){if(v)n=h(v),q(n.tags[A])?p(n.tags[A],function(e,t){e._id==f._id&&n.tags[A].splice(t,1)}):n.tags[A]=t;else for(;i.firstChild;)i.removeChild(i.firstChild);e?o.removeAttribute("riot-tag"):o.removeChild(i)}f.trigger("unmount"),u(),f.off("*"),O._tag=null},a(m,this,I)}function l(t,n,i,o){i[t]=function(t){var a,r=o._item,s=o.parent;if(!r)for(;s&&!r;)r=s._item,s=s.parent;t=t||e.event;try{t.currentTarget=i,t.target||(t.target=t.srcElement),t.which||(t.which=t.charCode||t.keyCode)}catch(l){}t.item=r,n.call(o,t)===!0||/radio|check/.test(i.type)||(t.preventDefault&&t.preventDefault(),t.returnValue=!1),t.preventUpdate||(a=r?h(s):o,a.update())}}function u(e,t,n){e&&(e.insertBefore(n,t),e.removeChild(t))}function c(e,t){p(e,function(e,n){var i=e.dom,o=e.attr,a=z(e.expr,t),r=e.dom.parentNode;if(e.bool?a=a?o:!1:null==a&&(a=""),r&&"TEXTAREA"==r.tagName&&(a=(""+a).replace(/riot-/g,"")),e.value!==a){if(e.value=a,!o)return void(i.nodeValue=""+a);if(f(i,o),d(a))l(o,a,i,t);else if("if"==o){var s=e.stub,c=function(){u(s.parentNode,s,i)},p=function(){u(i.parentNode,i,s)};a?s&&(c(),i.inStub=!1,w(i)||k(i,function(e){e._tag&&!e._tag.isMounted&&(e._tag.isMounted=!!e._tag.trigger("mount"))})):(s=e.stub=s||document.createTextNode(""),i.parentNode?p():(t.parent||t).one("updated",p),i.inStub=!0)}else if(/^(show|hide)$/.test(o))"hide"==o&&(a=!a),i.style.display=a?"":"none";else if("value"==o)i.value=a;else if(O(o,P)&&o!=j)a&&i.setAttribute(o.slice(P.length),a);else{if(e.bool&&(i[o]=a,!a))return;typeof a!==H&&i.setAttribute(o,a)}}})}function p(e,t){for(var n,i=0,o=(e||[]).length;o>i;i++)n=e[i],null!=n&&t(n,i)===!1&&i--;return e}function d(e){return typeof e===$||!1}function f(e,t){e.removeAttribute(t)}function g(e){return e.tagName&&J[e.getAttribute(j)||e.tagName.toLowerCase()]}function m(e,t,n){var i,o=new s(e,{root:t,parent:n},t.innerHTML),a=v(t),r=h(n);return o.parent=r,i=r.tags[a],i?(q(i)||(r.tags[a]=[i]),~r.tags[a].indexOf(o)||r.tags[a].push(o)):r.tags[a]=o,t.innerHTML="",o}function h(e){for(var t=e;!g(t.root)&&t.parent;)t=t.parent;return t}function v(e){var t=g(e),n=e.getAttribute("name"),i=n&&n.indexOf(U(0))<0?n:t?t.name:e.tagName.toLowerCase();return i}function b(e){for(var t,n=arguments,i=1;i<n.length;++i)if(t=n[i])for(var o in t)e[o]=t[o];return e}function y(e){if(!(e instanceof s||e&&typeof e.trigger==$))return e;var t={};for(var n in e)~R.indexOf(n)||(t[n]=e[n]);return t}function k(e,t){if(e){if(t(e)===!1)return;for(e=e.firstChild;e;)k(e,t),e=e.nextSibling}}function C(e,t){for(var n,i=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;n=i.exec(e);)t(n[1].toLowerCase(),n[2]||n[3]||n[4])}function w(e){for(;e;){if(e.inStub)return!0;e=e.parentNode}return!1}function x(e){return document.createElement(e)}function T(e,t){return e.replace(/<(yield)\/?>(<\/\1>)?/gi,t||"")}function N(e,t){return(t||document).querySelectorAll(e)}function E(e,t){return(t||document).querySelector(e)}function S(e){function t(){}return t.prototype=e,new t}function I(e,t,n){if(!e._visited){var i,o=e.getAttribute("id")||e.getAttribute("name");o&&(n.indexOf(o)<0&&(i=t[o],i?q(i)?i.push(e):t[o]=[i,e]:t[o]=e),e._visited=!0)}}function O(e,t){return e.slice(0,t.length)===t}function L(e){if(!D.render){F||(F=x("style"),F.setAttribute("type","text/css"));var t=document.head||document.getElementsByTagName("head")[0];if(F.styleSheet?F.styleSheet.cssText+=e:F.innerHTML+=e,!F._rendered)if(F.styleSheet)document.body.appendChild(F);else{var n=E("style[type=riot]");n?(n.parentNode.insertBefore(F,n),n.parentNode.removeChild(n)):t.appendChild(F)}F._rendered=!0}}function A(e,t,n){var i=J[t],o=e._innerHTML=e._innerHTML||e.innerHTML;return e.innerHTML="",i&&e&&(i=new s(i,{root:e,opts:n},o)),i&&i.mount?(i.mount(),K.push(i),i.on("unmount",function(){K.splice(K.indexOf(i),1)})):void 0}var D={version:"v2.2.4",settings:{}},_=0,P="riot-",j=P+"tag",M="string",H="object",B="undefined",$="function",W=/^(?:opt(ion|group)|tbody|col|t[rhd])$/,R=["_item","_id","update","root","mount","unmount","mixin","isMounted","isLoop","tags","parent","opts","trigger","on","off","one"],V=0|(e&&e.document||{}).documentMode,q=Array.isArray;D.observable=function(e){e=e||{};var t={},n=0;return e.on=function(i,o){return d(o)&&(typeof o.id===B&&(o._id=n++),i.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(o),o.typed=n>0})),e},e.off=function(n,i){return"*"==n?t={}:n.replace(/\S+/g,function(e){if(i)for(var n,o=t[e],a=0;n=o&&o[a];++a)n._id==i._id&&o.splice(a--,1);else t[e]=[]}),e},e.one=function(t,n){function i(){e.off(t,i),n.apply(e,arguments)}return e.on(t,i)},e.trigger=function(n){for(var i,o=[].slice.call(arguments,1),a=t[n]||[],r=0;i=a[r];++r)i.busy||(i.busy=1,i.apply(e,i.typed?[n].concat(o):o),a[r]!==i&&r--,i.busy=0);return t.all&&"all"!=n&&e.trigger.apply(e,["all",n].concat(o)),e},e},D.mixin=function(){var e={};return function(t,n){return n?void(e[t]=n):e[t]}}(),function(e,t,n){function i(){return s.href.split("#")[1]||""}function o(e){return e.split("/")}function a(e){e.type&&(e=i()),e!=r&&(l.trigger.apply(null,["H"].concat(o(e))),r=e)}if(n){var r,s=n.location,l=e.observable(),u=!1,c=e.route=function(e){e[0]?(s.hash=e,a(e)):l.on("H",e)};c.exec=function(e){e.apply(null,o(i()))},c.parser=function(e){o=e},c.stop=function(){u&&(n.removeEventListener?n.removeEventListener(t,a,!1):n.detachEvent("on"+t,a),l.off("*"),u=!1)},c.start=function(){u||(n.addEventListener?n.addEventListener(t,a,!1):n.attachEvent("on"+t,a),u=!0)},c.start()}}(D,"hashchange",e);var F,U=function(e){var t,n,i,o=/[{}]/g;return function(a){var r=D.settings.brackets||e;return t!==r&&(t=r,i=r.split(" "),n=i.map(function(e){return e.replace(/(?=.)/g,"\\")})),a instanceof RegExp?r===e?a:new RegExp(a.source.replace(o,function(e){return n[~~("}"===e)]}),a.global?"g":""):i[a]}}("{ }"),z=function(){function t(e,t){return e.indexOf(U(0))<0?(e=e.replace(/\n|\r\n?/g,"\n"),function(){return e}):(e=e.replace(U(/\\{/g),"￰").replace(U(/\\}/g),"￱"),t=o(e,a(e,U(/{/),U(/}/))),e=2!==t.length||t[0]?"["+t.map(function(e,t){return t%2?n(e,!0):'"'+e.replace(/\n|\r\n?/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")':n(t[1]),new Function("d","return "+e.replace(/\uFFF0/g,U(0)).replace(/\uFFF1/g,U(1))+";"))}function n(e,t){return e=e.replace(/\n|\r\n?/g," ").replace(U(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),""),/^\s*[\w- "']+ *:/.test(e)?"["+a(e,/["' ]*[\w- ]+["' ]*:/,/,(?=["' ]*[\w- ]+["' ]*:)|}|$/).map(function(e){return e.replace(/^[ "']*(.+?)[ "']*: *(.+?),? *$/,function(e,t,n){return n.replace(/[^&|=!><]+/g,i)+'?"'+t+'":"",'})}).join("")+'].join(" ").trim()':i(e,t)}function i(e,t){return e=e.trim(),e?"(function(v){try{v="+e.replace(l,function(e,t,n){return n?'(("'+n+s+n+")":e})+"}catch(e){}return "+(t===!0?'!v&&v!==0?"":v':"v")+"}).call(d)":""}function o(e,t){var n=[];return t.map(function(t,i){i=e.indexOf(t),n.push(e.slice(0,i),t),e=e.slice(i+t.length)}),e&&n.push(e),n}function a(e,t,n){var i,o=0,a=[],r=new RegExp("("+t.source+")|("+n.source+")","g");return e.replace(r,function(t,n,r,s){!o&&n&&(i=s),o+=n?1:-1,o||null==r||a.push(e.slice(i,s+r.length))}),a}var r={},s='"in d?d:'+(e?"window).":"global)."),l=/(['"\/])(?:[^\\]*?|\\.|.)*?\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function\s*\()|([A-Za-z_$]\w*)/g;return function(e,n){return e&&(r[e]||(r[e]=t(e)))(n)}}(),G=function(e){function t(t){var a=t&&t.match(/^\s*<([-\w]+)/),r=a&&a[1].toLowerCase(),s=i[r]||o,l=x(s);return l.stub=!0,e&&r&&(a=r.match(W))?n(l,t,r,!!a[1]):l.innerHTML=t,l}function n(e,t,n,i){var a,r=x(o),s=i?"select>":"table>";r.innerHTML="<"+s+t+"</"+s,a=r.getElementsByTagName(n)[0],a&&e.appendChild(a)}var i={tr:"tbody",th:"tr",td:"tr",tbody:"table",col:"colgroup"},o="div";return e=e&&10>e,t}(V),K=[],J={};D.tag=function(e,t,n,i,o){return d(i)&&(o=i,/^[\w\-]+\s?=/.test(n)?(i=n,n=""):i=""),n&&(d(n)?o=n:L(n)),J[e]={name:e,tmpl:t,attrs:i,fn:o},e},D.mount=function(e,t,n){function i(e){var t="";return p(e,function(e){t+=", *["+j+'="'+e.trim()+'"]'}),t}function o(){var e=Object.keys(J);return e+i(e)}function a(e){var i;if(e.tagName){!t||(i=e.getAttribute(j))&&i==t||e.setAttribute(j,t);var o=A(e,t||e.getAttribute(j)||e.tagName.toLowerCase(),n);o&&l.push(o)}else e.length&&p(e,a)}var r,s,l=[];if(typeof t===H&&(n=t,t=0),typeof e===M?("*"===e?e=s=o():e+=i(e.split(",")),r=N(e)):r=e,"*"===t){if(t=s||o(),r.tagName)r=N(t,r);else{var u=[];p(r,function(e){u.push(N(t,e))}),r=u}t=0}return r.tagName?a(r):p(r,a),l},D.update=function(){return p(K,function(e){e.update()})},D.mountTo=D.mount,D.util={brackets:U,tmpl:z},typeof exports===H?module.exports=D:"function"==typeof define&&define.amd?define(function(){return e.riot=D}):e.riot=D}("undefined"!=typeof window?window:void 0);var utils={httpGet:function(e,t,n,i){var o=new XMLHttpRequest,e=utils.concatParams(e,t);o.open("GET",e,!0),o.send(null),o.onreadystatechange=function(){if(4===o.readyState&&(i&&"function"==typeof i&&i(),200===o.status)){var e=o.responseText;try{if("string"==typeof e)var t=JSON.parse(e);else var t=e}catch(a){alert("解析错误")}n(t)}}},httpPost:function(e,t,n,i){var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-type","application/json"),o.send(t),o.onreadystatechange=function(){if(4===o.readyState)if(i&&"function"==typeof i&&i(),200===o.status){try{var e=JSON.parse(o.responseText)}catch(t){console.log("解析错误")}n(e)}else console.log("网络错误")}},jsonp:function(e,t,n){var i=Date.now(),o=document.createElement("script"),a=document.getElementsByTagName("head")[0],e=utils.concatParams(e,t);if(t.callback)var r=e,s=t.callback;else{if(e.match(/\?/))var r=e+"&callback=jsonpCallback"+i;else var r=e+"?callback=jsonpCallback"+i;var s="jsonpCallback"+i}o.src=r,a.appendChild(o),window[s]=function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}n(e)},o.onerror=function(){console.log("jsonp error")},o.onload=function(){a.removeChild(o)}},htmlEncode:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText},concatParams:function(e,t){if(e.match(/\?/))var n="&";else var n="?";for(i in t)n=n+i+"="+t[i]+"&";return n=n.replace(/&$/,""),e+n},setCookie:function(e,t,n,i){var o=new Date,i=i||"/";o.setTime(o.getTime()+n),document.cookie=e+"="+escape(t)+";path="+i+";expires="+o.toGMTString()},transBytes:function(e){var t=["B","KB","MB","GB","TB"];if(0==e)return"n/a";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return 0==n?e+t[n]:(e/Math.pow(1024,n)).toFixed(1)+t[n]},transTimes:function(e){var e=parseInt(e,10),t=new Date(1e3*e),n=(new Date).getTime()/1e3,i=n-e;if(86400>i)return t.getHours()+":"+t.getMinutes();if(i>86400&&172800>i)return"昨天";if(i>172800){var o=(t.getFullYear()+"-").substring(2),a=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",r=t.getDate()<10?"0"+t.getDate():t.getDate();return o+a+r}},hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){e.className.trim(),this.hasClass(e,t)||(e.className+=" "+t)},removeClass:function(e,t){if(utils.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},toggleClass:function(e,t){if(utils.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}else e.className+=" "+t},insertAfter:function(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)},insertAfterText:function(e,t){var n=t.parentNode;if(n.lastChild==t)n.appendChild(e);else{var i=t.nextSibling;3===i.nodeType&&(i=i.nextSibling),n.insertBefore(e,i)}},isType:function(e){return function(t){return toString.call(t)==="[object "+e+"]"}},makeArray:function(){return Array.prototype.concat(obj)},extend:function(e,t){for(var n in t)e[n]||(e[n]=t[n])},deepCopy:function(e,t){var t=t||{};for(var n in e)"[object Object]"===toString.call(e[n])?(t[n]={},this.deepCopy(e[n],t[n])):"[object Array]"===toString.call(e[n])?(t[n]=[],this.deepCopy(e[n],t[n])):t[n]=e[n];return t}};utils.extend(utils,{isArray:utils.isType("Array"),isObject:utils.isType("Object"),isFunction:utils.isType("Function"),isElement:function(e){return-1!==toString.call(e).indexOf("Element")}}),utils.extend(utils,{jsLoader:function(){function e(){return d++}function t(e){return e.match(/\.css\??/)}function n(t){this.uri=t,this.cid=e(),this.status=k}function i(e,t){return i.then(e,t).start(),i}function o(e){throw e}function a(e){if(e||f.length)for(var t=0;t<e.task.length;t++){var n=e.task[t];s(n,e)}}function r(e,t){var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e.uri,c.appendChild(i),i=null,e.status=v,n.resolve.call(t)}function s(e,i){function o(t){if("error"===t.type&&(e.status=y),"load"===t.type&&(e.status=v),n.resolve.call(i,e),e.changeStatus){e.changeStatus=!1;for(var o=0;o<C[e.cid].length;o++){var a=C[e.cid][o];n.resolve.call(a.resolver,a.js)}C[e.cid]=null}s.onload=s.onerror=null,c.removeChild(s),s=null}if(m(e.uri))try{e.uri(),e.status=v,n.resolve.call(i)}catch(a){e.status=y,n.resolve.call(i)}else{if(e.status===v)return void n.resolve.call(i);if(t(e.uri))return void r(e,i);if(e.status===b)return e.changeStatus=!0,C[e.cid]=C[e.cid]||[],void C[e.cid].push({js:e,resolver:i});e.status=b;var s=document.createElement("script");s.async=!0,s.src=e.uri,s.onload=s.onerror=o,c.appendChild(s)}}function l(e){var t=u(e);return n.get(t?t:e)}function u(e){return i.alias[e]}var c=document.head||document.getElementsByTagName("head")[0],p={},d=0,f=[],g=utils.isArray,m=utils.isFunction,h=utils.makeArray,v="done",b="inprocess",y="rejected",k="pending",C={};return n.get=function(e){return p[e]||(p[e]=new n(e))},n.resolve=function(e){var t=this;if(t.status++,e&&e.status===y){var n=Error("Source: "+e.uri+" load failed");o(n)}t.status===t.task.length&&setTimeout(function(){t.callback&&t.callback(),t=null,a(f.shift())},7)},i.then=function(e,t){if(!e)return i;g(e)||(e=h(e));for(var n={task:[],callback:t,status:0},o=0;o<e.length;o++)n.task.push(l(e[o]));return f.push(n),i},i.start=function(){return a(f.shift()),i},i.alias={},i}()});var EventCtrl=EC=riot.observable(),iToolkit={};iToolkit.methodRegister=function(e,t){for(var n in iToolkit)if(e===n)return;iToolkit[e]=t},iToolkit.tableExtend={},riot.tag("date-picker","<yield>",function(e){var t=this,n=t.root,i=t.opts.opts||t.opts,o=document.scripts,a="",r="";if(i.path)a=i.path;else{for(var s=0;s<o.length;s++)if(o[s].src&&/iToolkit_pc.min.js|iToolkit_pc.js/.test(o[s].src)){r=o[s].src.replace(/iToolkit_pc.min.js|iToolkit_pc.js/,"");break}a=r+"plugins/laydate/"}var l=i.theme?i.theme:"default";utils.jsLoader([a+"laydate.min.js",a+"/need/laydate.css",a+"/skins/"+l+"/laydate.css"],function(){for(var e=0;e<n.children.length;e++){var i=n.children[e];i.attributes.pTrigger&&(t.pTrigger=i),i.attributes.media&&(t.media=i)}t.resolve(),t.update()}),this.resolve=function(){if(!t.pTrigger&&!t.media)throw"media and pTrigger property was not found in the element";return t.pTrigger===t.media&&(i.elem=i.pTrigger=t.media),"undefined"==typeof t.pTrigger&&(i.elem=t.media),t.pTrigger&&t.media&&t.pTrigger!==t.media&&(i.pTrigger=t.pTrigger,i.elem=t.media),t.pTrigger&&!t.media&&(i.elem=t.pTrigger,i.justChoose=!0),i.pTrigger?void(i.pTrigger.onclick=function(e){laydate(i)}):void laydate(i)}.bind(this)}),riot.tag("dropdown",'<yield> <div class="r-dropdown">{ title }</div> <ul class="r-downdown-menu"> <li class="r-dropdown-list" each="{ data }"><a href="{ link|\'javascript:void(0)\' }">{ name }</a></li> </ul>',function(e){{var t=this;t.root,t.opts.opts||t.opts}}),riot.tag("editable-link",'<a href="javascript:void(0);" if="{ !editable }" onclick="{ open }">{ value }</a> <super-form if="{ editable }" action="{ action }" opts="{ formOpts }"> <input type="text" value="{ parent.value }" name="{ parent.name }" class="editable-link-input"> <input type="submit" value="提交"> <button onclick="{ parent.close }">取消</button> </super-form>',function(e){var t=this;t.editlink=!1;var n=t.root,i=t.opts.opts||t.opts;t.on("mount",function(){t.action=n.getAttribute("action"),t.value=n.getAttribute("text"),t.name=n.getAttribute("name"),t.update()}),this.open=function(e){t.editable=!0,t.update()}.bind(this),this.close=function(e){t.editable=!1,t.update()}.bind(this),t.formOpts={errCallback:function(){i.errCallback(),n.querySelector(".editable-link-input").value=t.value,t.editable=!1,t.update()},callback:function(e){i.callback(),t.value=n.querySelector(".editable-link-input").value,t.editable=!1,t.update()}}}),riot.tag("goto-top",'<div class="itoolkit-goto-top" show="{ showGotoTop }" onclick="{ gotoTop }"> <yield> <span class="itoolkit-goto-top-icon" show="{ showDefault }"><span class="icon-arrowUp"></span></span> </div>',"goto-top .itoolkit-goto-top{ display: block; position: fixed; bottom: 50px; right: 40px; height: 60px; width: 60px; z-index: 10000; text-align: center; opicity: 0.5; cursor: pointer; } goto-top .itoolkit-goto-top .itoolkit-goto-top-icon{ font-size: 3em; margin: auto; float: none; }",function(e){var t=this;t.config=t.opts.opts||t.opts;var n=window.screen.availHeight,i=t.root;t.on("mount",function(){t.root.querySelector(".itoolkit-goto-top").style.bottom=t.config.bottom,t.root.querySelector(".itoolkit-goto-top").style.right=t.config.right,"itoolkit-goto-top-icon"===i.querySelector(".itoolkit-goto-top").firstElementChild.className&&(t.showDefault=!0),window.addEventListener("scroll",t.controlGotoTop)}),t.controlGotoTop=function(){var e=document.body;e.scrollTop>n&&!t.showGotoTop?(t.showGotoTop=!0,t.update()):e.scrollTop<n&&t.showGotoTop&&(t.showGotoTop=!1,t.update())},this.gotoTop=function(e){var t=document.body.scrollTop/100*16,n=setInterval(function(){document.body.scrollTop=document.body.scrollTop-t,document.body.scrollTop<10&&clearInterval(n)},16)}.bind(this)}),riot.tag("loading",'<div class="{itoolkit-loading: true, default: default}" > <yield> </div>',"loading .itoolkit-loading { text-align: center; }",function(e){{var t=this;t.opts.opts||t.opts}t["default"]=!0,t.on("mount",function(){var e=t.root.parentNode,n=window.getComputedStyle(e,null).position;"static"===n&&(e.style.position="relative"),t.childDom=t.root.getElementsByClassName("itoolkit-loading")[0],t.childDom.innerHTML.trim()&&(t["default"]=!1,t.update());var i=parseInt(window.getComputedStyle(t.childDom,null).height.replace("px",""),10);t.root.style.marginTop="-"+i/2+"px"}),t.root.show=function(){t.childDom&&(t.childDom.style.display="block")},t.root.hide=function(){t.childDom&&(t.childDom.style.display="none")}}),riot.tag("modal",'<div class="itoolkit-modal-dialog" riot-style="width:{width}; height:{height}"> <div class="itoolkit-modal-title"> <span>{ title }</span> <div class="itoolkit-modal-close-wrap" onclick="{ close }"> <div class="itoolkit-modal-close"></div> </div> </div> <div class="itoolkit-modal-container"> <yield> </div> </div>',function(e){{var t=this,n=t.opts.opts||t.opts;t.root}for(i in n)t[i]=n[i];t.width=n.width||600,t.height=n.height||"auto",t.on("mount",function(){var e=t.root.querySelector(".itoolkit-modal-container"),i=t.root.querySelector(".itoolkit-modal-title"),o=parseInt(window.getComputedStyle(i,null).height.replace("px",""));n.height&&(e.style.height=t.height-o-2+"px")}),this.close=function(e){t.root.style.display="none",t.onClose&&t.onClose()}.bind(this),document.querySelector("[modal-open-target='"+t.root.id+"']")&&(document.querySelector("[modal-open-target='"+t.root.id+"']").onclick=function(){t.root.style.display="block",t.onOpen&&t.onOpen()}),t.root.open=function(){t.root.style.display="block",t.onOpen&&t.onOpen()},t.root.close=function(){t.root.style.display="none",t.onClose&&t.onClose()},t.root.loadData=function(e,n){n=n||"data",t[n]=e,t.update()}}),riot.tag("paginate",'<div onselectstart="return false" ondragstart="return false"> <div class="paginate"> <li onclick="{ goFirst }">«</li> <li onclick="{ goPrev }">‹</li> </div> <ul class="paginate"> <li each="{ pages }" onclick="{ parent.changePage }" class="{ active: parent.currentPage == page }">{ page }</li> </ul> <div class="paginate"> <li onclick="{ goNext }">›</li> <li onclick="{ goLast }">»</li> </div> <div class="paginate"> <form onsubmit="{ redirect }" style="position:relative;"> <span class="redirect" if="{ redirect }">跳转到<input class="jumpPage" name="page" riot-type={"number"} style="width: 40px;">页 </span> <div class="paginate-tips" riot-style="top: { tipsTop }; left: { tipsLeft }; display: { showTip }"> 请输入1～{ pageCount }之间的数字 </div> <span class="page-sum" if="{ showPageCount }"> 共<em>{ pageCount }</em>页 </span> <span class="item-sum" if="{ showItemCount }"> <em>{ count }</em>条 </span> <input type="submit" style="display: none;"> </form> </div> </div>','.paginate .paginate-tips{ position: absolute; padding: 5px; border: 1px solid #ddd; background-color: #fff; -webkit-box-shadow: 0 0 10px #ccc; box-shadow: 0 0 10px #ccc; } .paginate .paginate-tips:before { content: ""; position: absolute; width: 0; height: 0; top: -16px; left: 10px; border: 8px solid transparent; border-bottom-color: #ddd; } .paginate .paginate-tips:after { content: ""; position: absolute; width: 0; height: 0; top: -15px; left: 10px; border: 8px solid transparent; border-bottom-color: #fff; }',function(e){var t=this,n=t.root,o=t.opts.opts||t.opts;if(t.showTip="none",t.count=o.count||0,t.pagesize=o.pagesize||20,t.pageCount=o.pageCount||Math.ceil(t.count/t.pagesize)||1,t.currentPage=o.currentPage||1,t.url=o.url||"",t.showNumber=o.showNumber||5,t.redirect=o.redirect||!0,t.showPageCount=o.showPageCount||!0,t.showItemCount=o.showItemCount||!0,t.needInit=o.needInit||!1,t.updateCurrentPage=function(){if(t.currentPage>Math.ceil(t.showNumber/2)&&t.pageCount>t.showNumber){if(t.pages=[],t.pageCount-t.currentPage>2)var e=t.currentPage-Math.ceil(t.showNumber/2),n=t.currentPage+Math.floor(t.showNumber/2);else var n=t.pageCount,e=t.pageCount-t.showNumber;for(i=e;i<n;i++)t.pages.push({page:i+1}),t.update()}else if(t.currentPage<Math.ceil(t.showNumber/2)+1&&t.pageCount>t.showNumber){for(t.pages=[],i=0;i<t.showNumber;i++)t.pages.push({page:i+1});t.pages.push({page:"..."})}},n.addCount=function(e){var n=t.count+e,i=t.pageCount;if(t.count=0>n?0:n,t.pageCount=Math.ceil(t.count/t.pagesize)||1,t.currentPage=t.currentPage>t.pageCount?t.pageCount:t.currentPage,t.pageCount<=t.showNumber){t.pages=[];for(var a=0;a<t.pageCount;a++)t.pages.push({page:a+1})}(t.needInit||t.pageCount<i&&t.currentPage<=t.pageCount)&&o.callback(t.currentPage),t.pageChange(t.currentPage),t.update()},t.pages=[],t.pageCount<t.showNumber+1)for(i=0;i<t.pageCount;i++)t.pages.push({page:i+1});else{for(i=0;i<t.showNumber;i++)t.pages.push({page:i+1});t.pages.push({page:"..."})}t.needInit&&o.callback(t.currentPage),t.updateCurrentPage(),t.update(),this.goFirst=function(e){t.pageChange(1)}.bind(this),this.goPrev=function(e){t.currentPage>1&&t.pageChange(t.currentPage-1)}.bind(this),this.goNext=function(e){t.currentPage<t.pageCount&&t.pageChange(t.currentPage+1)}.bind(this),this.goLast=function(e){t.pageChange(t.pageCount)}.bind(this),this.redirect=function(e){var n=parseInt(t.page.value,10);n&&n<t.pageCount+1&&n>0?t.pageChange(parseInt(n,10)):(t.tipsLeft=t.page.offsetLeft,t.tipsTop=t.page.offsetTop+t.page.offsetHeight+8,t.showTip="block",setTimeout(function(){t.showTip="none",t.update()},1500),t.update())}.bind(this),this.changePage=function(e){var n=e.item.page;return"string"==typeof n?!1:void t.pageChange(n)}.bind(this),t.pageChange=function(e){t.currentPage!=e&&(t.currentPage=e,o.callback(e)),t.updateCurrentPage()}}),riot.tag("select-muti-wrap",'<yield></yield> <ul class="itoolkit-selected-container" onmousedown="{ showOptions }"> <li class="itoolkit-selected-option" each="{realData }" if="{ selected }"> { name } <span class="itoolkit-close" onmousedown="{ cancel }" >×</span> </li> <li class="itoolkit-search-wrap" style="min-height: 34px;"> <input type="text" class="form-control itoolkit-select-search" oninput="{ filter }" onfocus="{ filter }" onkeyup="{ keyboardHandle }"> </li> </ul> <ul class="itoolkit-options-container"> <li class="itoolkit-options" each="{ realData }" onmousedown="{ toggle }" if="{ !hide }"> <span class="itoolkit-option-check" if="{ selected }">√</span> <span class="empty-icon" if="{ !selected }"></span> { name } </li> <li class="no-result" if="{ noResult }">无搜索结果</li> </ul>',"select-muti-wrap { display: block; position: relative; cursor: pointer; } select-muti-wrap select { display: none; } select-muti-wrap .itoolkit-selected-container { box-sizing: border-box; list-style: none; margin: 0; padding: 0 5px; width: 100%; display: inline-block; /*overflow-x: hidden;*/ /*overflow-y: auto;*/ border-radius: 0; border: 1px solid #d2d6de; text-align: left; } select-muti-wrap .itoolkit-selected-container .itoolkit-selected-option { display: inline-block; padding: 4px 8px; background: #3c8dbc; border-color: #367fa9; color: #ffffff; border-radius: 4px; margin: 2px 5px 2px 0; } select-muti-wrap .itoolkit-search-wrap { width: 1em; display: inline-block; } select-muti-wrap .itoolkit-search-wrap input { padding-left: 0; padding-right: 0; height: 30px; border:none; } select-muti-wrap .itoolkit-options-container { padding: 0; text-align: left; position: absolute; width: 100%; border: 1px solid #d2d6de; border-top: none; z-index: 10000; background: #ffffff; display: none; max-height: 150px; overflow-y: auto; } select-muti-wrap .itoolkit-options-container .itoolkit-options { padding: 6px 12px; } select-muti-wrap .itoolkit-options-container .itoolkit-options:hover { background: #eff3f8; } select-muti-wrap .itoolkit-options-container .no-result { text-align: center; padding: 6px 0; } select-muti-wrap .empty-icon { padding: 0 9px; } select-muti-wrap .itoolkit-option-check { /* 对勾*/ } select-muti-wrap .itoolkit-close { /* 叉叉*/ }",function(e){var t=this,n=t.opts.opts||t.opts;t.gotOptions=!1,t.init=t.root.init=function(){t.gotOptions=!1,t.update()},t.realData=[],t.root.realData=t.realData,t.root.getSelectedData=function(){for(var e=[],n=0,i=t.realData.length;i>n;n++)t.realData[n].selected&&e.push({id:parseInt(t.realData[n].value,10)});return e},t.initData=t.root.initData=function(){if(t.root.querySelector("select"))var e=t.root.querySelector("select").querySelectorAll("option");if(e&&e.length&&!t.gotOptions){for(t.options=e,t.searchInput=t.root.querySelector(".itoolkit-select-search"),t.optionsWrap=t.root.querySelector(".itoolkit-options-container"),t.realData=[],i=0;i<e.length;i++)t.realData.push({name:e[i].innerHTML,value:e[i].getAttribute("value"),selected:e[i].getAttribute("selected"),index:i});t.searchInput.onfocus=function(){t.optionsWrap.style.display="block"},t.searchInput.onblur=function(){t.optionsWrap.style.display="none",t.resetSelectOpt()},t.gotOptions=!0,t.update(),console.log(t.realData)}},t.on("update",function(){setTimeout(function(){t.initData()},0)}),t.on("mount",function(){n&&(utils.extend(t,n),t.update())}),t.filter=function(e){t.resetSelectOpt();var n=e.target.value;e.target.style.width=.9*n.length+1+"em";var o;for(i=0;i<t.realData.length;i++)t.realData[i].name.match(n)?(t.realData[i].hide=!1,o=!0):t.realData[i].hide=!0;t.noResult=!o},t.toggle=function(e){e.item.selected?(e.item.selected=!1,t.options[e.item.index].selected=!1):(e.item.selected=!0,t.options[e.item.index].selected=!0),t.update()},t.cancel=function(e){e.stopPropagation(),e.item.selected=!1,t.options[e.item.index].selected=!1,t.update()},t.showOptions=function(e){t.searchInput&&t.searchInput!==document.activeElement?t.searchInput.focus():t.searchInput.blur()},t.keyboardHandle=function(e){var n=e.target;n.options=document.querySelectorAll(".itoolkit-options"),void 0===n.seletedIndex&&(n.seletedIndex=-1);var i=e.keyCode;37===i||38===i?(t.clearSelectedOpt(n),n.seletedIndex--,n.seletedIndex<0&&(n.seletedIndex=n.options.length-1),t.setSelectedOpt(n)):39===i||40===i?(t.clearSelectedOpt(n),n.seletedIndex++,n.seletedIndex>=n.options.length&&(n.seletedIndex=0),t.setSelectedOpt(n)):13===i?t.chooseByKeyboard(n):27===i&&t.searchInput.blur()},t.chooseByKeyboard=function(e){var t=document.createEvent("MouseEvents"),n=e.options[e.seletedIndex];t.initEvent("mousedown",!0,!0),n&&n.dispatchEvent(t)},t.clearSelectedOpt=function(e){if(e.options){var t=e.options[e.seletedIndex];e.seletedIndex>=0&&t&&(t.style.background="",t.scrollIntoView())}},t.resetSelectOpt=function(){t.clearSelectedOpt(t.searchInput),t.searchInput.seletedIndex=-1},t.setSelectedOpt=function(e){var t=e.options[e.seletedIndex];t&&(t.style.background="#eff3f8",t.scrollIntoView())}}),riot.tag("select-box",'<div class="r-select" onclick="{ clicked }">{ placeholder }</div> <ul class="r-select-body" hide="{ hide }"> <li each="{ data }" index="{ index }" value="{ value }" class="r-select-item { selected }" onclick="{ parent.clickItem }">{ innerText }</li> </ul> <div style="display:none" class="inputHide"></div>',function(e){
var t=this,n=t.root;t.config=t.opts.opts||t.opts,t.data=[],t.placeholder=t.config.placeholder,t.callback=t.config.callback,t.name=t.config.name,t.value=[],t.prevNode=null,n.getValue=function(){return t.value},t.hide=!0,this.clicked=function(e){t.hide=!1,t.update()}.bind(this),this.updateValue=function(e){for(var n=0;n<t.data.length;n++)t.data[n].selected&&(t.value.push(t.data[n].value),t.placeholder.push(t.data[n].innerText));t.value.length==t.size&&(t.hide=!0),t.placeholder=t.placeholder.join(","),t.prevNode=e,t.callback&&t.callback(t),t.update()}.bind(this),this.clickItem=function(e){var n=e.target||e.srcElement,i=+n.getAttribute("index");return t.value.length=0,t.placeholder=[],t.mutiple?(t.data[i].selected=t.data[i].selected?"":"selected",void t.updateValue(null)):(t.prevNode&&(t.data[+t.prevNode.getAttribute("index")].selected=""),t.data[i].selected="selected",void t.updateValue(n))}.bind(this),t.one("mount",function(){for(var e=0;e<t.config.data.length;e++){var n=t.config.data[e];n.selected="",n.index=e,t.data.push(n)}t.mutiple=t.config.mutiple||!1,t.size=t.mutiple?t.config.size?t.config.size:t.data.length:1,t.update()})}),riot.tag("side-list",'<ul > <li each="{ data }"> <img riot-src="{ logoUrl }" if="{ isLogo }"> <span>{ name }</span> </li> </ul>',function(e){}),riot.tag("slide","",function(e){}),riot.tag("super-table","<yield>",function(e){var t=this,n=t.opts.opts||t.opts,o=t.root;t.init=function(){o.style.display="block";for(i in n)t[i]||(t[i]=n[i])},t.on("mount",function(){t.init()}),t.compare=function(e,n){return e[t.orderkeyName]>n[t.orderkeyName]?1:e[t.orderkeyName]===n[t.orderkeyName]?0:-1},t.orderBy=o.orderBy=function(e){t.orderkeyName=e,t.ordered!==e&&(t.data=t.reversed!==e?t.data.sort(t.compare):t.data.reverse(),t.ordered=e,t.reversed=!1,t.update())},t.loadData=o.loadData=function(e){t.data=e,t.update()},t.append=o.loadData=function(e){utils.isObject(e)?t.data.push(e):utils.isArray(e)&&(t.data=t.data.concat(e))},t.insertBefore=o.insertBefore=function(e){utils.isObject(e)?t.data.unshift(e):utils.isArray(e)&&(t.data=e.concat(t.data))},t.reverseBy=o.reverseBy=function(e){}}),riot.tag("super-div","<yield>","super-div{ display: block; }",function(e){var t=this,n=t.opts.opts||t.opts,o=t.root;for(i in n)t[i]=n[i];t.getData=function(e){var e=e||{};if(o.getAttribute("data-get"))var n="httpGet";else if(o.getAttribute("data-jsonp"))var n="jsonp";utils[n](t.superDivUrl,e,function(e){for(i in e)t.data={},t.data[i]=e[i];t.update()})},t.on("mount",function(){o.style.display="block",t.superDivUrl=o.getAttribute("data-get")||o.getAttribute("data-jsonp"),t.superDivUrl&&t.getData(n.params)}),t.loadData=o.loadData=function(e,n){n=n||"data",t[n]=e,t.update()},t.reload=o.reload=function(){t.superDivUrl?t.getData(n.params):t.update()}}),riot.tag("super-form",'<form onsubmit="{ submit }" > <yield> </form>',function(e){function t(e){s([],this)}function n(e){return Object.prototype.toString.call(e).match(/\ (.*)\]/)[1]}function o(e){var t=n(e);return"Null"===t||"Undefined"===t||"Function"===t?e:new window[t](e)}function a(e){for(var e=e,t=e.attributes,n={},i=0;i<t.length;i++){var o=t[i];n[o.name]=o.value}return n.value=e.value,n}function r(e){for(var t=0;t<d.length;t++)if(e[d[t]])return!0;return!1}function s(e,t){var n=t,i=a(t);if(r(i)){var o=new l.Validation(e,i.name,n);if(i.name){if((i.allowEmpty||i.allowempty)&&""===i.value)return void l.onValidPass(n,l.successTips);l.validEmpty(o,i),i.valid?l.rules[i.valid]?l.valid(i.valid,o,i):f[i.valid.toUpperCase()]&&l.validNumRange(o,i):i.valid||(i.min||i.max)&&l.comparator("string").handler(o,i)}e.length||l.validUnion(o,e,n,i),o.validTip()}}var l=this,u=l.root,c=l.opts.opts||l.opts,p=["insertTip","ajaxSubmit","submit","removeTips","insertTip","removeTip","loadData","getData","setData"],d=["allowEmpty","allowempty","max","min","valid","vr"],f={NON_NEGATIVE_INT:/^0$|^-[1-9]\d*$/,POSITIVE_INT:/^[1-9]\d*$/,NON_POSITIVE_INT:/^[1-9]\d*$|^0$/,NEGATIVE_INT:/^-[1-9]\d*$/,INT:/^-?[1-9]\d*$|^0$/,NON_NEGATIVE_FLOAT:/^(\d)(\.\d+)?$|^([1-9]\d*)(\.\d+)?$|^0$/,POSITIVE_FLOAT:/^(\d)(\.\d+)?$|^([1-9]\d*)(\.\d+)?$/,NON_POSITIVE_FLOAT:/^(-\d)(\.\d+)?$|^(-[1-9]\d*)(\.\d+)?$|^0$/,NEGATIVE_FLOAT:/^(-\d)(\.\d+)?$|^(-[1-9]\d*)(\.\d+)?$/,FLOAT:/^(-?\d)(\.\d+)?$|^(-?[1-9]\d*)(\.\d+)?$|^0$/};l.presentWarning="必填",l.emailWarning="邮箱格式错误",l.mobileWarning="手机格式错误",l.urlWarning="网址格式错误",l.successTips=c.successTipsText||"通过",l.regexpWarning="字段不符合验证规则",l.numWarning="数字格式错误",l.passClass=c.passClass||"valid-pass",l.failedClass=c.failedClass||"valid-failed",l.comparator=function(e){return{handler:function(t,n){switch(e){case"number":return l.numComparator(t,n);case"string":default:return l.strCompatator(t,n)}}}},l.strCompatator=function(e,t){var n=parseInt(t.min,10),i=parseInt(t.max,10),o=isNaN(n),a=isNaN(i),r=t.value.length;return o||a?(!o&&n>r&&e.msg.push(l.minWarning(n)),!a&&r>i&&e.msg.push(l.maxWarning(i))):(r>i||n>r)&&e.msg.push(l.bpWarning(n,i)),e},l.numComparator=function(e,t){var n=parseInt(t.min,10),i=parseInt(t.max,10),o=isNaN(n),a=isNaN(i),r=+t.value;return o||a?(!o&&n>r&&e.msg.push(l.minNumWarning(n)),!a&&r>i&&e.msg.push(l.maxNumWarning(i))):(r>i||n>r)&&e.msg.push(l.numBpWarning(n,i)),e},l.one("mount",function(){if(u.style.display="block",c.realTime&&c.valid)for(var e=l.root.getElementsByTagName("form")[0].elements,n=0,i=e.length;i>n;n++){var o=e[n].type;("submit"!==o||"button"!==o)&&(e[n].addEventListener("input",t,!1),e[n].addEventListener("change",t,!1))}}),u.loadData=function(e,t){if(utils.isObject(e))for(var n in e)e[n]=o(e[n]);else e=o(e);t=t||"data",l[t]=e,l.update()},u.setData=function(e,t){l.data[t]=o(e),l.update()},l.checkExistKey=function(e,t,n){if(e.hasOwnProperty(t))if(utils.isArray(e[t]))e[t].push(n);else{var i=[];i.push(e[t]),i.push(n),e[t]=i}else e[t]=n},l.getData=u.getData=function(){for(var e=l.root.getElementsByTagName("form")[0].elements,t={},n=0;n<e.length;n++)if(e[n].name){var i;if("SELECT"===e[n].tagName)for(var o=e[n].options,a=0;a<o.length;a++)o[a].selected&&(i=o[a].value,l.checkExistKey(t,e[n].name,encodeURIComponent(i)));else"checkbox"===e[n].type||"radio"===e[n].type?e[n].checked&&(i=e[n].value,l.checkExistKey(t,e[n].name,encodeURIComponent(i))):(i=e[n].value,l.checkExistKey(t,e[n].name,encodeURIComponent(i)))}return t},l.submitingText=c.submitingText||"提交中...",void 0===c.valid&&(c.valid=!0),l.maxWarning=c.maxWarning||function(e){return"不得超过"+e+"个字符"},l.minWarning=c.minWarning||function(e){return"不得小于"+e+"个字符"},l.bpWarning=c.bpWarning||function(e,t){return"只允许"+e+"-"+t+"个字符"},l.minNumWarning=c.minNumWarning||function(e){return"不得小于"+e},l.maxNumWarning=c.maxNumWarning||function(e){return"不得大于"+e},l.numBpWarning=c.numBpWarning||function(e,t){return"输入数字应在"+e+"-"+t+"之间"},l.removeTips=u.removeTips=function(){function e(){for(o=0;o<i.length;o++)i[o].parentNode.removeChild(i[o]),i.length&&e()}var t=l.root,n=t.getElementsByTagName("form")[0].elements,i=t.getElementsByClassName("tip-container");i&&i.length&&e();for(var o=0;o<n.length;o++)utils.removeClass(n[o],l.passClass),utils.removeClass(n[o],l.failedClass)},l.removeTipNode=function(e){var t=e.nextElementSibling;t&&t.className.match(/tip-container/)&&e.parentNode.removeChild(t)},l.removeTip=u.removeTip=function(e){l.removeTipNode(e),utils.removeClass(e,l.passClass),utils.removeClass(e,l.failedClass)},l.insertTip=u.insertTip=function(e,t,n){l.removeTipNode(e);var i=document.createElement("span");i.className=n,i.innerHTML=t,utils.insertAfterText(i,e)},l.onValidRefuse=u.onValidRefuse=c.onValidRefuse||function(e,t){l.insertTip(e,t,"tip-container"),utils.removeClass(e,l.passClass),utils.addClass(e,l.failedClass)},l.onValidPass=u.onValidPass=c.onValidPass||function(e,t){l.insertTip(e,t,"tip-container success"),utils.removeClass(e,l.failedClass),utils.addClass(e,l.passClass)},l.ajaxSubmit=function(e,t){for(var n="",i=0;i<e.length;i++){if(e[i].name){var o;if("SELECT"===e[i].tagName)for(var a=e[i].options,r=0;r<a.length;r++)a[r].selected&&(o=a[r].value,n+=e[i].name+"="+encodeURIComponent(o)+"&");else"checkbox"===e[i].type||"radio"===e[i].type?e[i].checked&&(o=e[i].value,n+=e[i].name+"="+encodeURIComponent(o)+"&"):(o=e[i].value,n+=e[i].name+"="+encodeURIComponent(o)+"&")}if("submit"===e[i].type){var s=e[i],u="BUTTON"===s.tagName?"innerHTML":"value",p=s[u];s.disabled="disabled",s[u]=l.submitingText}}var d=new XMLHttpRequest;d.open("POST",t,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send(n),d.onreadystatechange=function(){if(4===d.readyState)if(l.removeTips(),s[u]=p,s.disabled=!1,c.complete&&"function"==typeof c.complete&&c.complete(),200===d.status)try{var e=JSON.parse(d.responseText);c.callback&&c.callback(e),EC.trigger("submit_success",e)}catch(t){throw new Error(t.message)}else c.errCallback&&c.errCallback(n),EC.trigger("submit_error",n)}},this.submit=function(e){var t=[],n=l.root.getElementsByTagName("form")[0].elements,i=l.action||l.root.getAttribute("action"),o=i;if(c.valid)for(var a=0;a<n.length;a++)s(t,n[a]);if(!t.length)try{c.beforeSubmit&&c.beforeSubmit(t)}catch(e){t.push(e)}return t.length?!1:c.normalSubmit?(l.root.firstChild.setAttribute("action",i),!0):(e.preventDefault(),void l.ajaxSubmit(n,o))}.bind(this),l.Validation=function(e,t,n){this.msg=[],this.validTip=function(){this.msg.length?(l.onValidRefuse(n,this.msg[0]),e.push(t)):c.forbidTips?l.removeTip(n):l.onValidPass(n,l.successTips)}},l.rulesConfig={email:{regexp:/^([a-zA-Z0-9_\-\.])+\@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/,msg:l.emailWarning},present:{regexp:/\S+/,msg:l.presentWarning},url:{regexp:/((http|ftp|https|file):\/\/([\w\-]+\.)+[\w\-]+(\/[\w\u4e00-\u9fa5\-\.\/?\@\%\!\&=\+\~\:\#\;\,]*)?)/,msg:l.urlWarning},mobile:{regexp:/^1[3|4|5|8][0-9]\d{4,8}$/,msg:l.mobileWarning}},l.valid=function(e,t,n){if(l.rules[e]){var i=l.rules[e](n);return i===!0?l.comparator("string").handler(t,n):t.msg.push(i),t}},l.validNumRange=function(e,t){var n=f[t.valid.toUpperCase()];return n.test(t.value)?l.comparator("number").handler(e,t):e.msg.push(l.numWarning),e},l.validUnion=function(e,t,n,i){if(i.vr){var o=i.vr.split("::"),a=o[0],r=o[1]?o[1].split(","):void 0,s=!1;try{s=iToolkit[a].apply(n,r)}catch(l){throw s=!1,l}s||e.msg.push("")}return e},l.validEmpty=function(e,t){return""===t.value&&e.msg.push(l.presentWarning),e},l.on("mount",function(){l.init()}),l.init=function(){for(i in c)p.indexOf(i)<0&&(l[i]=l.hasOwnProperty(i)?utils.deepCopy(c[i],l[i]):c[i]);l.data=c.data,l.rules={};for(ruleConfig in l.rulesConfig)!function(e){l.rules[e]=function(t){return t.value.match(l.rulesConfig[e].regexp)?!0:l.rulesConfig[e].msg}}(ruleConfig)}}),riot.tag("tab",'<ul> <li each="{ data }" onclick="{ parent.toggle }" class="{ active: parent.currentIndex==index }">{ title }</li> </ul> <div class="tab-content" riot-tag="tab-content"></div>',function(e){var t=this,n=t.opts.opts||t.opts;if(t.data=n.data,t.data.length>0)for(t.currentIndex=0,t.content=t.data[0].content,i=0;i<t.data.length;i++)t.data[i].index=i;this.toggle=function(e){t.content=e.item.content,t.currentIndex=e.item.index,t.update()}.bind(this)}),riot.tag("tab-content","",function(e){var t=this;t.parent.on("update",function(){t.root.innerHTML=t.parent.content})}),riot.tag("tree-item",'<input type="checkbox" __checked="{ item.selected }" if="{ parent.rootConfig.showCheck }" onchange="{ checkHandle }"> <i class="tree-item-arrow { open: item.opened }" onclick="{ toggle }" if="{ item.children }"></i> <i class="tree-item-icon" if="{ item.children }"></i> <div onclick="{ leftClick }">{ item.name }</div>',function(e){var t=this;t.selectchildren=function(e,n){var i=function(e){if(e&&e.children)for(var t=0;t<e.children.length;t++)e.children[t].selected=n,i(e.children[t])};i(e,n),t.parent.treeroot.update()},t.cancelParent=function(e){var n=function(e){e&&e.pnode&&(e.pnode.selected=!1,n(e.pnode))};n(e),t.parent.treeroot.update()},this.checkHandle=function(e){var n=t.parent.rootConfig,i=n.onCheck,o=n.onUnCheck;t.item.selected?(t.item.selected=!1,o&&o(t.item,e.target),n.link&&(t.selectchildren(t.item,!1),t.cancelParent(t.item))):t.item.selected||(t.item.selected=!0,i&&i(t.item,e.target),n.link&&t.selectchildren(t.item,!0))}.bind(this),this.toggle=function(e){t.item.opened=t.item.opened===!0?!1:!0,t.parent.treeroot.update()}.bind(this),this.leftClick=function(e){var n=t.parent.rootConfig;if(n.folder&&n.children)t.item.opened=t.item.opened===!0?!1:!0;else{var i=n.onLeftClick;i&&i(t.item,e.target)}}.bind(this)}),riot.tag("tree",'<div class="tree-item-wrap" each="{ item, i in data }" onselectstart="return false" ondragstart="return false"> <tree-item class="tree-item-row { root: item.level==1 }" riot-style="padding-left: { countPadding(item.level) }"></tree-item> <ul class="tree-child-wrap" if="{ item.opened && item.children }"> <tree data="{ item.children }"></tree> </ul> </div>',function(e){var t=this;if(t.config=t.opts.opts||t.opts,t.dataHandle=function(e,n,i){var e=e||[],o=n||"id",a=i||"pid",r={};e.forEach(function(e){t.config.name&&(e.name=e[t.config.name]),r[e[o]]=e});var s=[];e.forEach(function(e){var t=r[e[a]];t?(t.children||(t.children=[]),e.pnode=t,t.children.push(e)):s.push(e)});var l=function(e,n){var n=n+1;e.forEach(function(e){e.level=n-1,e.level<t.config.openLevel+1&&(e.opened=!0),e.children&&l(e.children,n)})};return l(s,1),s},t.parent&&"TREE"===t.parent.root.tagName)t.data=t.config.data,t.rootConfig=t.parent.rootConfig||t.parent.parent.rootConfig,t.treeroot=t.parent.treeroot||t.parent.parent.treeroot;else{if(t.config.handleData){var n=t.dataHandle(t.config.data);t.data=n}t.rootConfig=t.config,t.treeroot=t}t.treeroot.update(),this.countPadding=function(e){var n=t.rootConfig.padding||20;return(e-1)*n+"px"}.bind(this)});