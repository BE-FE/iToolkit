/**
 * iToolkit v1.0.0
 * Revised in 2016-01-31 14:21:11
 * Released under the ISC License.
 */

!function(e,t){"use strict";function n(e){var t=q(0),n=e.trim().slice(t.length).match(/^\s*(\S+?)\s*(?:,\s*(\S+))?\s+in\s+(.+)$/);return n?{key:n[1],pos:n[2],val:t+n[3]}:{val:e}}function r(e,t,n){var r={};return r[e.key]=t,e.pos&&(r[e.pos]=n),r}function i(e,t,i){f(e,"each");var a,o=v(e),u=e.outerHTML,l=!!G[o],c=G[o]||{tmpl:u},d=e.parentNode,p=document.createComment("riot placeholder"),g=[],h=m(e);d.insertBefore(p,e),i=n(i),t.one("premount",function(){d.stub&&(d=t.root),e.parentNode.removeChild(e)}).on("update",function(){var n=Y(i.val,t);U(n)||(a=n?JSON.stringify(n):"",n=n?Object.keys(n).map(function(e){return r(i,e,n[e])}):[]);for(var u=document.createDocumentFragment(),f=g.length,m=n.length;f>m;)g[--f].unmount(),g.splice(f,1);for(f=0;m>f;++f){var v=!a&&i.key?r(i,n[f],f):n[f];g[f]?g[f].update(v):(g[f]=new s(c,{parent:t,isLoop:!0,hasImpl:l,root:$.test(o)?d:e.cloneNode(),item:v},e.innerHTML),g[f]._item=v,g[f].mount(),u.appendChild(g[f].root)),g[f]._item=v}d.insertBefore(u,p),h&&(t.tags[o]=g)}).one("updated",function(){var e=Object.keys(t);k(d,function(n){1!=n.nodeType||n.isLoop||n._looped||(n._visited=!1,n._looped=!0,E(n,t,e))})})}function a(e,t,n){k(e,function(e){if(1==e.nodeType){e.isLoop=e.isLoop||e.parentNode&&e.parentNode.isLoop||e.getAttribute("each")?1:0;var r=m(e);r&&!e.isLoop&&n.push(g(r,e,t)),e.isLoop||E(e,t,[])}})}function o(e,t,n){function r(e,t,r){if(t.indexOf(q(0))>=0){var i={dom:e,expr:t};n.push(y(i,r))}}k(e,function(e){var n=e.nodeType;if(3==n&&"STYLE"!=e.parentNode.tagName&&r(e,e.nodeValue),1==n){var a=e.getAttribute("each");return a?(i(e,t,a),!1):(d(e.attributes,function(t){var n=t.name,i=n.split("__")[1];return r(e,t.value,{attr:i||n,bool:i}),i?(f(e,n),!1):void 0}),m(e)?!1:void 0)}})}function s(e,n,r){function i(){var e=w&&k?f:v||f;d(A.attributes,function(t){m[t.name]=Y(t.value,e)}),d(Object.keys(M),function(t){m[t]=Y(M[t],e)})}function s(e){for(var t in N)typeof f[t]!==H&&(f[t]=e[t])}function u(){f.parent&&k&&d(Object.keys(f.parent),function(e){var t=!~R.indexOf(e)&&~_.indexOf(e);(typeof f[e]===H||t)&&(t||_.push(e),f[e]=f.parent[e])})}function l(e){if(d(E,function(t){t[e?"mount":"unmount"]()}),v){var t=e?"on":"off";k?v[t]("unmount",f.unmount):v[t]("update",f.update)[t]("unmount",f.unmount)}}var f=O.observable(this),m=D(n.opts)||{},g=K(e.tmpl),v=n.parent,k=n.isLoop,w=n.hasImpl,N=b(n.item),S=[],E=[],A=n.root,j=e.fn,I=A.tagName.toLowerCase(),M={},_=[];j&&A._tag&&A._tag.unmount(!0),this.isMounted=!1,A.isLoop=k,A._tag=this,this._id=L++,y(this,{parent:v,root:A,opts:m,tags:{}},N),d(A.attributes,function(e){var t=e.value;q(/{.*}/).test(t)&&(M[e.name]=t)}),g.innerHTML&&!/^(select|optgroup|table|tbody|tr|col(?:group)?)$/.test(I)&&(g.innerHTML=x(g.innerHTML,r)),this.update=function(e){e=b(e),u(),e&&typeof N===B&&(s(e),N=e),y(f,e),i(),f.trigger("update",e),c(S,f),f.trigger("updated")},this.mixin=function(){d(arguments,function(e){e=typeof e===P?O.mixin(e):e,d(Object.keys(e),function(t){"init"!=t&&(f[t]=p(e[t])?e[t].bind(f):e[t])}),e.init&&e.init.bind(f)()})},this.mount=function(){if(i(),j&&j.call(f,m),o(g,f,S),l(!0),(e.attrs||w)&&(T(e.attrs,function(e,t){A.setAttribute(e,t)}),o(f.root,f,S)),(!f.parent||k)&&f.update(N),f.trigger("premount"),k&&!w)f.root=A=g.firstChild;else{for(;g.firstChild;)A.appendChild(g.firstChild);A.stub&&(f.root=A=v.root)}!f.parent||f.parent.isMounted?(f.isMounted=!0,f.trigger("mount")):f.parent.one("mount",function(){C(f.root)||(f.parent.isMounted=f.isMounted=!0,f.trigger("mount"))})},this.unmount=function(e){var n,r=A,i=r.parentNode;if(i){if(v)n=h(v),U(n.tags[I])?d(n.tags[I],function(e,t){e._id==f._id&&n.tags[I].splice(t,1)}):n.tags[I]=t;else for(;r.firstChild;)r.removeChild(r.firstChild);e?i.removeAttribute("riot-tag"):i.removeChild(r)}f.trigger("unmount"),l(),f.off("*"),A._tag=null},a(g,this,E)}function u(t,n,r,i){r[t]=function(t){var a,o=i._item,s=i.parent;if(!o)for(;s&&!o;)o=s._item,s=s.parent;t=t||e.event;try{t.currentTarget=r,t.target||(t.target=t.srcElement),t.which||(t.which=t.charCode||t.keyCode)}catch(u){}t.item=o,n.call(i,t)===!0||/radio|check/.test(r.type)||(t.preventDefault&&t.preventDefault(),t.returnValue=!1),t.preventUpdate||(a=o?h(s):i,a.update())}}function l(e,t,n){e&&(e.insertBefore(n,t),e.removeChild(t))}function c(e,t){d(e,function(e,n){var r=e.dom,i=e.attr,a=Y(e.expr,t),o=e.dom.parentNode;if(e.bool?a=a?i:!1:null==a&&(a=""),o&&"TEXTAREA"==o.tagName&&(a=(""+a).replace(/riot-/g,"")),e.value!==a){if(e.value=a,!i)return void(r.nodeValue=""+a);if(f(r,i),p(a))u(i,a,r,t);else if("if"==i){var s=e.stub,c=function(){l(s.parentNode,s,r)},d=function(){l(r.parentNode,r,s)};a?s&&(c(),r.inStub=!1,C(r)||k(r,function(e){e._tag&&!e._tag.isMounted&&(e._tag.isMounted=!!e._tag.trigger("mount"))})):(s=e.stub=s||document.createTextNode(""),r.parentNode?d():(t.parent||t).one("updated",d),r.inStub=!0)}else if(/^(show|hide)$/.test(i))"hide"==i&&(a=!a),r.style.display=a?"":"none";else if("value"==i)r.value=a;else if(A(i,M)&&i!=_)a&&r.setAttribute(i.slice(M.length),a);else{if(e.bool&&(r[i]=a,!a))return;typeof a!==B&&r.setAttribute(i,a)}}})}function d(e,t){for(var n,r=0,i=(e||[]).length;i>r;r++)n=e[r],null!=n&&t(n,r)===!1&&r--;return e}function p(e){return typeof e===W||!1}function f(e,t){e.removeAttribute(t)}function m(e){return e.tagName&&G[e.getAttribute(_)||e.tagName.toLowerCase()]}function g(e,t,n){var r,i=new s(e,{root:t,parent:n},t.innerHTML),a=v(t),o=h(n);return i.parent=o,r=o.tags[a],r?(U(r)||(o.tags[a]=[r]),~o.tags[a].indexOf(i)||o.tags[a].push(i)):o.tags[a]=i,t.innerHTML="",i}function h(e){for(var t=e;!m(t.root)&&t.parent;)t=t.parent;return t}function v(e){var t=m(e),n=e.getAttribute("name"),r=n&&n.indexOf(q(0))<0?n:t?t.name:e.tagName.toLowerCase();return r}function y(e){for(var t,n=arguments,r=1;r<n.length;++r)if(t=n[r])for(var i in t)e[i]=t[i];return e}function b(e){if(!(e instanceof s||e&&typeof e.trigger==W))return e;var t={};for(var n in e)~R.indexOf(n)||(t[n]=e[n]);return t}function k(e,t){if(e){if(t(e)===!1)return;for(e=e.firstChild;e;)k(e,t),e=e.nextSibling}}function T(e,t){for(var n,r=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;n=r.exec(e);)t(n[1].toLowerCase(),n[2]||n[3]||n[4])}function C(e){for(;e;){if(e.inStub)return!0;e=e.parentNode}return!1}function w(e){return document.createElement(e)}function x(e,t){return e.replace(/<(yield)\/?>(<\/\1>)?/gi,t||"")}function N(e,t){return(t||document).querySelectorAll(e)}function S(e,t){return(t||document).querySelector(e)}function D(e){function t(){}return t.prototype=e,new t}function E(e,t,n){if(!e._visited){var r,i=e.getAttribute("id")||e.getAttribute("name");i&&(n.indexOf(i)<0&&(r=t[i],r?U(r)?r.push(e):t[i]=[r,e]:t[i]=e),e._visited=!0)}}function A(e,t){return e.slice(0,t.length)===t}function j(e){if(!O.render){V||(V=w("style"),V.setAttribute("type","text/css"));var t=document.head||document.getElementsByTagName("head")[0];if(V.styleSheet?V.styleSheet.cssText+=e:V.innerHTML+=e,!V._rendered)if(V.styleSheet)document.body.appendChild(V);else{var n=S("style[type=riot]");n?(n.parentNode.insertBefore(V,n),n.parentNode.removeChild(n)):t.appendChild(V)}V._rendered=!0}}function I(e,t,n){var r=G[t],i=e._innerHTML=e._innerHTML||e.innerHTML;return e.innerHTML="",r&&e&&(r=new s(r,{root:e,opts:n},i)),r&&r.mount?(r.mount(),z.push(r),r.on("unmount",function(){z.splice(z.indexOf(r),1)})):void 0}var O={version:"v2.2.4",settings:{}},L=0,M="riot-",_=M+"tag",P="string",B="object",H="undefined",W="function",$=/^(?:opt(ion|group)|tbody|col|t[rhd])$/,R=["_item","_id","update","root","mount","unmount","mixin","isMounted","isLoop","tags","parent","opts","trigger","on","off","one"],F=0|(e&&e.document||{}).documentMode,U=Array.isArray;O.observable=function(e){e=e||{};var t={},n=0;return e.on=function(r,i){return p(i)&&(typeof i.id===H&&(i._id=n++),r.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(i),i.typed=n>0})),e},e.off=function(n,r){return"*"==n?t={}:n.replace(/\S+/g,function(e){if(r)for(var n,i=t[e],a=0;n=i&&i[a];++a)n._id==r._id&&i.splice(a--,1);else t[e]=[]}),e},e.one=function(t,n){function r(){e.off(t,r),n.apply(e,arguments)}return e.on(t,r)},e.trigger=function(n){for(var r,i=[].slice.call(arguments,1),a=t[n]||[],o=0;r=a[o];++o)r.busy||(r.busy=1,r.apply(e,r.typed?[n].concat(i):i),a[o]!==r&&o--,r.busy=0);return t.all&&"all"!=n&&e.trigger.apply(e,["all",n].concat(i)),e},e},O.mixin=function(){var e={};return function(t,n){return n?void(e[t]=n):e[t]}}(),function(e,t,n){function r(){return s.href.split("#")[1]||""}function i(e){return e.split("/")}function a(e){e.type&&(e=r()),e!=o&&(u.trigger.apply(null,["H"].concat(i(e))),o=e)}if(n){var o,s=n.location,u=e.observable(),l=!1,c=e.route=function(e){e[0]?(s.hash=e,a(e)):u.on("H",e)};c.exec=function(e){e.apply(null,i(r()))},c.parser=function(e){i=e},c.stop=function(){l&&(n.removeEventListener?n.removeEventListener(t,a,!1):n.detachEvent("on"+t,a),u.off("*"),l=!1)},c.start=function(){l||(n.addEventListener?n.addEventListener(t,a,!1):n.attachEvent("on"+t,a),l=!0)},c.start()}}(O,"hashchange",e);var V,q=function(e){var t,n,r,i=/[{}]/g;return function(a){var o=O.settings.brackets||e;return t!==o&&(t=o,r=o.split(" "),n=r.map(function(e){return e.replace(/(?=.)/g,"\\")})),a instanceof RegExp?o===e?a:new RegExp(a.source.replace(i,function(e){return n[~~("}"===e)]}),a.global?"g":""):r[a]}}("{ }"),Y=function(){function t(e,t){return e.indexOf(q(0))<0?(e=e.replace(/\n|\r\n?/g,"\n"),function(){return e}):(e=e.replace(q(/\\{/g),"￰").replace(q(/\\}/g),"￱"),t=i(e,a(e,q(/{/),q(/}/))),e=2!==t.length||t[0]?"["+t.map(function(e,t){return t%2?n(e,!0):'"'+e.replace(/\n|\r\n?/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")':n(t[1]),new Function("d","return "+e.replace(/\uFFF0/g,q(0)).replace(/\uFFF1/g,q(1))+";"))}function n(e,t){return e=e.replace(/\n|\r\n?/g," ").replace(q(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),""),/^\s*[\w- "']+ *:/.test(e)?"["+a(e,/["' ]*[\w- ]+["' ]*:/,/,(?=["' ]*[\w- ]+["' ]*:)|}|$/).map(function(e){return e.replace(/^[ "']*(.+?)[ "']*: *(.+?),? *$/,function(e,t,n){return n.replace(/[^&|=!><]+/g,r)+'?"'+t+'":"",'})}).join("")+'].join(" ").trim()':r(e,t)}function r(e,t){return e=e.trim(),e?"(function(v){try{v="+e.replace(u,function(e,t,n){return n?'(("'+n+s+n+")":e})+"}catch(e){}return "+(t===!0?'!v&&v!==0?"":v':"v")+"}).call(d)":""}function i(e,t){var n=[];return t.map(function(t,r){r=e.indexOf(t),n.push(e.slice(0,r),t),e=e.slice(r+t.length)}),e&&n.push(e),n}function a(e,t,n){var r,i=0,a=[],o=new RegExp("("+t.source+")|("+n.source+")","g");return e.replace(o,function(t,n,o,s){!i&&n&&(r=s),i+=n?1:-1,i||null==o||a.push(e.slice(r,s+o.length))}),a}var o={},s='"in d?d:'+(e?"window).":"global)."),u=/(['"\/])(?:[^\\]*?|\\.|.)*?\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function\s*\()|([A-Za-z_$]\w*)/g;return function(e,n){return e&&(o[e]||(o[e]=t(e)))(n)}}(),K=function(e){function t(t){var a=t&&t.match(/^\s*<([-\w]+)/),o=a&&a[1].toLowerCase(),s=r[o]||i,u=w(s);return u.stub=!0,e&&o&&(a=o.match($))?n(u,t,o,!!a[1]):u.innerHTML=t,u}function n(e,t,n,r){var a,o=w(i),s=r?"select>":"table>";o.innerHTML="<"+s+t+"</"+s,a=o.getElementsByTagName(n)[0],a&&e.appendChild(a)}var r={tr:"tbody",th:"tr",td:"tr",tbody:"table",col:"colgroup"},i="div";return e=e&&10>e,t}(F),z=[],G={};O.tag=function(e,t,n,r,i){return p(r)&&(i=r,/^[\w\-]+\s?=/.test(n)?(r=n,n=""):r=""),n&&(p(n)?i=n:j(n)),G[e]={name:e,tmpl:t,attrs:r,fn:i},e},O.mount=function(e,t,n){function r(e){var t="";return d(e,function(e){t+=", *["+_+'="'+e.trim()+'"]'}),t}function i(){var e=Object.keys(G);return e+r(e)}function a(e){var r;if(e.tagName){!t||(r=e.getAttribute(_))&&r==t||e.setAttribute(_,t);var i=I(e,t||e.getAttribute(_)||e.tagName.toLowerCase(),n);i&&u.push(i)}else e.length&&d(e,a)}var o,s,u=[];if(typeof t===B&&(n=t,t=0),typeof e===P?("*"===e?e=s=i():e+=r(e.split(",")),o=N(e)):o=e,"*"===t){if(t=s||i(),o.tagName)o=N(t,o);else{var l=[];d(o,function(e){l.push(N(t,e))}),o=l}t=0}return o.tagName?a(o):d(o,a),u},O.update=function(){return d(z,function(e){e.update()})},O.mountTo=O.mount,O.util={brackets:q,tmpl:Y},typeof exports===B?module.exports=O:"function"==typeof define&&define.amd?define(function(){return e.riot=O}):e.riot=O}("undefined"!=typeof window?window:void 0);var utils={httpGet:function(e,t,n,r){var i=new XMLHttpRequest,e=utils.concatParams(e,t);i.open("GET",e,!0),i.send(null),i.onreadystatechange=function(){if(4===i.readyState&&(r&&"function"==typeof r&&r(),200===i.status)){var e=i.responseText;try{if("string"==typeof e)var t=JSON.parse(e);else var t=e}catch(a){alert("解析错误")}n(t)}}},httpPost:function(e,t,n,r){var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-type","application/json"),i.send(t),i.onreadystatechange=function(){if(4===i.readyState)if(r&&"function"==typeof r&&r(),200===i.status){try{var e=JSON.parse(i.responseText)}catch(t){console.log("解析错误")}n(e)}else console.log("网络错误")}},jsonp:function(e,t,n){var r=Date.now(),i=document.createElement("script"),a=document.getElementsByTagName("head")[0],e=utils.concatParams(e,t);if(t.callback)var o=e,s=t.callback;else{if(e.match(/\?/))var o=e+"&callback=jsonpCallback"+r;else var o=e+"?callback=jsonpCallback"+r;var s="jsonpCallback"+r}i.src=o,a.appendChild(i),window[s]=function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}n(e)},i.onerror=function(){console.log("jsonp error")},i.onload=function(){a.removeChild(i)}},htmlEncode:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText},concatParams:function(e,t){if(e.match(/\?/))var n="&";else var n="?";for(i in t)n=n+i+"="+t[i]+"&";return n=n.replace(/&$/,""),e+n},setCookie:function(e,t,n,r){var i=new Date,r=r||"/";i.setTime(i.getTime()+n),document.cookie=e+"="+escape(t)+";path="+r+";expires="+i.toGMTString()},transBytes:function(e){var t=["B","KB","MB","GB","TB"];if(0==e)return"n/a";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return 0==n?e+t[n]:(e/Math.pow(1024,n)).toFixed(1)+t[n]},transTimes:function(e){var e=parseInt(e,10),t=new Date(1e3*e),n=(new Date).getTime()/1e3,r=n-e;if(86400>r)return t.getHours()+":"+t.getMinutes();if(r>86400&&172800>r)return"昨天";if(r>172800){var i=(t.getFullYear()+"-").substring(2),a=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",o=t.getDate()<10?"0"+t.getDate():t.getDate();return i+a+o}},hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){e.className.trim(),this.hasClass(e,t)||(e.className+=" "+t)},removeClass:function(e,t){if(utils.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},toggleClass:function(e,t){if(utils.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}else e.className+=" "+t},insertAfter:function(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)},insertAfterText:function(e,t){var n=t.parentNode;if(n.lastChild==t)n.appendChild(e);else{var r=t.nextSibling;3===r.nodeType&&(r=r.nextSibling),n.insertBefore(e,r)}},isType:function(e){return function(t){return toString.call(t)==="[object "+e+"]"}},makeArray:function(){return Array.prototype.concat(obj)},extend:function(e,t){for(var n in t)e[n]||(e[n]=t[n])},deepCopy:function(e,t){var n="[object Array]"===toString.call(e)?[]:{},t=t||n;for(var r in e)"[object Object]"===toString.call(e[r])?(t[r]={},this.deepCopy(e[r],t[r])):"[object Array]"===toString.call(e[r])?(t[r]=[],this.deepCopy(e[r],t[r])):t[r]=e[r];return t}};utils.extend(utils,{isArray:utils.isType("Array"),isObject:utils.isType("Object"),isFunction:utils.isType("Function"),isElement:function(e){return-1!==toString.call(e).indexOf("Element")}}),utils.extend(utils,{jsLoader:function(){function e(){return p++}function t(e){return e.match(/\.css\??/)}function n(t){this.uri=t,this.cid=e(),this.status=k}function r(e,t){return r.then(e,t).start(),r}function i(e){throw e}function a(e){if(e||f.length)for(var t=0;t<e.task.length;t++){var n=e.task[t];s(n,e)}}function o(e,t){var r=document.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e.uri,c.appendChild(r),r=null,e.status=v,n.resolve.call(t)}function s(e,r){function i(t){if("error"===t.type&&(e.status=b),"load"===t.type&&(e.status=v),n.resolve.call(r,e),e.changeStatus){e.changeStatus=!1;for(var i=0;i<T[e.cid].length;i++){var a=T[e.cid][i];n.resolve.call(a.resolver,a.js)}T[e.cid]=null}s.onload=s.onerror=null,c.removeChild(s),s=null}if(g(e.uri))try{e.uri(),e.status=v,n.resolve.call(r)}catch(a){e.status=b,n.resolve.call(r)}else{if(e.status===v)return void n.resolve.call(r);if(t(e.uri))return void o(e,r);if(e.status===y)return e.changeStatus=!0,T[e.cid]=T[e.cid]||[],void T[e.cid].push({js:e,resolver:r});e.status=y;var s=document.createElement("script");s.async=!0,s.src=e.uri,s.onload=s.onerror=i,c.appendChild(s)}}function u(e){var t=l(e);return t?n.get(t):n.get(e)}function l(e){return r.alias[e]}var c=document.head||document.getElementsByTagName("head")[0],d={},p=0,f=[],m=utils.isArray,g=utils.isFunction,h=utils.makeArray,v="done",y="inprocess",b="rejected",k="pending",T={};return n.get=function(e){return d[e]||(d[e]=new n(e))},n.resolve=function(e){var t=this;if(t.status++,e&&e.status===b){var n=Error("Source: "+e.uri+" load failed");i(n)}t.status===t.task.length&&setTimeout(function(){t.callback&&t.callback(),t=null,a(f.shift())},7)},r.then=function(e,t){if(!e)return r;m(e)||(e=h(e));for(var n={task:[],callback:t,status:0},i=0;i<e.length;i++)n.task.push(u(e[i]));return f.push(n),r},r.start=function(){return a(f.shift()),r},r.alias={},r}()});var EventCtrl=EC=riot.observable(),iToolkit={};iToolkit.methodRegister=function(e,t){for(var n in iToolkit)if(e===n)return;iToolkit[e]=t},iToolkit.tableExtend={},riot.tag("itk-calendar",'<div class="itk-calendar-wrapper"> <div class="itk-calendar-head"> <div class="itk-calendar-month-prev btn" onclick="{ prevMonth }">⟨</div> <div class="itk-calendar-year-prev btn" onclick="{ prevYear }">⟪</div> <div class="itk-calendar-month">{ month.text }</div> <div class="itk-calendar-year">{ year.text }</div> <div class="itk-calendar-year-next btn" onclick="{ nextMonth }">⟩</div> <div class="itk-calendar-month-next btn" onclick="{ nextYear }">⟫</div> </div> <div class="itk-calendar-body"> <div class="itk-calendar-weeks"> <div class="itk-calendar-week" each="{ text in weekArr }">{ text }</div> </div> <div class="itk-calendar-days"> <div each="{ dayArr }" class="itk-calendar-day { selected: parent.showSelected && parent.selectedYear === year && parent.selectedMonth === month && parent.selectedDay === day } { today: parent.showToday && parent.toYear === year && parent.toMonth === month && parent.today === day } { cursor: year && month && day }" data-year="{ year }" data-month="{ month }" data-day="{ day }" onclick="{ (year && month) ? dayClicked : \'return false;\' }" >{ day }</div> </div> </div> </div>','hide="{ !open }"',function(e){var t=this;t.i18n={zh_cn:{weekArr:["日","一","二","三","四","五","六"],monthArr:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},en_us:{weekArr:["Su","Mo","Tu","We","Th","Fr","Sa"],monthArr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}};var n=(t.root,t.opts.opts||t.opts||{});t.mapping=function(e){if(!utils.isObject(e))throw new TypeError("Config is not a object!");for(var n in e)t[n]=e[n]},t.mapping(n),t.initWeekList=function(e){var n=t.i18n[e];if(n)t.weekArr=n.weekArr,t.monthArr=n.monthArr;else if(!t.weekArr||!t.monthArr){var n=t.i18n.en_us;t.weekArr=n.weekArr,t.monthArr=n.monthArr}},t.initWeekList(t.language),t.getDaysCount=function(e,t){var n=0;switch(t){case 1:case 3:case 5:case 7:case 8:case 10:case 12:case 0:case 13:n=31;break;case 4:case 6:case 9:case 11:n=30;break;case 2:n=e%4===0&&e%100!==0||e%400===0?29:28;break;default:throw new Error("你算错了")}return n},t.drawDays=function(e){var n;n=e?new Date(e):new Date;var r=n.getMonth(),i=n.getFullYear();t.month={text:t.monthArr[r],val:r+1},t.year={text:i,val:i},r+=1;var a=t.getDaysCount(i,r),o=t.getDaysCount(i,r-1);t.getDaysCount(i,r+1);n.setDate(1);var s=n.getDay();n.setDate(a);var u=n.getDay(),l=[];return l=l.concat(new Array(0===s?1:(7-s^7)+1).join(0).split("").map(function(e,t){return{year:"",month:"",day:o-t}}).reverse()),l=l.concat(new Array(a+1).join(0).split("").map(function(e,t){return{year:i,month:r,day:t+1}})),l=l.concat(new Array(0===u?7:6-u+1).join(0).split("").map(function(e,t){return{year:"",month:"",day:t+1}}))},t.initDays=function(e){if(t.showToday){var n=new Date;t.today=n.getDate(),t.toMonth=n.getMonth()+1,t.toYear=n.getFullYear()}if(t.defaultSelected){var n=new Date;t.selectedDay=n.getDate(),t.selectedMonth=n.getMonth()+1,t.selectedYear=n.getFullYear()}t.dayArr=t.drawDays(e),t.update()},t.initDays(t.initTime),t.getNum=function(e){return e>10?e:"0"+e},t.formatter=function(e){var n,r=new Date(t.selectedYear,t.selectedMonth-1,t.selectedDay,0,0,0),i=r.getTime();switch(e){case"unixTimeStamp":n=t.getUnixTimeStamp(i);break;case"timeStamp":n=t.getTimeStamp(i);break;default:if(!e)var e="yyyy/mm/dd";n=e.replace(/(yyyy|mm|dd|yy|m|d)/gi,function(e){return"yyyy"===e?t.selectedYear:"mm"===e?t.getNum(t.selectedMonth):"dd"===e?t.getNum(t.selectedDay):"yy"===e?t.selectedYear.toString().substr(2,4):"m"===e?t.selectedMonth:"d"===e?t.selectedDay:void 0})}return n},t.dayClicked=function(e){t.selectedDay=e.item.day,t.selectedMonth=e.item.month,t.selectedYear=e.item.year,t.onSelect&&t.onSelect(t.formatter),t.update()},t.open=!1,t.getAbsPoint=function(e){for(var t=e.offsetLeft,n=e.offsetTop;e=e.offsetParent;)t+=e.offsetLeft,n+=e.offsetTop;return{x:t,y:n}},t.location=function(e){if(t.element){var n=t.getAbsPoint(t.element);t.root.style.position="absolute",t.root.style.top=n.y+t.element.offsetHeight,t.root.style.left=n.x}},t.closeIt=function(e){var n=e.target.className;e.target===t.element||n&&-1!==n.indexOf("itk-calendar")&&"itk-calendar-days"!==n||(t.open=!1,t.update())},t.openIt=function(e){t.open=!0,t.update(),t.location(e)},t.unbindEvent=function(){t.element&&(document.removeEventListener("click",t.closeIt,!1),t.element.removeEventListener("click",t.openIt,!1))},t.on("mount",function(){t.element?(document.addEventListener("click",t.closeIt,!1),t.element.addEventListener("click",t.openIt,!1)):t.open=!0,t.update()}),t.on("unmount",function(){t.unbindEvent()}),t.getTimeStamp=function(e){return e},t.getUnixTimeStamp=function(e){return Math.ceil(e/1e3).toString()},t.getYear=function(){return t.selectedYear},t.getMonth=function(){return t.selectedMonth},t.getDay=function(){return t.selectedDay},t.nextYear=function(){var e=t.year.val+1;t.dayArr=t.drawDays(new Date(e,t.month.val-1,1).getTime()),t.update()},t.nextMonth=function(){var e=t.month.val-1,n=t.year.val;n=11===e?n+1:n,e=11===e?0:e+1;var r=new Date(n,e,1);t.dayArr=t.drawDays(r.getTime()),t.update()},t.prevYear=function(){var e=t.year.val-1;t.dayArr=t.drawDays(new Date(e,t.month.val-1,1).getTime()),t.update()},t.prevMonth=function(){var e=t.month.val-1,n=t.year.val;n=0===e?n-1:n,e=0===e?11:e,console.log(e);var r=new Date(n,e,1);t.dayArr=t.drawDays(r.getTime()),t.update()}}),riot.tag("itk-center",'<div class="itk-loading {default: default}" > <yield> </div>',function(e){var t=this;t.opts.opts||t.opts;t["default"]=!1,t.on("mount",function(){var e=t.root.parentNode,n=window.getComputedStyle(e,null).position;"static"===n&&(e.style.position="relative"),t.childDom=t.root.getElementsByClassName("itk-loading")[0],t.childDom.innerHTML.trim()&&(t["default"]=!1,t.update());var r=parseInt(window.getComputedStyle(t.childDom,null).height.replace("px",""),10);t.root.style.marginTop="-"+r/2+"px"}),t.root.show=function(){t.childDom&&(t.childDom.style.display="block")},t.root.hide=function(){t.childDom&&(t.childDom.style.display="none")}}),riot.tag("date-picker","<yield>",function(e){var t=this,n=t.root,r=t.opts.opts||t.opts,i=document.scripts,a="",o="";if(r.path)a=r.path;else{for(var s=0;s<i.length;s++)if(i[s].src&&/iToolkit_pc.min.js|iToolkit_pc.js/.test(i[s].src)){o=i[s].src.replace(/iToolkit_pc.min.js|iToolkit_pc.js/,"");break}a=o+"plugins/laydate/"}var u=r.theme?r.theme:"default";utils.jsLoader([a+"laydate.min.js",a+"/need/laydate.css",a+"/skins/"+u+"/laydate.css"],function(){for(var e=0;e<n.children.length;e++){var r=n.children[e];r.attributes.pTrigger&&(t.pTrigger=r),r.attributes.media&&(t.media=r)}t.resolve(),t.update()}),this.resolve=function(){if(!t.pTrigger&&!t.media)throw"media and pTrigger property was not found in the element";return t.pTrigger===t.media&&(r.elem=r.pTrigger=t.media),"undefined"==typeof t.pTrigger&&(r.elem=t.media),t.pTrigger&&t.media&&t.pTrigger!==t.media&&(r.pTrigger=t.pTrigger,r.elem=t.media),t.pTrigger&&!t.media&&(r.elem=t.pTrigger,r.justChoose=!0),r.pTrigger?void(r.pTrigger.onclick=function(e){laydate(r)}):void laydate(r)}.bind(this)}),riot.tag("itk-div","<yield>",function(e){var t=this,n=t.opts.opts||t.opts,r=t.root;for(i in n)t[i]=n[i];t.getData=function(e){var e=e||{};if(r.getAttribute("data-get"))var n="httpGet";else if(r.getAttribute("data-jsonp"))var n="jsonp";utils[n](t.superDivUrl,e,function(e){for(i in e)t.data={},t.data[i]=e[i];t.update()})},t.on("mount",function(){r.style.display="block",t.superDivUrl=r.getAttribute("data-get")||r.getAttribute("data-jsonp"),t.superDivUrl&&t.getData(n.params)}),t.loadData=r.loadData=function(e,n){n=n||"data",t[n]=e,t.update()},t.reload=r.reload=function(){t.superDivUrl?t.getData(n.params):t.update()}}),riot.tag("itk-editor",'<textarea name="editor1" id="editor1" rows="10" cols="80"> This is my textarea to be replaced with CKEditor. </textarea>',function(e){var t=this,n=(t.root,t.opts.opts||t.opts),r=document.scripts,i="",a="",o=n.type||"standard";if(n.path)i=n.path;else{for(var s=0;s<r.length;s++)if(r[s].src&&/iToolkit_pc.min.js|iToolkit_pc.js/.test(r[s].src)){a=r[s].src.replace(/iToolkit_pc.min.js|iToolkit_pc.js/,"");break}i=a+"plugins/ckeditor/"}utils.jsLoader([i+o+"/ckeditor.js"],function(){CKEDITOR.replace("editor1",{image_previewText:"",filebrowserImageUploadUrl:"admin/UserArticleFileUpload.do"}),t.update()})}),riot.tag("itk-form",'<form onsubmit="{ submit }" > <yield> </form>',function(e){function t(e){s([],this)}function n(e){return Object.prototype.toString.call(e).match(/\ (.*)\]/)[1]}function r(e){var t=n(e);return"Null"===t||"Undefined"===t||"Function"===t?e:new window[t](e)}function a(e){for(var e=e,t=e.attributes,n={},r=0;r<t.length;r++){var i=t[r];n[i.name]=i.value}return n.value=e.value,n}function o(e){for(var t=0;t<p.length;t++)if(e[p[t]])return!0;return!1}function s(e,t){var n=t,r=a(t);if(o(r)){var i=new u.Validation(e,r.name,n);if(r.name){if((r.allowEmpty||r.allowempty)&&""===r.value)return void u.onValidPass(n,u.successTips);u.validEmpty(i,r),r.valid?u.rules[r.valid]?u.valid(r.valid,i,r):f[r.valid.toUpperCase()]&&u.validNumRange(i,r):r.valid||(r.min||r.max)&&u.comparator("string").handler(i,r)}e.length||u.validUnion(i,e,n,r),i.validTip()}}var u=this,l=u.root,c=u.opts.opts||u.opts,d=["insertTip","ajaxSubmit","submit","removeTips","insertTip","removeTip","loadData","getData","setData"],p=["allowEmpty","allowempty","max","min","valid","vr"],f={NON_NEGATIVE_INT:/^0$|^-[1-9]\d*$/,POSITIVE_INT:/^[1-9]\d*$/,NON_POSITIVE_INT:/^[1-9]\d*$|^0$/,NEGATIVE_INT:/^-[1-9]\d*$/,INT:/^-?[1-9]\d*$|^0$/,NON_NEGATIVE_FLOAT:/^(\d)(\.\d+)?$|^([1-9]\d*)(\.\d+)?$|^0$/,POSITIVE_FLOAT:/^(\d)(\.\d+)?$|^([1-9]\d*)(\.\d+)?$/,NON_POSITIVE_FLOAT:/^(-\d)(\.\d+)?$|^(-[1-9]\d*)(\.\d+)?$|^0$/,NEGATIVE_FLOAT:/^(-\d)(\.\d+)?$|^(-[1-9]\d*)(\.\d+)?$/,FLOAT:/^(-?\d)(\.\d+)?$|^(-?[1-9]\d*)(\.\d+)?$|^0$/};u.presentWarning="必填",u.emailWarning="邮箱格式错误",u.mobileWarning="手机格式错误",u.urlWarning="网址格式错误",u.successTips=c.successTipsText||"通过",u.regexpWarning="字段不符合验证规则",u.numWarning="数字格式错误",u.passClass=c.passClass||"valid-pass",u.failedClass=c.failedClass||"valid-failed",u.comparator=function(e){return{handler:function(t,n){switch(e){case"number":return u.numComparator(t,n);case"string":default:return u.strCompatator(t,n)}}}},u.strCompatator=function(e,t){var n=parseInt(t.min,10),r=parseInt(t.max,10),i=isNaN(n),a=isNaN(r),o=t.value.length;return i||a?(!i&&n>o&&e.msg.push(u.minWarning(n)),!a&&o>r&&e.msg.push(u.maxWarning(r))):(o>r||n>o)&&e.msg.push(u.bpWarning(n,r)),e},u.numComparator=function(e,t){var n=parseInt(t.min,10),r=parseInt(t.max,10),i=isNaN(n),a=isNaN(r),o=+t.value;return i||a?(!i&&n>o&&e.msg.push(u.minNumWarning(n)),!a&&o>r&&e.msg.push(u.maxNumWarning(r))):(o>r||n>o)&&e.msg.push(u.numBpWarning(n,r)),e},u.one("mount",function(){if(l.style.display="block",c.realTime&&c.valid)for(var e=u.root.getElementsByTagName("form")[0].elements,n=0,r=e.length;r>n;n++){var i=e[n].type;("submit"!==i||"button"!==i)&&(e[n].addEventListener("input",t,!1),e[n].addEventListener("change",t,!1))}}),l.loadData=function(e,t){if(utils.isObject(e))for(var n in e)e[n]=r(e[n]);else e=r(e);t=t||"data",u[t]=e,u.update()},l.setData=function(e,t){u.data[t]=r(e),u.update()},u.checkExistKey=function(e,t,n){if(e.hasOwnProperty(t))if(utils.isArray(e[t]))e[t].push(n);else{var r=[];r.push(e[t]),r.push(n),e[t]=r}else e[t]=n},u.getData=l.getData=function(){for(var e=u.root.getElementsByTagName("form")[0].elements,t={},n=0;n<e.length;n++)if(e[n].name){var r;if("SELECT"===e[n].tagName)for(var i=e[n].options,a=0;a<i.length;a++)i[a].selected&&(r=i[a].value,u.checkExistKey(t,e[n].name,encodeURIComponent(r)));else"checkbox"===e[n].type||"radio"===e[n].type?e[n].checked&&(r=e[n].value,u.checkExistKey(t,e[n].name,encodeURIComponent(r))):(r=e[n].value,u.checkExistKey(t,e[n].name,encodeURIComponent(r)))}return t},u.submitingText=c.submitingText||"提交中...",void 0===c.valid&&(c.valid=!0),u.maxWarning=c.maxWarning||function(e){return"不得超过"+e+"个字符"},u.minWarning=c.minWarning||function(e){return"不得小于"+e+"个字符"},u.bpWarning=c.bpWarning||function(e,t){return"只允许"+e+"-"+t+"个字符"},u.minNumWarning=c.minNumWarning||function(e){return"不得小于"+e},u.maxNumWarning=c.maxNumWarning||function(e){return"不得大于"+e},u.numBpWarning=c.numBpWarning||function(e,t){return"输入数字应在"+e+"-"+t+"之间"},u.removeTips=l.removeTips=function(){function e(){for(i=0;i<r.length;i++)r[i].parentNode.removeChild(r[i]),r.length&&e()}var t=u.root,n=t.getElementsByTagName("form")[0].elements,r=t.getElementsByClassName("tip-container");r&&r.length&&e();for(var i=0;i<n.length;i++)utils.removeClass(n[i],u.passClass),utils.removeClass(n[i],u.failedClass)},u.removeTipNode=function(e){var t=e.nextElementSibling;t&&t.className.match(/tip-container/)&&e.parentNode.removeChild(t)},u.removeTip=l.removeTip=function(e){u.removeTipNode(e),utils.removeClass(e,u.passClass),utils.removeClass(e,u.failedClass)},u.insertTip=l.insertTip=function(e,t,n){u.removeTipNode(e);var r=document.createElement("span");r.className=n,r.innerHTML=t,utils.insertAfterText(r,e)},u.onValidRefuse=l.onValidRefuse=c.onValidRefuse||function(e,t){u.insertTip(e,t,"tip-container"),utils.removeClass(e,u.passClass),utils.addClass(e,u.failedClass)},u.onValidPass=l.onValidPass=c.onValidPass||function(e,t){u.insertTip(e,t,"tip-container success"),utils.removeClass(e,u.failedClass),utils.addClass(e,u.passClass)},u.ajaxSubmit=function(e,t){for(var n="",r=0;r<e.length;r++){if(e[r].name){var i;if("SELECT"===e[r].tagName)for(var a=e[r].options,o=0;o<a.length;o++)a[o].selected&&(i=a[o].value,n+=e[r].name+"="+encodeURIComponent(i)+"&");else"checkbox"===e[r].type||"radio"===e[r].type?e[r].checked&&(i=e[r].value,n+=e[r].name+"="+encodeURIComponent(i)+"&"):(i=e[r].value,n+=e[r].name+"="+encodeURIComponent(i)+"&")}if("submit"===e[r].type){var s=e[r],l="BUTTON"===s.tagName?"innerHTML":"value",d=s[l];s.disabled="disabled",s[l]=u.submitingText}}var p=new XMLHttpRequest;p.open("POST",t,!0),p.setRequestHeader("Content-type","application/x-www-form-urlencoded"),p.send(n),p.onreadystatechange=function(){if(4===p.readyState)if(u.removeTips(),s[l]=d,s.disabled=!1,c.complete&&"function"==typeof c.complete&&c.complete(),200===p.status)try{var e=JSON.parse(p.responseText);c.callback&&c.callback(e),EC.trigger("submit_success",e)}catch(t){throw new Error(t.message)}else c.errCallback&&c.errCallback(n),
EC.trigger("submit_error",n)}},this.submit=function(e){var t=[],n=u.root.getElementsByTagName("form")[0].elements,r=u.action||u.root.getAttribute("action"),i=r;if(c.valid)for(var a=0;a<n.length;a++)s(t,n[a]);if(!t.length)try{c.beforeSubmit&&c.beforeSubmit(t)}catch(e){t.push(e)}return t.length?!1:c.normalSubmit?(u.root.firstChild.setAttribute("action",r),!0):(e.preventDefault(),void u.ajaxSubmit(n,i))}.bind(this),u.Validation=function(e,t,n){this.msg=[],this.validTip=function(){this.msg.length?(u.onValidRefuse(n,this.msg[0]),e.push(t)):c.forbidTips?u.removeTip(n):u.onValidPass(n,u.successTips)}},u.rulesConfig={email:{regexp:/^([a-zA-Z0-9_\-\.])+\@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/,msg:u.emailWarning},present:{regexp:/\S+/,msg:u.presentWarning},url:{regexp:/((http|ftp|https|file):\/\/([\w\-]+\.)+[\w\-]+(\/[\w\u4e00-\u9fa5\-\.\/?\@\%\!\&=\+\~\:\#\;\,]*)?)/,msg:u.urlWarning},mobile:{regexp:/^1[3|4|5|8][0-9]\d{4,8}$/,msg:u.mobileWarning}},u.valid=function(e,t,n){if(u.rules[e]){var r=u.rules[e](n);return r===!0?u.comparator("string").handler(t,n):t.msg.push(r),t}},u.validNumRange=function(e,t){var n=f[t.valid.toUpperCase()];return n.test(t.value)?u.comparator("number").handler(e,t):e.msg.push(u.numWarning),e},u.validUnion=function(e,t,n,r){if(r.vr){var i=r.vr.split("::"),a=i[0],o=i[1]?i[1].split(","):void 0,s=!1;try{s=iToolkit[a].apply(n,o)}catch(u){throw s=!1,u}s||e.msg.push("")}return e},u.validEmpty=function(e,t){return""===t.value&&e.msg.push(u.presentWarning),e},u.on("mount",function(){u.init()}),u.init=function(){for(i in c)d.indexOf(i)<0&&(u.hasOwnProperty(i)?u[i]=utils.deepCopy(c[i],u[i]):u[i]=c[i]);u.data=c.data,u.rules={};for(ruleConfig in u.rulesConfig)!function(e){u.rules[e]=function(t){return t.value.match(u.rulesConfig[e].regexp)?!0:u.rulesConfig[e].msg}}(ruleConfig)}}),riot.tag("itk-modal",'<div class="itk-modal-dialog" riot-style="width:{width}; height:{height}"> <div class="itk-modal-title"> <span>{ title }</span> <div class="itk-modal-close-wrap" onclick="{ close }"> <div class="itk-modal-close"></div> </div> </div> <div class="itk-modal-container"> <yield> </div> </div>',function(e){var t=this,n=t.opts.opts||t.opts;t.root;for(i in n)t[i]=n[i];t.width=n.width||600,t.height=n.height||"auto",t.on("mount",function(){var e=t.root.querySelector(".itk-modal-container"),r=t.root.querySelector(".itk-modal-title"),i=parseInt(window.getComputedStyle(r,null).height.replace("px",""));n.height&&(e.style.height=t.height-i-2+"px")}),this.close=function(e){t.root.style.display="none",t.onClose&&t.onClose()}.bind(this),document.querySelector("[modal-open-target='"+t.root.id+"']")&&(document.querySelector("[modal-open-target='"+t.root.id+"']").onclick=function(){t.root.style.display="block",t.onOpen&&t.onOpen()}),t.root.open=function(){t.root.style.display="block",t.onOpen&&t.onOpen()},t.root.close=function(){t.root.style.display="none",t.onClose&&t.onClose()},t.root.loadData=function(e,n){n=n||"data",t[n]=e,t.update()}}),riot.tag("itk-paginate",'<div onselectstart="return false" ondragstart="return false"> <div class="itk-paginate"> <li onclick="{ goFirst }">«</li> <li onclick="{ goPrev }">‹</li> </div> <ul class="itk-paginate"> <li each="{ pages }" onclick="{ parent.changePage }" class="{ active: parent.currentPage == page }">{ page }</li> </ul> <div class="itk-paginate"> <li onclick="{ goNext }">›</li> <li onclick="{ goLast }">»</li> </div> <div class="itk-paginate"> <form onsubmit="{ redirect }" style="position:relative;"> <span class="redirect" if="{ redirect }">跳转到<input class="jumpPage" name="page" riot-type={"number"} style="width: 40px;">页 </span> <div class="itk-paginate-tips" riot-style="top: { tipsTop }; left: { tipsLeft }; display: { showTip }"> 请输入1～{ pageCount }之间的数字 </div> <span class="page-sum" if="{ showPageCount }"> 共<em>{ pageCount }</em>页 </span> <span class="item-sum" if="{ showItemCount }"> <em>{ count }</em>条 </span> <input type="submit" style="display: none;"> </form> </div> </div>',function(e){var t=this,n=t.root,r=t.opts.opts||t.opts;if(t.showTip="none",t.count=r.count||0,t.pagesize=r.pagesize||20,t.pageCount=r.pageCount||Math.ceil(t.count/t.pagesize)||1,t.currentPage=r.currentPage||1,t.url=r.url||"",t.showNumber=r.showNumber||5,t.redirect=r.redirect||!0,t.showPageCount=r.showPageCount||!0,t.showItemCount=r.showItemCount||!0,t.needInit=r.needInit||!1,t.updateCurrentPage=function(){if(t.currentPage>Math.ceil(t.showNumber/2)&&t.pageCount>t.showNumber){if(t.pages=[],t.pageCount-t.currentPage>2)var e=t.currentPage-Math.ceil(t.showNumber/2),n=t.currentPage+Math.floor(t.showNumber/2);else var n=t.pageCount,e=t.pageCount-t.showNumber;for(i=e;i<n;i++)t.pages.push({page:i+1}),t.update()}else if(t.currentPage<Math.ceil(t.showNumber/2)+1&&t.pageCount>t.showNumber){for(t.pages=[],i=0;i<t.showNumber;i++)t.pages.push({page:i+1});t.pages.push({page:"..."})}},n.addCount=function(e){var n=t.count+e,i=t.pageCount;if(0>n?t.count=0:t.count=n,t.pageCount=Math.ceil(t.count/t.pagesize)||1,t.currentPage=t.currentPage>t.pageCount?t.pageCount:t.currentPage,t.pageCount<=t.showNumber){t.pages=[];for(var a=0;a<t.pageCount;a++)t.pages.push({page:a+1})}(t.needInit||t.pageCount<i&&t.currentPage<=t.pageCount)&&r.callback(t.currentPage),t.pageChange(t.currentPage),t.update()},t.pages=[],t.pageCount<t.showNumber+1)for(i=0;i<t.pageCount;i++)t.pages.push({page:i+1});else{for(i=0;i<t.showNumber;i++)t.pages.push({page:i+1});t.pages.push({page:"..."})}t.needInit&&r.callback(t.currentPage),t.updateCurrentPage(),t.update(),this.goFirst=function(e){t.pageChange(1)}.bind(this),this.goPrev=function(e){t.currentPage>1&&t.pageChange(t.currentPage-1)}.bind(this),this.goNext=function(e){t.currentPage<t.pageCount&&t.pageChange(t.currentPage+1)}.bind(this),this.goLast=function(e){t.pageChange(t.pageCount)}.bind(this),this.redirect=function(e){var n=parseInt(t.page.value,10);n&&n<t.pageCount+1&&n>0?t.pageChange(parseInt(n,10)):(t.tipsLeft=t.page.offsetLeft,t.tipsTop=t.page.offsetTop+t.page.offsetHeight+8,t.showTip="block",setTimeout(function(){t.showTip="none",t.update()},1500),t.update())}.bind(this),this.changePage=function(e){var n=e.item.page;return"string"==typeof n?!1:void t.pageChange(n)}.bind(this),t.pageChange=function(e){t.currentPage!=e&&(t.currentPage=e,r.callback(e)),t.updateCurrentPage()}}),riot.tag("itk-select",'<yield></yield> <ul class="itk-selected-container" onmousedown="{ showOptions }"> <li class="itk-selected-option" each="{realData }" if="{ selected }"> { name } <span class="itk-close" onmousedown="{ cancel }" >×</span> </li> <li class="itk-search-wrap" style="min-height: 34px;"> <input type="text" class="form-control itk-select-search" oninput="{ filter }" onfocus="{ filter }" onkeyup="{ keyboardHandle }"> </li> </ul> <ul class="itk-options-container"> <li class="itk-options" each="{ realData }" onmousedown="{ toggle }" if="{ !hide }"> <span class="itk-option-check" if="{ selected }"></span> <span class="empty-icon" if="{ !selected }"></span> { name } </li> <li class="no-result" if="{ noResult }">无搜索结果</li> </ul>',function(e){var t=this,n=t.opts.opts||t.opts;t.gotOptions=!1,t.chooseOnce=!0,t.init=t.root.init=function(){t.gotOptions=!1,t.update()},t.realData=[],t.root.exportData=t.realData,t.initData=t.root.initData=function(){if(t.root.querySelector("select"))var e=t.root.querySelector("select").querySelectorAll("option");if(e&&e.length&&!t.gotOptions){for(t.options=e,t.searchInput=t.root.querySelector(".itk-select-search"),t.optionsWrap=t.root.querySelector(".itk-options-container"),t.realData=[],i=0;i<e.length;i++)t.realData.push({name:e[i].innerHTML,value:e[i].getAttribute("value"),selected:e[i].getAttribute("selected"),index:i});t.searchInput.onfocus=function(){t.optionsWrap.style.display="block"},t.searchInput.onblur=function(){t.optionsWrap.style.display="none",t.searchInput.value="",t.resetSelectOpt()},t.gotOptions=!0,t.update()}},t.on("update",function(){setTimeout(function(){t.initData()},0)}),t.on("mount",function(){if(n){for(var e in n)t[e]=n[e];t.update()}}),t.filter=function(e){t.resetSelectOpt();var n=e.target.value;e.target.style.width=.9*n.length+1+"em";var r;for(i=0;i<t.realData.length;i++)t.realData[i].name.match(n)?(t.realData[i].hide=!1,r=!0):t.realData[i].hide=!0;t.noResult=!r},t.toggle=function(e){e.item.selected?(e.item.selected=!1,t.options[e.item.index].selected=!1):(e.item.selected=!0,t.options[e.item.index].selected=!0),t.update(),t.chooseOnce&&t.searchInput.blur()},t.cancel=function(e){e.stopPropagation(),e.item.selected=!1,t.options[e.item.index].selected=!1,t.update()},t.showOptions=function(e){t.searchInput&&t.searchInput!==document.activeElement?t.searchInput.focus():t.searchInput.blur()},t.keyboardHandle=function(e){var n=e.target;n.options=t.root.querySelectorAll(".itk-options"),void 0===n.seletedIndex&&(n.seletedIndex=-1);var r=e.keyCode;37===r||38===r?(t.clearSelectedOpt(n),n.seletedIndex--,n.seletedIndex<0&&(n.seletedIndex=n.options.length-1),t.setSelectedOpt(n)):39===r||40===r?(t.clearSelectedOpt(n),n.seletedIndex++,n.seletedIndex>=n.options.length&&(n.seletedIndex=0),t.setSelectedOpt(n)):13===r?t.chooseByKeyboard(n):27===r&&t.searchInput.blur()},t.chooseByKeyboard=function(e){var t=document.createEvent("MouseEvents"),n=e.options[e.seletedIndex];t.initEvent("mousedown",!0,!0),n&&n.dispatchEvent(t)},t.clearSelectedOpt=function(e){if(e.options){var t=e.options[e.seletedIndex];e.seletedIndex>=0&&t&&(t.style.background="",t.scrollIntoView())}},t.resetSelectOpt=function(){t.clearSelectedOpt(t.searchInput),t.searchInput.seletedIndex=-1},t.setSelectedOpt=function(e){var t=e.options[e.seletedIndex];t&&(t.style.background="#eff3f8",t.scrollIntoView())}}),riot.tag("itk-slide"," <yield>",function(e){for(var t=this,n=t.root,r=t.opts.opts||t.opts,i=document.scripts,a="",o="",s=0;s<i.length;s++)if(i[s].src&&/iToolkit_pc.min.js|iToolkit_pc.js/.test(i[s].src)){o=i[s].src.replace(/iToolkit_pc.min.js|iToolkit_pc.js/,"");break}a=o+"plugins/","undefined"==typeof jQuery?!function(){utils.jsLoader([a+"jquery/jquery-1.12.0.min.js"],function(){jQuery(document).ready(function(e){utils.jsLoader([a+"slick/slick.css",a+"slick/slick-theme.css",a+"slick/slick.js"],function(){e(document).ready(function(){e(n).slick(r)})})})})}():jQuery(document).ready(function(e){utils.jsLoader([a+"slick/slick.css",a+"slick/slick-theme.css",a+"slick/slick.js"],function(){e(document).ready(function(){e(n).slick(r)})})}),t.on("mount",function(){t.root.style.display="block"})}),riot.tag("itk-table","<yield>",function(e){var t=this,n=t.opts.opts||t.opts,r=t.root;t.init=function(){r.style.display="block";for(i in n)t[i]||(t[i]=n[i]);t.originData=utils.deepCopy(t.data),t.update()},t.on("mount",function(){t.init()}),t.compare=function(e,n){return e[t.orderkeyName]>n[t.orderkeyName]?1:e[t.orderkeyName]===n[t.orderkeyName]?0:-1},t.clearOrder=function(){t.ordered=!1,t.reversed=!1},t.loadData=r.loadData=function(e){return t.data=e,t.originData=utils.deepCopy(e),t.update(),t.data},t.exportData=r.exportData=function(){return t.data},t.reset=r.reset=function(){t.data=utils.deepCopy(t.originData),t.update()},t.orderBy=function(e){return function(){return t.orderkeyName=e,t.ordered!==e&&(t.reversed!==e?t.data=t.data.sort(t.compare):t.data=t.data.reverse(),t.ordered=e,t.reversed=!1,t.update()),t.data}},r.orderBy=function(e){t.orderBy(e)()},t.reverseBy=function(e){return function(){return t.orderkeyName=e,t.reversed!==e&&(t.ordered!==e?(t.data=t.data.sort(t.compare),t.data=t.data.reverse()):t.data=t.data.reverse(),t.ordered=!1,t.reversed=e,t.update()),t.data}},r.reverseBy=function(e){t.reverseBy(e)()},t.toggleBy=function(e){return t.ordered===e?t.reverseBy(e):t.orderBy(e)},r.toggleBy=function(e){t.ordered===e?r.reverseBy(e):r.orderBy(e)},t.append=function(e){return function(){t.clearOrder(),utils.isObject(e)?t.data.push(e):utils.isArray(e)&&(t.data=t.data.concat(e)),t.update()}},r.append=function(e){t.append(e)()},t.prepend=function(e){return function(){t.clearOrder(),utils.isObject(e)?t.data.unshift(e):utils.isArray(e)&&(t.data=e.concat(t.data)),t.update()}},r.prepend=function(e){t.prepend(e)()},t.deleteBy=function(e,n){return function(){if(e&&n){t.clearOrder();for(var r=0;r<t.data.length;r++)t.data[r][e]===n&&(t.data.splice(r,1),r-=1);t.update()}}},r.deleteBy=function(e,n){t.deleteBy(e,n)()}}),riot.tag("itk-tree-item",'<input type="checkbox" __checked="{ item.selected }" if="{ parent.rootConfig.showCheck }" onchange="{ checkHandle }"> <i class="tree-item-arrow { open: item.opened }" onclick="{ toggle }" if="{ item.children }"></i> <i class="tree-item-icon" if="{ item.children }"></i> <div onclick="{ leftClick }">{ item.name }</div>',function(e){var t=this;t.selectchildren=function(e,n){var r=function(e){if(e&&e.children)for(var t=0;t<e.children.length;t++)e.children[t].selected=n,r(e.children[t])};r(e,n),t.parent.treeroot.update()},t.cancelParent=function(e){var n=function(e){e&&e.pnode&&(e.pnode.selected=!1,n(e.pnode))};n(e),t.parent.treeroot.update()},this.checkHandle=function(e){var n=t.parent.rootConfig,r=n.onCheck,i=n.onUnCheck;t.item.selected?(t.item.selected=!1,i&&i(t.item,e.target),n.link&&(t.selectchildren(t.item,!1),t.cancelParent(t.item))):t.item.selected||(t.item.selected=!0,r&&r(t.item,e.target),n.link&&t.selectchildren(t.item,!0))}.bind(this),this.toggle=function(e){t.item.opened===!0?t.item.opened=!1:t.item.opened=!0,t.parent.treeroot.update()}.bind(this),this.leftClick=function(e){var n=t.parent.rootConfig;if(n.folder&&n.children)t.item.opened===!0?t.item.opened=!1:t.item.opened=!0;else{var r=n.onLeftClick;r&&r(t.item,e.target)}}.bind(this)}),riot.tag("itk-tree",'<div class="tree-item-wrap" each="{ item, i in data }" onselectstart="return false" ondragstart="return false"> <itk-tree-item class="tree-item-row { root: item.level==1 }" riot-style="padding-left: { countPadding(item.level) }"></itk-tree-item> <ul class="tree-child-wrap" if="{ item.opened && item.children }"> <itk-tree data="{ item.children }"></itk-tree> </ul> </div>',function(e){var t=this;if(t.config=t.opts.opts||t.opts,t.dataHandle=function(e,n,r){var e=e||[],i=n||"id",a=r||"pid",o={};e.forEach(function(e){t.config.name&&(e.name=e[t.config.name]),o[e[i]]=e});var s=[];e.forEach(function(e){var t=o[e[a]];t?(t.children||(t.children=[]),e.pnode=t,t.children.push(e)):s.push(e)});var u=function(e,n){var n=n+1;e.forEach(function(e){e.level=n-1,e.level<t.config.openLevel+1&&(e.opened=!0),e.children&&u(e.children,n)})};return u(s,1),s},t.parent&&"ITK-TREE"===t.parent.root.tagName)t.data=t.config.data,t.rootConfig=t.parent.rootConfig||t.parent.parent.rootConfig,t.treeroot=t.parent.treeroot||t.parent.parent.treeroot;else{if(t.config.handleData){var n=t.dataHandle(t.config.data);t.data=n}t.rootConfig=t.config,t.treeroot=t}t.treeroot.update(),this.countPadding=function(e){var n=t.rootConfig.padding||20;return(e-1)*n+"px"}.bind(this)}),riot.tag("itk-uploader",'<div class="btn btn-large btn-primary" name="uploadBtn" id="uploadBtn">上传</div>',function(e){var t=this,n=(t.root,t.opts.opts||t.opts),r=function(e,t){return Math.floor(e+Math.random()*(t-e))};t.uploadBtn.id=r(1e4,99999);for(var i=document.scripts,a="",o=0;o<i.length;o++)if(i[o].src&&/iToolkit_pc.min.js|iToolkit_pc.js/.test(i[o].src)){a=i[o].src.replace(/iToolkit_pc.min.js|iToolkit_pc.js/,"");break}path=a+"plugins/uploader/";var s=[path+"SimpleAjaxUploader.min.js"];utils.jsLoader(s,function(){var e=document.getElementById(t.uploadBtn.id);console.log(e);var r={};r.button=e,r.url=n.url,r.name=n.name?n.name:"",r.multipart=n.multipart?n.multipart:!0,r.responseType=n.responseType?n.responseType:"",r.startXHR=n.startXHR?n.startXHR:null,r.onSubmit=n.onSubmit?n.onSubmit:null,r.onComplete=n.onComplete?n.onComplete:null,r.onError=n.onError?n.onError:null;new ss.SimpleUpload(r)})});