!function(t){"use strict";function e(t){var e=O(0),n=t.slice(e.length).match(/\s*(\S+?)\s*(?:,\s*(\S)+)?\s+in\s+(.+)/);return n?{key:n[1],pos:n[2],val:e+n[3]}:{val:t}}function n(t,e,n){var i={};return i[t.key]=e,t.pos&&(i[t.pos]=n),i}function i(t,i,o){d(t,"each");var a,s=t.outerHTML,l=t.parentNode,u=document.createComment("riot placeholder"),c=[],p=M(t);l.insertBefore(u,t),o=e(o),i.one("premount",function(){l.stub&&(l=i.root),t.parentNode.removeChild(t)}).on("update",function(){var e,d=R(o.val,i);if(!D(d)){if(e=a,a=d?JSON.stringify(d):"",a===e)return;d=d?Object.keys(d).map(function(t){return n(o,t,d[t])}):[]}for(var f=document.createDocumentFragment(),m=c.length,h=d.length;m>h;)c[--m].unmount();for(c.length=h,e=!a&&!!o.key,m=0;h>m;++m){var v=e?n(o,d[m],m):d[m];c[m]||((c[m]=new r({tmpl:s},{parent:i,isLoop:!0,root:l,item:v})).mount(),f.appendChild(c[m].root)),c[m]._item=v,c[m].update(v)}l.insertBefore(f,u),p&&(i.tags[g(t)]=c)}).one("updated",function(){var t=Object.keys(i);v(l,function(e){1!=e.nodeType||e.isLoop||e._looped||(e._visited=!1,e._looped=!0,T(e,i,t))})})}function o(t,e,n){v(t,function(t){if(1==t.nodeType){t.isLoop=t.parentNode&&t.parentNode.isLoop||t.getAttribute("each")?1:0;var i=M(t);if(i&&!t.isLoop){for(var o,a=new r(i,{root:t,parent:e},t.innerHTML),s=g(t),l=e;!M(l.root)&&l.parent;)l=l.parent;a.parent=l,o=l.tags[s],o?(D(o)||(l.tags[s]=[o]),l.tags[s].push(a)):l.tags[s]=a,t.innerHTML="",n.push(a)}t.isLoop||T(t,e,[])}})}function a(t,e,n){function o(t,e,i){if(e.indexOf(O(0))>=0){var o={dom:t,expr:e};n.push(m(o,i))}}v(t,function(t){var n=t.nodeType;if(3==n&&"STYLE"!=t.parentNode.tagName&&o(t,t.nodeValue),1==n){var a=t.getAttribute("each");return a?(i(t,e,a),!1):(c(t.attributes,function(e){var n=e.name,i=n.split("__")[1];return o(t,e.value,{attr:i||n,bool:i}),i?(d(t,n),!1):void 0}),M(t)?!1:void 0)}})}function r(t,e,n){function i(){c(x.attributes,function(t){p[t.name]=R(t.value,g||l)}),c(Object.keys(M),function(t){p[t]=R(M[t],g||l)})}function r(t){if(c(T,function(e){e[t?"mount":"unmount"]()}),g){var e=t?"on":"off";v?g[e]("unmount",l.unmount):g[e]("update",l.update)[e]("unmount",l.unmount)}}var s,l=P.observable(this),p=k(e.opts)||{},d=h(t.tmpl),g=e.parent,v=e.isLoop,y=e.item,C=[],T=[],x=e.root,N=t.fn,S=x.tagName.toLowerCase(),M={},L=/([\w\-]+)\s?=\s?['"]([^'"]+)["']/gim;if(N&&x._tag&&x._tag.unmount(!0),this.isMounted=!1,t.attrs){var A=t.attrs.match(L);c(A,function(t){var e=t.split(/\s?=\s?/);x.setAttribute(e[0],e[1].replace(/['"]/g,""))})}x._tag=this,this._id=f(~~((new Date).getTime()*Math.random())),m(this,{parent:g,root:x,opts:p,tags:{}},y),c(x.attributes,function(t){var e=t.value;O(/\{.*\}/).test(e)&&(M[t.name]=e)}),d.innerHTML&&!/select|select|optgroup|tbody|tr/.test(S)&&(d.innerHTML=w(d.innerHTML,n)),this.update=function(t){m(l,t),i(),l.trigger("update",t),u(C,l,t),l.trigger("updated")},this.mixin=function(){c(arguments,function(t){t="string"==typeof t?P.mixin(t):t,c(Object.keys(t),function(e){"init"!=e&&(l[e]="function"==typeof t[e]?t[e].bind(l):t[e])}),t.init&&t.init.bind(l)()})},this.mount=function(){if(i(),N&&N.call(l,p),r(!0),a(d,l,C),l.parent||l.update(),l.trigger("premount"),v)l.root=x=s=d.firstChild;else{for(;d.firstChild;)x.appendChild(d.firstChild);x.stub&&(l.root=x=g.root)}!l.parent||l.parent.isMounted?(l.isMounted=!0,l.trigger("mount")):l.parent.one("mount",function(){b(l.root)||(l.parent.isMounted=l.isMounted=!0,l.trigger("mount"))})},this.unmount=function(t){var e=s||x,n=e.parentNode;if(n){if(g)D(g.tags[S])?c(g.tags[S],function(t,e){t._id==l._id&&g.tags[S].splice(e,1)}):g.tags[S]=void 0;else for(;e.firstChild;)e.removeChild(e.firstChild);t||n.removeChild(e)}l.trigger("unmount"),r(),l.off("*"),x._tag=null},o(d,this,T)}function s(e,n,i,o,a){i[e]=function(e){e=e||t.event,e.which||(e.which=e.charCode||e.keyCode),e.target||(e.target=e.srcElement);try{e.currentTarget=i}catch(r){}if(e.item=o._item?o._item:a,n.call(o,e)===!0||/radio|check/.test(i.type)||(e.preventDefault&&e.preventDefault(),e.returnValue=!1),!e.preventUpdate){var s=a?o.parent:o;s.update()}}}function l(t,e,n){t&&(t.insertBefore(n,e),t.removeChild(e))}function u(t,e,n){c(t,function(t,i){var o=t.dom,a=t.attr,r=R(t.expr,e),u=t.dom.parentNode;if(null==r&&(r=""),u&&"TEXTAREA"==u.tagName&&(r=r.replace(/riot-/g,"")),t.value!==r){if(t.value=r,!a)return o.nodeValue=r.toString();if(d(o,a),"function"==typeof r)s(a,r,o,e,n);else if("if"==a){var c=t.stub;r?c&&(l(c.parentNode,c,o),o.inStub=!1,b(o)||v(o,function(t){t._tag&&!t._tag.isMounted&&(t._tag.isMounted=!!t._tag.trigger("mount"))})):(c=t.stub=c||document.createTextNode(""),l(o.parentNode,o,c),o.inStub=!0)}else if(/^(show|hide)$/.test(a))"hide"==a&&(r=!r),o.style.display=r?"":"none";else if("value"==a)o.value=r;else if("riot-"==a.slice(0,5)&&"riot-tag"!=a)a=a.slice(5),r?o.setAttribute(a,r):d(o,a);else{if(t.bool){if(o[a]=r,!r)return;r=a}"object"!=typeof r&&o.setAttribute(a,r)}}})}function c(t,e){for(var n,i=0,o=(t||[]).length;o>i;i++)n=t[i],null!=n&&e(n,i)===!1&&i--;return t}function p(t){return"function"==typeof t||!1}function d(t,e){t.removeAttribute(e)}function f(t){return(t^t>>31)-(t>>31)}function g(t){var e=M(t),n=t.getAttribute("name"),i=n&&n.indexOf(O(0))<0?n:e.name;return i}function m(t){for(var e,n=arguments,i=1;i<n.length;++i)if(e=n[i])for(var o in e)t[o]=e[o];return t}function h(t){var e=_&&10>_,n=/^\s*<([\w-]+)/.exec(t),i=n?n[1].toLowerCase():"",o="th"===i||"td"===i?"tr":"tr"===i?"tbody":"div",a=y(o);return a.stub=!0,e&&("optgroup"===i?S(a,t):"option"===i?N(a,t):"div"!==o?x(a,t,i):e=0),e||(a.innerHTML=t),a}function v(t,e){if(t)if(e(t)===!1)v(t.nextSibling,e);else for(t=t.firstChild;t;)v(t,e),t=t.nextSibling}function b(t){for(;t;){if(t.inStub)return!0;t=t.parentNode}return!1}function y(t){return document.createElement(t)}function w(t,e){return t.replace(/<(yield)\/?>(<\/\1>)?/gim,e||"")}function C(t,e){return(e||document).querySelectorAll(t)}function k(t){function e(){}return e.prototype=t,new e}function T(t,e,n){c(t.attributes,function(i){if(!t._visited&&("id"===i.name||"name"===i.name)){t._visited=!0;var o,a=i.value;if(~n.indexOf(a))return;o=e[a],o?D(o)?o.push(t):e[a]=[o,t]:e[a]=t}})}function x(t,e,n){var i,o=y("div"),a=/td|th/.test(n)?3:2;for(o.innerHTML="<table>"+e+"</table>",i=o.firstChild;a--;)i=i.firstChild;t.appendChild(i)}function N(t,e){var n=y("option"),i=/value=[\"'](.+?)[\"']/,o=/selected=[\"'](.+?)[\"']/,a=/each=[\"'](.+?)[\"']/,r=/if=[\"'](.+?)[\"']/,s=/>([^<]*)</,l=e.match(i),u=e.match(o),c=e.match(s),p=e.match(a),d=e.match(r);n.innerHTML=c?c[1]:e,l&&(n.value=l[1]),u&&n.setAttribute("riot-selected",u[1]),p&&n.setAttribute("each",p[1]),d&&n.setAttribute("if",d[1]),t.appendChild(n)}function S(t,e){var n=y("optgroup"),i=/label=[\"'](.+?)[\"']/,o=/^<([^>]*)>/,a=/^<([^ \>]*)/,r=e.match(i),s=e.match(o),l=e.match(a),u=e;if(s){var c=e.slice(s[1].length+2,-l[1].length-3).trim();u=c}if(r&&n.setAttribute("riot-label",r[1]),u){var p=y("div");N(p,u),n.appendChild(p.firstChild)}t.appendChild(n)}function M(t){return V[t.getAttribute(W)||t.tagName.toLowerCase()]}function L(t){if(H=H||y("style"),document.head){if(H.styleSheet?H.styleSheet.cssText+=t:H.innerHTML+=t,!H._rendered)if(H.styleSheet)document.body.appendChild(H);else{var e=C("style[type=riot]")[0];e?(e.parentNode.insertBefore(H,e),e.parentNode.removeChild(e)):document.head.appendChild(H)}H._rendered=!0}}function A(t,e,n){var i=V[e],o=t._innerHTML=t._innerHTML||t.innerHTML;return t.innerHTML="",i&&t&&(i=new r(i,{root:t,opts:n},o)),i&&i.mount?(i.mount(),I.push(i),i.on("unmount",function(){I.splice(I.indexOf(i),1)})):void 0}var P={version:"v2.2.1",settings:{}},E="string",j="object",D=Array.isArray||function(){var t=Object.prototype.toString;return function(e){return"[object Array]"===t.call(e)}}(),_=function(t){return 0|(t&&t.document||{}).documentMode}(t);P.observable=function(t){t=t||{};var e={},n=0;return t.on=function(i,o){return p(o)&&(o._id="undefined"==typeof o._id?n++:o._id,i.replace(/\S+/g,function(t,n){(e[t]=e[t]||[]).push(o),o.typed=n>0})),t},t.off=function(n,i){return"*"==n?e={}:n.replace(/\S+/g,function(t){if(i)for(var n,o=e[t],a=0;n=o&&o[a];++a)n._id==i._id&&(o.splice(a,1),a--);else e[t]=[]}),t},t.one=function(e,n){function i(){t.off(e,i),n.apply(t,arguments)}return t.on(e,i)},t.trigger=function(n){for(var i,o=[].slice.call(arguments,1),a=e[n]||[],r=0;i=a[r];++r)i.busy||(i.busy=1,i.apply(t,i.typed?[n].concat(o):o),a[r]!==i&&r--,i.busy=0);return e.all&&"all"!=n&&t.trigger.apply(t,["all",n].concat(o)),t},t},P.mixin=function(){var t={};return function(e,n){return n?void(t[e]=n):t[e]}}(),function(t,e,n){function i(){return s.href.split("#")[1]||""}function o(t){return t.split("/")}function a(t){t.type&&(t=i()),t!=r&&(l.trigger.apply(null,["H"].concat(o(t))),r=t)}if(n){var r,s=n.location,l=t.observable(),u=n,c=!1,p=t.route=function(t){t[0]?(s.hash=t,a(t)):l.on("H",t)};p.exec=function(t){t.apply(null,o(i()))},p.parser=function(t){o=t},p.stop=function(){c&&(u.removeEventListener?u.removeEventListener(e,a,!1):u.detachEvent("on"+e,a),l.off("*"),c=!1)},p.start=function(){c||(u.addEventListener?u.addEventListener(e,a,!1):u.attachEvent("on"+e,a),c=!0)},p.start()}}(P,"hashchange",t);var H,O=function(t){var e,n,i,o=/[{}]/g;return function(a){var r=P.settings.brackets||t;return e!==r&&(e=r,i=r.split(" "),n=i.map(function(t){return t.replace(/(?=.)/g,"\\")})),a instanceof RegExp?r===t?a:new RegExp(a.source.replace(o,function(t){return n[~~("}"===t)]}),a.global?"g":""):i[a]}}("{ }"),R=function(){function e(t,e){return t=(t||O(0)+O(1)).replace(O(/\\{/g),"￰").replace(O(/\\}/g),"￱"),e=o(t,a(t,O(/{/),O(/}/))),new Function("d","return "+(e[0]||e[2]||e[3]?"["+e.map(function(t,e){return e%2?n(t,!0):'"'+t.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")':n(e[1])).replace(/\uFFF0/g,O(0)).replace(/\uFFF1/g,O(1))+";")}function n(t,e){return t=t.replace(/\n/g," ").replace(O(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),""),/^\s*[\w- "']+ *:/.test(t)?"["+a(t,/["' ]*[\w- ]+["' ]*:/,/,(?=["' ]*[\w- ]+["' ]*:)|}|$/).map(function(t){return t.replace(/^[ "']*(.+?)[ "']*: *(.+?),? *$/,function(t,e,n){return n.replace(/[^&|=!><]+/g,i)+'?"'+e+'":"",'})}).join("")+'].join(" ").trim()':i(t,e)}function i(e,n){return e=e.trim(),e?"(function(v){try{v="+(e.replace(s,function(e,n,i){return i?"(d."+i+"===undefined?"+("undefined"==typeof t?"global.":"window.")+i+":d."+i+")":e})||"x")+"}catch(e){}finally{return "+(n===!0?'!v&&v!==0?"":v':"v")+"}}).call(d)":""}function o(t,e){var n=[];return e.map(function(e,i){i=t.indexOf(e),n.push(t.slice(0,i),e),t=t.slice(i+e.length)}),n.concat(t)}function a(t,e,n){var i,o=0,a=[],r=new RegExp("("+e.source+")|("+n.source+")","g");return t.replace(r,function(e,n,r,s){!o&&n&&(i=s),o+=n?1:-1,o||null==r||a.push(t.slice(i,s+r.length))}),a}var r={},s=/(['"\/]).*?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_$]\w*)/gi;return function(t,n){return t&&(r[t]=r[t]||e(t))(n)}}(),I=[],V={},W="riot-tag";P.tag=function(t,e,n,i,o){return p(i)&&(o=i,/^[\w\-]+\s?=/.test(n)?(i=n,n=""):i=""),n&&(p(n)?o=n:L(n)),V[t]={name:t,tmpl:e,attrs:i,fn:o},t},P.mount=function(t,e,n){function i(t){var e="";return c(t,function(t){e+=', *[riot-tag="'+t.trim()+'"]'}),e}function o(){var t=Object.keys(V);return t+i(t)}function a(t){if(t.tagName){e&&!t.getAttribute(W)&&t.setAttribute(W,e);var i=A(t,e||t.getAttribute(W)||t.tagName.toLowerCase(),n);i&&l.push(i)}else t.length&&c(t,a)}var r,s,l=[];if(typeof e===j&&(n=e,e=0),typeof t===E?("*"===t?t=s=o():t+=i(t.split(",")),r=C(t)):r=t,"*"===e){if(e=s||o(),r.tagName)r=C(e,r);else{var u=[];c(r,function(t){u.push(C(e,t))}),r=u}e=0}return r.tagName?a(r):c(r,a),l},P.update=function(){return c(I,function(t){t.update()})},P.mountTo=P.mount,P.util={brackets:O,tmpl:R},"object"==typeof exports?module.exports=P:"function"==typeof define&&define.amd?define(function(){return P}):t.riot=P}("undefined"!=typeof window?window:void 0);var utils={httpGet:function(t,e,n){var i=new XMLHttpRequest,t=utils.concatParams(t,e);i.open("GET",t,!0),i.send(null),i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){var t=i.responseText;try{if("string"==typeof t)var e=JSON.parse(t);else var e=t}catch(o){alert("解析错误")}n(e)}}},httpPost:function(t,e,n,i){var o=new XMLHttpRequest;o.open("POST",t,!0),o.setRequestHeader("Content-type","application/json"),o.send(e),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){try{var t=JSON.parse(o.responseText)}catch(e){console.log("解析错误")}n(t)}else console.log("网络错误")}},jsonp:function(t,e,n){var i=Date.now(),o=document.createElement("script"),a=document.getElementsByTagName("head")[0],t=utils.concatParams(t,e);if(e.callback)var r=t,s=e.callback;else{if(t.match(/\?/))var r=t+"&callback=jsonpCallback"+i;else var r=t+"?callback=jsonpCallback"+i;var s="jsonpCallback"+i}o.src=r,a.appendChild(o),window[s]=function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}n(t)},o.onerror=function(){console.log("jsonp error")},o.onload=function(){a.removeChild(o)}},htmlEncode:function(t){var e=document.createElement("div");return e.innerHTML=t,e.innerText},concatParams:function(t,e){if(t.match(/\?/))var n="&";else var n="?";for(i in e)n=n+i+"="+e[i]+"&";return n=n.replace(/&$/,""),t+n},setCookie:function(t,e,n,i){var o=new Date,i=i||"/";o.setTime(o.getTime()+n),document.cookie=t+"="+escape(e)+";path="+i+";expires="+o.toGMTString()},transBytes:function(t){var e=["B","KB","MB","GB","TB"];if(0==t)return"n/a";var n=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return 0==n?t+e[n]:(t/Math.pow(1024,n)).toFixed(1)+e[n]},transTimes:function(t){var t=parseInt(t,10),e=new Date(1e3*t),n=(new Date).getTime()/1e3,i=n-t;if(86400>i)return e.getHours()+":"+e.getMinutes();if(i>86400&&172800>i)return"昨天";if(i>172800){var o=(e.getFullYear()+"-").substring(2),a=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",r=e.getDate()<10?"0"+e.getDate():e.getDate();return o+a+r}},hasClass:function(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},addClass:function(t,e){t.className.trim(),this.hasClass(t,e)||(t.className+=" "+e)},removeClass:function(t,e){if(utils.hasClass(t,e)){var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}},toggleClass:function(t,e){if(utils.hasClass(t,e)){var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}else t.className+=" "+e},insertAfter:function(t,e){var n=e.parentNode;n.lastChild==e?n.appendChild(t):n.insertBefore(t,e.nextSibling)}};riot.tag("dropdown","",function(t){}),riot.tag("editable-link",'<a href="javascript:void(0);" if="{ !editable }" onclick="{ open }">{ value }</a> <super-form if="{ editable }" action="{ action }" opts="{ formOpts }"> <input type="text" value="{ parent.value }" name="{ parent.name }" class="editable-link-input"> <input type="submit" value="提交"> <button onclick="{ parent.close }">取消</button> </super-form>',function(t){var e=this;e.editlink=!1;var n=e.root,i=e.opts.opts||e.opts;e.on("mount",function(){e.action=n.getAttribute("action"),e.value=n.getAttribute("text"),e.name=n.getAttribute("name"),e.update()}),this.open=function(t){e.editable=!0,e.update()}.bind(this),this.close=function(t){e.editable=!1,e.update()}.bind(this),e.formOpts={errCallback:function(){i.errCallback(),n.querySelector(".editable-link-input").value=e.value,e.editable=!1,e.update()},callback:function(t){i.callback(),e.value=n.querySelector(".editable-link-input").value,e.editable=!1,e.update()}}}),riot.tag("file-upload",'<div id="uploader" class="wu-example">  <div id="thelist" class="uploader-list"></div> <div class="btns"> <div id="picker">选择文件</div> <button id="ctlBtn" class="btn btn-default">开始上传</button> </div> </div>',function(t){var e=this,n=e.opts.opts||e.opts,i=document.getElementsByTagName("head")[0],o=document.createElement("script");o.src=n.jsUrl||"http://cdn.staticfile.org/webuploader/0.1.1/webuploader.js";var a=document.createElement("script");a.src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js",e.getSource=function(){window.WebUploader||i.appendChild(o)},window.jQuery?e.getSource():(i.appendChild(a),a.onload=e.getSource),o.onload=function(){console.log(WebUploader);var t=WebUploader.create({swf:"/js/Uploader.swf",server:"http://webuploader.duapp.com/server/fileupload.php",pick:"#picker",resize:!1});console.log(t),t.on("uploadProgress",function(t,e){var n=$("#"+t.id),i=n.find(".progress .progress-bar");i.length||(i=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(n).find(".progress-bar")),n.find("p.state").text("上传中"),i.css("width",100*e+"%")}),t.on("uploadSuccess",function(t){$("#"+t.id).find("p.state").text("已上传")}),t.on("uploadError",function(t){$("#"+t.id).find("p.state").text("上传出错")}),t.on("uploadComplete",function(t){$("#"+t.id).find(".progress").fadeOut()})}}),riot.tag("goto-top",'<div class="itoolkit-goto-top" show="{ showGotoTop }" onclick="{ gotoTop }"> <span class="icon" if="{ !config.img }"><span class="icon-arrowUp"></span></span> <img riot-src="{ config.img }" if="{ config.img }"> </div>',"goto-top .itoolkit-goto-top{ display: block; position: fixed; bottom: 50px; right: 40px; height: 60px; width: 60px; z-index: 10000; text-align: center; opicity: 0.5; cursor: pointer; } goto-top .itoolkit-goto-top .icon{ font-size: 3em; margin: auto; float: none; }",function(t){var e=this;e.config=e.opts.opts||e.opts;var n=window.screen.availHeight;e.on("mount",function(){e.root.querySelector(".itoolkit-goto-top").style.bottom=e.config.bottom,e.root.querySelector(".itoolkit-goto-top").style.right=e.config.right,window.addEventListener("scroll",e.controlGotoTop)}),e.controlGotoTop=function(){var t=document.body;t.scrollTop>n&&!e.showGotoTop?(e.showGotoTop=!0,e.update()):t.scrollTop<n&&e.showGotoTop&&(e.showGotoTop=!1,e.update())},this.gotoTop=function(t){var e=document.body.scrollTop/100*16,n=setInterval(function(){document.body.scrollTop=document.body.scrollTop-e,document.body.scrollTop<10&&clearInterval(n)},16)}.bind(this),window.test=e}),riot.tag("loading",'<div class="{itoolkit-loading: true, default: default}" > <img riot-src="{ img }" if="{ img }" width="{ width }" alt="loading"> </div>',"loading .itoolkit-loading { text-align: center; }",function(t){var e=this,n=e.opts.opts||e.opts;n.img?e.img=n.img:(e.img=!1,e["default"]=!0),e.on("mount",function(){var t=e.root.getElementsByClassName("itoolkit-loading")[0],i=t.querySelector("loading .itoolkit-loading img");i&&(i.style.height=n.imgHeight||"50px");var o=parseInt(window.getComputedStyle(t,null).height.replace("px",""),10),a=e.root.parentNode,r=window.getComputedStyle(a,null).position;e.root.style.marginTop="-"+o/2+"px","static"===r&&(a.style.position="relative")}),e.root.show=function(t){childDom&&(childDom.style.display="block")},e.root.hide=function(t){childDom&&(childDom.style.display="none")}}),riot.tag("modal",'<div class="itoolkit-modal-dialog" riot-style="width:{width}px; height:{height}px"> <div class="itoolkit-modal-title"> <span>{ title }</span> <div class="itoolkit-modal-close-wrap" onclick="{ close }"> <div class="itoolkit-modal-close"></div> </div> </div> <div class="itoolkit-modal-container"> <yield> </div> </div>',function(t){var e=this,n=e.opts.opts||e.opts;for(i in n)e[i]=n[i];e.width=n.width||600,e.height=n.height||300,this.close=function(t){e.root.style.display="none"}.bind(this),document.querySelector("[modal-open-target='"+e.root.id+"']").onclick=function(){e.root.style.display="block"},e.root.open=function(){e.root.style.display="block"},e.root.close=function(){e.root.style.display="none"}}),riot.tag("paginate",'<div onselectstart="return false" ondragstart="return false"> <div class="paginate"> <li onclick="{ goFirst }">«</li> <li onclick="{ goPrev }">‹</li> </div> <ul class="paginate"> <li each="{ pages }" onclick="{ parent.changePage }" class="{ active: parent.currentPage == page }">{ page }</li> </ul> <div class="paginate"> <li onclick="{ goNext }">›</li> <li onclick="{ goLast }">»</li> </div> <div class="paginate"> <form onsubmit="{ redirect }"> <span class="redirect" if="{ redirect }">跳转到<input name="page" type="number" style="width: 40px;" min="1" max="{ pageCount }">页 </span> <span class="page-sum" if="{ showPageCount }"> 共<em>{ pageCount }</em>页 </span> <span class="item-sum" if="{ showItemCount }"> <em>{ count }</em>条 </span> <input type="submit" style="display: none;"> </form> </div> </div>',function(t){var e=this,n=e.opts.opts||e.opts;if(e.count=n.count||0,e.pagesize=n.pagesize||20,e.pageCount=n.pageCount||Math.ceil(e.count/e.pagesize)||1,e.currentPage=n.currentPage||1,e.url=n.url||"",e.showNumber=n.showNumber||5,e.redirect=n.redirect||!0,e.showPageCount=n.showPageCount||!0,e.showItemCount=n.showItemCount||!0,e.needInit=n.needInit||!1,e.needInit&&n.callback(e.currentPage),e.pages=[],e.pageCount<e.showNumber+1)for(i=0;i<e.pageCount;i++)e.pages.push({page:i+1});else{for(i=0;i<e.showNumber;i++)e.pages.push({page:i+1});e.pages.push({page:"..."})}e.update(),this.goFirst=function(t){e.pageChange(1)}.bind(this),this.goPrev=function(t){e.currentPage>1&&e.pageChange(e.currentPage-1)}.bind(this),this.goNext=function(t){e.currentPage<e.pageCount&&e.pageChange(e.currentPage+1)}.bind(this),this.goLast=function(t){e.pageChange(e.pageCount)}.bind(this),this.redirect=function(t){var n=e.page.value;parseInt(n,10)&&parseInt(n,10)<e.pageCount+1&&e.pageChange(parseInt(n,10))}.bind(this),this.changePage=function(t){var n=t.item.page;return"string"==typeof n?!1:void e.pageChange(n)}.bind(this),e.pageChange=function(t){if(e.currentPage!=t&&(e.currentPage=t,n.callback(t)),e.currentPage>Math.ceil(e.showNumber/2)&&e.pageCount>e.showNumber){if(e.pages=[],e.pageCount-e.currentPage>2)var o=e.currentPage-Math.ceil(e.showNumber/2),a=e.currentPage+Math.floor(e.showNumber/2);else var a=e.pageCount,o=e.pageCount-e.showNumber;for(i=o;i<a;i++)e.pages.push({page:i+1}),e.update()}else if(e.currentPage<Math.ceil(e.showNumber/2)+1&&e.pageCount>e.showNumber){for(e.pages=[],i=0;i<e.showNumber;i++)e.pages.push({page:i+1});e.pages.push({page:"..."})}}}),riot.tag("select-box","",function(t){}),riot.tag("side-list",'<ul > <li each="{ data }"> <img riot-src="{ logoUrl }" if="{ isLogo }"> <span>{ name }</span> </li> </ul>',function(t){}),riot.tag("slide","",function(t){}),riot.tag("super-div","<style scope> super-div{ display: block; } </style> <yield>",function(t){var e=this,n=e.opts.opts||e.opts,o=e.root;for(i in n)e[i]=n[i];e.getData=function(t){var t=t||{};if(o.getAttribute("data-get"))var n="httpGet";else if(o.getAttribute("data-jsonp"))var n="jsonp";utils[n](e.superDivUrl,t,function(t){for(i in t)e.data={},e.data[i]=t[i];e.update()})},e.on("mount",function(){e.superDivUrl=o.getAttribute("data-get")||o.getAttribute("data-jsonp"),e.superDivUrl&&e.getData(n.params)}),e.loadData=o.loadData=function(t,n){n=n||"data",e[n]=t,e.update()},e.reload=o.reload=function(){e.superDivUrl?e.getData(n.params):e.update()}}),riot.tag("super-form",'<form onsubmit="{ submit }" > <yield> </form>',function(t){var e=this,n=e.root,o=e.opts.opts||e.opts,a=["insertTip","ajaxSubmit","submit"];e.presentWarning="必填",e.emailWarning="邮箱格式错误",e.mobileWarning="手机格式错误",e.urlWarning="网址格式错误",e.successTips="通过",e.regWarning="字段不符合验证规则",e.passClass=o.passClass||"valid-pass",e.failedClass=o.failedClass||"valid-failed",n.loadData=function(t,n){n=n||"data",e[n]=t,e.update()};for(i in o)a.indexOf(i)<0&&(e[i]=o[i]);e.data=o.data,e.submitingText=o.submitingText||"提交中...",void 0===o.valid&&(o.valid=!0),e.maxWarning=o.maxWarning||function(t){return"不得超过"+t+"个字符"},e.minWarning=o.minWarning||function(t){return"不得小于"+t+"个字符"},e.removeTips=function(t){function n(){for(a=0;a<o.length;a++)o[a].parentNode.removeChild(o[a]),o.length&&n()}var i=e.root,o=i.getElementsByClassName("tip-container");o&&o.length&&n();for(var a=0;a<t.length;a++)utils.removeClass(t[a],e.passClass),utils.removeClass(t[a],e.failedClass)},e.insertTip=function(t,e,n){var i=t.nextElementSibling;i&&i.className.match(/tip-container/)&&t.parentNode.removeChild(i);var o=document.createElement("span");o.className=n,o.innerHTML=e,utils.insertAfter(o,t)},e.onValidRefuse=o.onValidRefuse||function(t,n){e.insertTip(t,n,"tip-container"),utils.removeClass(t,e.passClass),utils.addClass(t,e.failedClass)},e.onValidPass=o.onValidPass||function(t,n){e.insertTip(t,n,"tip-container success"),utils.removeClass(t,e.failedClass),utils.addClass(t,e.passClass)},e.ajaxSubmit=function(t,n){for(var i="",a=0;a<t.length;a++)if(t[a].name&&("SELECT"===t[a].tagName?(value=t[a].options[t[a].selectedIndex].value,i+=t[a].name+"="+encodeURIComponent(value)+"&"):"checkbox"===t[a].type||"radio"===t[a].type?t[a].checked&&(value=t[a].value,i+=t[a].name+"="+encodeURIComponent(value)+"&"):(value=t[a].value,i+=t[a].name+"="+encodeURIComponent(value)+"&")),"submit"===t[a].type&&"BUTTON"!==t[a].tagName){var r=t[a],s=r.value||r.innerText;r.disabled="disabled",r.value=e.submitingText}var l=new XMLHttpRequest;l.open("POST",n,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send(i),l.onreadystatechange=function(){if(4===l.readyState){if(200===l.status)try{var n=JSON.parse(l.responseText);o.callback(n)}catch(a){console.log(a)}else o.errCallback(i);e.removeTips(t),r.value=s,r.disabled=!1}}},this.submit=function(t){var n=[],i=e.root.getElementsByTagName("form")[0].elements,a=e.root.getAttribute("action");if(o.valid)for(var r=0;r<i.length;r++){var s=i[r].getAttribute("valid"),l=i[r].getAttribute("max"),u=i[r].getAttribute("min"),c=i[r].value,p=i[r].name,d=i[r];if(p&&s){if("email"===s)c.match(/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/)?e.onValidPass(d,e.successTips):(n.push(p),e.onValidRefuse(d,e.emailWarning));else if("mobile"===s)c.match(/^1[3|4|5|8][0-9]\d{4,8}$/)?e.onValidPass(d,e.successTips):(n.push(p),e.onValidRefuse(d,e.mobileWarning));else if("url"===s)c.match(/((http|ftp|https|file):\/\/([\w\-]+\.)+[\w\-]+(\/[\w\u4e00-\u9fa5\-\.\/?\@\%\!\&=\+\~\:\#\;\,]*)?)/)?e.onValidPass(d,e.successTips):(n.push(p),e.onValidRefuse(d,e.urlWarning));else if("present"===s)c=c.replace(" ",""),c.length?e.onValidPass(d,e.successTips):(n.push(p),e.onValidRefuse(d,e.presentWarning));else if(s.match(/^\/\S+\/$/)){s=s.replace(/^\//,""),s=s.replace(/\/$/,"");var f=new RegExp(s);f.test(c)?e.onValidPass(d,e.successTips):(n.push(p),e.onValidRefuse(d,e.regWarning))}}else if(p&&l){var l=parseInt(l,10);c.length>l?(n.push(p),e.onValidRefuse(d,e.maxWarning(l))):e.onValidPass(d,e.successTips)}else if(p&&u){var u=parseInt(u,10);c.length<u?(n.push(p),e.onValidRefuse(d,e.minWarning(u))):e.onValidPass(d,e.successTips)}}return n.length?!1:(t.preventDefault(),o.normalSubmit?(e.root.firstChild.setAttribute("action",e.root.getAttribute("action")),!0):void e.ajaxSubmit(i,a))}.bind(this)}),riot.tag("tab",'<ul> <li each="{ data }" onclick="{ parent.toggle }" class="{ active: parent.currentIndex==index }">{ title }</li> </ul> <div class="tab-content"> { content } </div>',function(t){var e=this,n=e.opts.opts||e.opts;if(e.data=n.data,e.data.length>0)for(e.currentIndex=0,e.content=e.data[0].content,i=0;i<e.data.length;i++)e.data[i].index=i;this.toggle=function(t){e.content=t.item.content,e.currentIndex=t.item.index,e.update()}.bind(this)}),riot.tag("table-view",'<yield> <table class="{ config.class }"> <tr show="{ showHeader }"> <th each="{ cols }" riot-style="{ style }" hide="{ hide }">{ alias || name }</th> </tr> <tr each="{ row in rows }" > <td each="{ colkey, colval in parent.cols }" class="{ newline: parent.parent.config.newline, cut: parent.parent.config.cut }" title="{ parent.row[colkey.name] }" hide="{ colkey.hide }"> { parent.parent.drawcell(parent.row, this, colkey) } </td> </tr> </table>',function(t){var e=this,n=e.root;e.config=e.opts.opts||e.opts,e.showHeader=e.config.showHeader===!1?!1:!0,e.cols=[],e.rows=[],e.on("mount",function(){if(e.rows=e.config.data,n.children.length>1)for(i=0;i<n.children.length;i++){var t=n.children[i];if("rcol"===t.localName){var o="";void 0!=t.attributes.width&&(o="width: "+t.attributes.width.value);var a={inner:t.innerHTML,style:o,index:i,attrs:t.attributes,hide:!1};a.name=t.attributes.name?t.attributes.name.value:"",t.attributes.alias&&(a.alias=t.attributes.alias.value||""),e.cols.push(a)}}else for(i in e.rows[0]){var a={name:i,inner:"",style:o};e.cols.push(a)}e.update()}),e.compare=function(t,n){return t[e.orderkeyName]>n[e.orderkeyName]?1:t[e.orderkeyName]===n[e.orderkeyName]?0:-1},e.clearOrder=function(){e.ordered=!1,e.reversed=!1},n.loadData=function(t){e.clearOrder(),e.rows=t,e.update()},n.appendData=function(t){e.clearOrder(),e.rows.push(t),e.update()},n.clearData=function(t){e.clearOrder(),e.rows=[],e.update()},n.orderData=function(t){e.orderkeyName=t,e.ordered!==t&&(e.rows=e.reversed!==t?e.rows.sort(e.compare):e.rows.reverse(),e.ordered=t,e.reversed=!1,e.update())},n.reverseData=function(t){e.orderkeyName=t,e.reversed!==t&&(e.ordered!==t&&(e.rows=e.rows.sort(e.compare)),e.rows=e.rows.reverse(),e.ordered=!1,e.reversed=t,e.update())},n.deleteData=function(t,o){e.clearOrder();var t=t||"id";for(i=0;i<e.rows.length;i++)e.rows[i][t]===o&&(e.rows.splice(i,1),n.deleteData(t,o));return e.update(),n},n.hide=function(t){for(i=0;i<e.cols.length;i++)if(e.cols[i].name===t){e.cols[i].hide=!0;break}e.update()},n.show=function(t){for(i=0;i<e.cols.length;i++)if(e.cols[i].name===t){e.cols[i].hide=!1;break}e.update()},this.drawcell=function(t,e,n){if(n.attrs.length)for(i in n.attrs)"function"!=typeof n.attrs[i]&&(n.attrs[i].name&&"class"!==n.attrs[i].name?e.root.setAttribute(n.attrs[i].name,n.attrs[i].value):n.attrs[i].name&&"class"==n.attrs[i].name&&(e.root.className+=" "+n.attrs[i].value));return n.inner?void setTimeout(function(){var i=n.inner.replace(/&lt;%=[\s|\w]+%&gt;|<%=[\s|\w]+%>/g,function(e){var n=e.replace(/&lt;%=/g,"").replace(/\s/g,"").replace(/%&gt;/g,"").replace(/%>/g,"").replace(/<%=/g,"");return t[n]});e.root.innerHTML=i},10):t[n.name]}.bind(this)}),riot.tag("tree",'<div class="tree-item-wrap" each="{ data }"> <i class="{ tree-item-arrow: true, open: opened, empty: !children }" onclick="{ parent.toggle }"></i> <i class="tree-item-icon"></i> <div onclick="{ parent.leftClick }" class="{ tree-item-name : true }" title="{ name }">{ name }</div>  <ul class="tree-child-wrap" if="{ children }"> <tree data="{ children }" if="{ children }"></tree> </ul> </div>',function(t){var e=this;e.config=e.opts.opts||e.opts,e.dataHandle=function(t,n,i){var t=t||[],o=n||"id",a=i||"pid",r={};t.forEach(function(t){e.config.name&&(t.name=t[e.config.name]),r[t[o]]=t});var s=[];return t.forEach(function(t){var e=r[t[a]];e?(e.children||(e.children=[]),e.children.push(t)):s.push(t)}),s},e.data=e.config.handleData?e.dataHandle(e.config.data):e.config.data,e.rootConfig=e.config.root?e.config:e.parent.rootConfig||e.parent.parent.rootConfig,this.leftClick=function(t){var n=e.rootConfig.onLeftClick;n&&n(t.item,t.target)}.bind(this),this.toggle=function(t){t.item.opened=t.item.opened===!0?!1:!0}.bind(this)});