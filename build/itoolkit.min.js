/**
 * iToolkit v1.0.0
 * Revised in 2016-03-07 20:23:43
 * Released under the ISC License.
 */

!function(e,t){"use strict";function n(e){var t=Y(0),n=e.trim().slice(t.length).match(/^\s*(\S+?)\s*(?:,\s*(\S+))?\s+in\s+(.+)$/);return n?{key:n[1],pos:n[2],val:t+n[3]}:{val:e}}function i(e,t,n){var i={};return i[e.key]=t,e.pos&&(i[e.pos]=n),i}function r(e,t,r){f(e,"each");var a,o=v(e),l=e.outerHTML,u=!!G[o],c=G[o]||{tmpl:l},d=e.parentNode,p=document.createComment("riot placeholder"),g=[],h=m(e);d.insertBefore(p,e),r=n(r),t.one("premount",function(){d.stub&&(d=t.root),e.parentNode.removeChild(e)}).on("update",function(){var n=q(r.val,t);U(n)||(a=n?JSON.stringify(n):"",n=n?Object.keys(n).map(function(e){return i(r,e,n[e])}):[]);for(var l=document.createDocumentFragment(),f=g.length,m=n.length;f>m;)g[--f].unmount(),g.splice(f,1);for(f=0;m>f;++f){var v=!a&&r.key?i(r,n[f],f):n[f];g[f]?g[f].update(v):(g[f]=new s(c,{parent:t,isLoop:!0,hasImpl:u,root:W.test(o)?d:e.cloneNode(),item:v},e.innerHTML),g[f]._item=v,g[f].mount(),l.appendChild(g[f].root)),g[f]._item=v}d.insertBefore(l,p),h&&(t.tags[o]=g)}).one("updated",function(){var e=Object.keys(t);k(d,function(n){1!=n.nodeType||n.isLoop||n._looped||(n._visited=!1,n._looped=!0,L(n,t,e))})})}function a(e,t,n){k(e,function(e){if(1==e.nodeType){e.isLoop=e.isLoop||e.parentNode&&e.parentNode.isLoop||e.getAttribute("each")?1:0;var i=m(e);i&&!e.isLoop&&n.push(g(i,e,t)),e.isLoop||L(e,t,[])}})}function o(e,t,n){function i(e,t,i){if(t.indexOf(Y(0))>=0){var r={dom:e,expr:t};n.push(y(r,i))}}k(e,function(e){var n=e.nodeType;if(3==n&&"STYLE"!=e.parentNode.tagName&&i(e,e.nodeValue),1==n){var a=e.getAttribute("each");return a?(r(e,t,a),!1):(d(e.attributes,function(t){var n=t.name,r=n.split("__")[1];return i(e,t.value,{attr:r||n,bool:r}),r?(f(e,n),!1):void 0}),m(e)?!1:void 0)}})}function s(e,n,i){function r(){var e=T&&k?f:v||f;d(D.attributes,function(t){m[t.name]=q(t.value,e)}),d(Object.keys(j),function(t){m[t]=q(j[t],e)})}function s(e){for(var t in N)typeof f[t]!==H&&(f[t]=e[t])}function l(){f.parent&&k&&d(Object.keys(f.parent),function(e){var t=!~$.indexOf(e)&&~P.indexOf(e);(typeof f[e]===H||t)&&(t||P.push(e),f[e]=f.parent[e])})}function u(e){if(d(L,function(t){t[e?"mount":"unmount"]()}),v){var t=e?"on":"off";k?v[t]("unmount",f.unmount):v[t]("update",f.update)[t]("unmount",f.unmount)}}var f=O.observable(this),m=E(n.opts)||{},g=K(e.tmpl),v=n.parent,k=n.isLoop,T=n.hasImpl,N=b(n.item),S=[],L=[],D=n.root,A=e.fn,I=D.tagName.toLowerCase(),j={},P=[];A&&D._tag&&D._tag.unmount(!0),this.isMounted=!1,D.isLoop=k,D._tag=this,this._id=M++,y(this,{parent:v,root:D,opts:m,tags:{}},N),d(D.attributes,function(e){var t=e.value;Y(/{.*}/).test(t)&&(j[e.name]=t)}),g.innerHTML&&!/^(select|optgroup|table|tbody|tr|col(?:group)?)$/.test(I)&&(g.innerHTML=x(g.innerHTML,i)),this.update=function(e){e=b(e),l(),e&&typeof N===B&&(s(e),N=e),y(f,e),r(),f.trigger("update",e),c(S,f),f.trigger("updated")},this.mixin=function(){d(arguments,function(e){e=typeof e===_?O.mixin(e):e,d(Object.keys(e),function(t){"init"!=t&&(f[t]=p(e[t])?e[t].bind(f):e[t])}),e.init&&e.init.bind(f)()})},this.mount=function(){if(r(),A&&A.call(f,m),o(g,f,S),u(!0),(e.attrs||T)&&(C(e.attrs,function(e,t){D.setAttribute(e,t)}),o(f.root,f,S)),(!f.parent||k)&&f.update(N),f.trigger("premount"),k&&!T)f.root=D=g.firstChild;else{for(;g.firstChild;)D.appendChild(g.firstChild);D.stub&&(f.root=D=v.root)}!f.parent||f.parent.isMounted?(f.isMounted=!0,f.trigger("mount")):f.parent.one("mount",function(){w(f.root)||(f.parent.isMounted=f.isMounted=!0,f.trigger("mount"))})},this.unmount=function(e){var n,i=D,r=i.parentNode;if(r){if(v)n=h(v),U(n.tags[I])?d(n.tags[I],function(e,t){e._id==f._id&&n.tags[I].splice(t,1)}):n.tags[I]=t;else for(;i.firstChild;)i.removeChild(i.firstChild);e?r.removeAttribute("riot-tag"):r.removeChild(i)}f.trigger("unmount"),u(),f.off("*"),D._tag=null},a(g,this,L)}function l(t,n,i,r){i[t]=function(t){var a,o=r._item,s=r.parent;if(!o)for(;s&&!o;)o=s._item,s=s.parent;t=t||e.event;try{t.currentTarget=i,t.target||(t.target=t.srcElement),t.which||(t.which=t.charCode||t.keyCode)}catch(l){}t.item=o,n.call(r,t)===!0||/radio|check/.test(i.type)||(t.preventDefault&&t.preventDefault(),t.returnValue=!1),t.preventUpdate||(a=o?h(s):r,a.update())}}function u(e,t,n){e&&(e.insertBefore(n,t),e.removeChild(t))}function c(e,t){d(e,function(e){var n=e.dom,i=e.attr,r=q(e.expr,t),a=e.dom.parentNode;if(e.bool?r=r?i:!1:null==r&&(r=""),a&&"TEXTAREA"==a.tagName&&(r=(""+r).replace(/riot-/g,"")),e.value!==r){if(e.value=r,!i)return void(n.nodeValue=""+r);if(f(n,i),p(r))l(i,r,n,t);else if("if"==i){var o=e.stub,s=function(){u(o.parentNode,o,n)},c=function(){u(n.parentNode,n,o)};r?o&&(s(),n.inStub=!1,w(n)||k(n,function(e){e._tag&&!e._tag.isMounted&&(e._tag.isMounted=!!e._tag.trigger("mount"))})):(o=e.stub=o||document.createTextNode(""),n.parentNode?c():(t.parent||t).one("updated",c),n.inStub=!0)}else if(/^(show|hide)$/.test(i))"hide"==i&&(r=!r),n.style.display=r?"":"none";else if("value"==i)n.value=r;else if(D(i,j)&&i!=P)r&&n.setAttribute(i.slice(j.length),r);else{if(e.bool&&(n[i]=r,!r))return;typeof r!==B&&n.setAttribute(i,r)}}})}function d(e,t){for(var n,i=0,r=(e||[]).length;r>i;i++)n=e[i],null!=n&&t(n,i)===!1&&i--;return e}function p(e){return typeof e===F||!1}function f(e,t){e.removeAttribute(t)}function m(e){return e.tagName&&G[e.getAttribute(P)||e.tagName.toLowerCase()]}function g(e,t,n){var i,r=new s(e,{root:t,parent:n},t.innerHTML),a=v(t),o=h(n);return r.parent=o,i=o.tags[a],i?(U(i)||(o.tags[a]=[i]),~o.tags[a].indexOf(r)||o.tags[a].push(r)):o.tags[a]=r,t.innerHTML="",r}function h(e){for(var t=e;!m(t.root)&&t.parent;)t=t.parent;return t}function v(e){var t=m(e),n=e.getAttribute("name"),i=n&&n.indexOf(Y(0))<0?n:t?t.name:e.tagName.toLowerCase();return i}function y(e){for(var t,n=arguments,i=1;i<n.length;++i)if(t=n[i])for(var r in t)e[r]=t[r];return e}function b(e){if(!(e instanceof s||e&&typeof e.trigger==F))return e;var t={};for(var n in e)~$.indexOf(n)||(t[n]=e[n]);return t}function k(e,t){if(e){if(t(e)===!1)return;for(e=e.firstChild;e;)k(e,t),e=e.nextSibling}}function C(e,t){for(var n,i=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;n=i.exec(e);)t(n[1].toLowerCase(),n[2]||n[3]||n[4])}function w(e){for(;e;){if(e.inStub)return!0;e=e.parentNode}return!1}function T(e){return document.createElement(e)}function x(e,t){return e.replace(/<(yield)\/?>(<\/\1>)?/gi,t||"")}function N(e,t){return(t||document).querySelectorAll(e)}function S(e,t){return(t||document).querySelector(e)}function E(e){function t(){}return t.prototype=e,new t}function L(e,t,n){if(!e._visited){var i,r=e.getAttribute("id")||e.getAttribute("name");r&&(n.indexOf(r)<0&&(i=t[r],i?U(i)?i.push(e):t[r]=[i,e]:t[r]=e),e._visited=!0)}}function D(e,t){return e.slice(0,t.length)===t}function A(e){if(!O.render){V||(V=T("style"),V.setAttribute("type","text/css"));var t=document.head||document.getElementsByTagName("head")[0];if(V.styleSheet?V.styleSheet.cssText+=e:V.innerHTML+=e,!V._rendered)if(V.styleSheet)document.body.appendChild(V);else{var n=S("style[type=riot]");n?(n.parentNode.insertBefore(V,n),n.parentNode.removeChild(n)):t.appendChild(V)}V._rendered=!0}}function I(e,t,n){var i=G[t],r=e._innerHTML=e._innerHTML||e.innerHTML;return e.innerHTML="",i&&e&&(i=new s(i,{root:e,opts:n},r)),i&&i.mount?(i.mount(),z.push(i),i.on("unmount",function(){z.splice(z.indexOf(i),1)})):void 0}var O={version:"v2.2.4",settings:{}},M=0,j="riot-",P=j+"tag",_="string",B="object",H="undefined",F="function",W=/^(?:opt(ion|group)|tbody|col|t[rhd])$/,$=["_item","_id","update","root","mount","unmount","mixin","isMounted","isLoop","tags","parent","opts","trigger","on","off","one"],R=0|(e&&e.document||{}).documentMode,U=Array.isArray;O.observable=function(e){e=e||{};var t={},n=0;return e.on=function(i,r){return p(r)&&(typeof r.id===H&&(r._id=n++),i.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(r),r.typed=n>0})),e},e.off=function(n,i){return"*"==n?t={}:n.replace(/\S+/g,function(e){if(i)for(var n,r=t[e],a=0;n=r&&r[a];++a)n._id==i._id&&r.splice(a--,1);else t[e]=[]}),e},e.one=function(t,n){function i(){e.off(t,i),n.apply(e,arguments)}return e.on(t,i)},e.trigger=function(n){for(var i,r=[].slice.call(arguments,1),a=t[n]||[],o=0;i=a[o];++o)i.busy||(i.busy=1,i.apply(e,i.typed?[n].concat(r):r),a[o]!==i&&o--,i.busy=0);return t.all&&"all"!=n&&e.trigger.apply(e,["all",n].concat(r)),e},e},O.mixin=function(){var e={};return function(t,n){return n?void(e[t]=n):e[t]}}(),function(e,t,n){function i(){return s.href.split("#")[1]||""}function r(e){return e.split("/")}function a(e){e.type&&(e=i()),e!=o&&(l.trigger.apply(null,["H"].concat(r(e))),o=e)}if(n){var o,s=n.location,l=e.observable(),u=!1,c=e.route=function(e){e[0]?(s.hash=e,a(e)):l.on("H",e)};c.exec=function(e){e.apply(null,r(i()))},c.parser=function(e){r=e},c.stop=function(){u&&(n.removeEventListener?n.removeEventListener(t,a,!1):n.detachEvent("on"+t,a),l.off("*"),u=!1)},c.start=function(){u||(n.addEventListener?n.addEventListener(t,a,!1):n.attachEvent("on"+t,a),u=!0)},c.start()}}(O,"hashchange",e);var V,Y=function(e){var t,n,i,r=/[{}]/g;return function(a){var o=O.settings.brackets||e;return t!==o&&(t=o,i=o.split(" "),n=i.map(function(e){return e.replace(/(?=.)/g,"\\")})),a instanceof RegExp?o===e?a:new RegExp(a.source.replace(r,function(e){return n[~~("}"===e)]}),a.global?"g":""):i[a]}}("{ }"),q=function(){function t(e,t){return e.indexOf(Y(0))<0?(e=e.replace(/\n|\r\n?/g,"\n"),function(){return e}):(e=e.replace(Y(/\\{/g),"￰").replace(Y(/\\}/g),"￱"),t=r(e,a(e,Y(/{/),Y(/}/))),e=2!==t.length||t[0]?"["+t.map(function(e,t){return t%2?n(e,!0):'"'+e.replace(/\n|\r\n?/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")':n(t[1]),new Function("d","return "+e.replace(/\uFFF0/g,Y(0)).replace(/\uFFF1/g,Y(1))+";"))}function n(e,t){return e=e.replace(/\n|\r\n?/g," ").replace(Y(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),""),/^\s*[\w- "']+ *:/.test(e)?"["+a(e,/["' ]*[\w- ]+["' ]*:/,/,(?=["' ]*[\w- ]+["' ]*:)|}|$/).map(function(e){return e.replace(/^[ "']*(.+?)[ "']*: *(.+?),? *$/,function(e,t,n){return n.replace(/[^&|=!><]+/g,i)+'?"'+t+'":"",'})}).join("")+'].join(" ").trim()':i(e,t)}function i(e,t){return e=e.trim(),e?"(function(v){try{v="+e.replace(l,function(e,t,n){return n?'(("'+n+s+n+")":e})+"}catch(e){}return "+(t===!0?'!v&&v!==0?"":v':"v")+"}).call(d)":""}function r(e,t){var n=[];return t.map(function(t,i){i=e.indexOf(t),n.push(e.slice(0,i),t),e=e.slice(i+t.length)}),e&&n.push(e),n}function a(e,t,n){var i,r=0,a=[],o=new RegExp("("+t.source+")|("+n.source+")","g");return e.replace(o,function(t,n,o,s){!r&&n&&(i=s),r+=n?1:-1,r||null==o||a.push(e.slice(i,s+o.length))}),a}var o={},s='"in d?d:'+(e?"window).":"global)."),l=/(['"\/])(?:[^\\]*?|\\.|.)*?\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function\s*\()|([A-Za-z_$]\w*)/g;return function(e,n){return e&&(o[e]||(o[e]=t(e)))(n)}}(),K=function(e){function t(t){var a=t&&t.match(/^\s*<([-\w]+)/),o=a&&a[1].toLowerCase(),s=i[o]||r,l=T(s);return l.stub=!0,e&&o&&(a=o.match(W))?n(l,t,o,!!a[1]):l.innerHTML=t,l}function n(e,t,n,i){var a,o=T(r),s=i?"select>":"table>";o.innerHTML="<"+s+t+"</"+s,a=o.getElementsByTagName(n)[0],a&&e.appendChild(a)}var i={tr:"tbody",th:"tr",td:"tr",tbody:"table",col:"colgroup"},r="div";return e=e&&10>e,t}(R),z=[],G={};O.tag=function(e,t,n,i,r){return p(i)&&(r=i,/^[\w\-]+\s?=/.test(n)?(i=n,n=""):i=""),n&&(p(n)?r=n:A(n)),G[e]={name:e,tmpl:t,attrs:i,fn:r},e},O.mount=function(e,t,n){function i(e){var t="";return d(e,function(e){t+=", *["+P+'="'+e.trim()+'"]'}),t}function r(){var e=Object.keys(G);return e+i(e)}function a(e){var i;if(e.tagName){!t||(i=e.getAttribute(P))&&i==t||e.setAttribute(P,t);var r=I(e,t||e.getAttribute(P)||e.tagName.toLowerCase(),n);r&&l.push(r)}else e.length&&d(e,a)}var o,s,l=[];if(typeof t===B&&(n=t,t=0),typeof e===_?("*"===e?e=s=r():e+=i(e.split(",")),o=N(e)):o=e,"*"===t){if(t=s||r(),o.tagName)o=N(t,o);else{var u=[];d(o,function(e){u.push(N(t,e))}),o=u}t=0}return o.tagName?a(o):d(o,a),l},O.update=function(){return d(z,function(e){e.update()})},O.mountTo=O.mount,O.util={brackets:Y,tmpl:q},typeof exports===B?module.exports=O:"function"==typeof define&&define.amd?define(function(){return e.riot=O}):e.riot=O}("undefined"!=typeof window?window:void 0);var utils={httpGet:function(e,t,n,i){var r=new XMLHttpRequest,e=utils.concatParams(e,t);r.open("GET",e,!0),r.send(null),r.onreadystatechange=function(){if(4===r.readyState&&(i&&"function"==typeof i&&i(),200===r.status)){var e=r.responseText;try{if("string"==typeof e)var t=JSON.parse(e);else var t=e}catch(a){alert("解析错误")}n(t)}}},httpPost:function(e,t,n,i){var r=new XMLHttpRequest;r.open("POST",e,!0),r.setRequestHeader("Content-type","application/json"),r.send(t),r.onreadystatechange=function(){if(4===r.readyState)if(i&&"function"==typeof i&&i(),200===r.status){try{var e=JSON.parse(r.responseText)}catch(t){console.log("解析错误")}n(e)}else console.log("网络错误")}},jsonp:function(e,t,n){var i=Date.now(),r=document.createElement("script"),a=document.getElementsByTagName("head")[0],e=utils.concatParams(e,t);if(t.callback)var o=e,s=t.callback;else{if(e.match(/\?/))var o=e+"&callback=jsonpCallback"+i;else var o=e+"?callback=jsonpCallback"+i;var s="jsonpCallback"+i}r.src=o,a.appendChild(r),window[s]=function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}n(e)},r.onerror=function(){console.log("jsonp error")},r.onload=function(){a.removeChild(r)}},htmlEncode:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText},concatParams:function(e,t){if(e.match(/\?/))var n="&";else var n="?";for(i in t)n=n+i+"="+t[i]+"&";return n=n.replace(/&$/,""),e+n},setCookie:function(e,t,n,i){var r=new Date,i=i||"/";r.setTime(r.getTime()+n),document.cookie=e+"="+escape(t)+";path="+i+";expires="+r.toGMTString()},transBytes:function(e){var t=["B","KB","MB","GB","TB"];if(0==e)return"n/a";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return 0==n?e+t[n]:(e/Math.pow(1024,n)).toFixed(1)+t[n]},transTimes:function(e){var e=parseInt(e,10),t=new Date(1e3*e),n=(new Date).getTime()/1e3,i=n-e;if(86400>i)return t.getHours()+":"+t.getMinutes();if(i>86400&&172800>i)return"昨天";if(i>172800){var r=(t.getFullYear()+"-").substring(2),a=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",o=t.getDate()<10?"0"+t.getDate():t.getDate();return r+a+o}},hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){e.className.trim(),this.hasClass(e,t)||(e.className+=" "+t)},removeClass:function(e,t){if(utils.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},toggleClass:function(e,t){if(utils.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}else e.className+=" "+t},insertAfter:function(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)},insertAfterText:function(e,t){var n=t.parentNode;if(n.lastChild==t)n.appendChild(e);else{var i=t.nextSibling;3===i.nodeType&&(i=i.nextSibling),n.insertBefore(e,i)}},isType:function(e){return function(t){return toString.call(t)==="[object "+e+"]"}},makeArray:function(){return Array.prototype.concat(obj)},extend:function(e,t){for(var n in t)e[n]||(e[n]=t[n])},deepCopy:function(e,t){var n="[object Array]"===toString.call(e)?[]:{},t=t||n;for(var i in e)"[object Object]"===toString.call(e[i])?(t[i]={},this.deepCopy(e[i],t[i])):"[object Array]"===toString.call(e[i])?(t[i]=[],this.deepCopy(e[i],t[i])):t[i]=e[i];return t}};utils.extend(utils,{isArray:utils.isType("Array"),isObject:utils.isType("Object"),isFunction:utils.isType("Function"),isElement:function(e){return-1!==toString.call(e).indexOf("Element")}}),utils.extend(utils,{jsLoader:function(){function e(){return p++}function t(e){return e.match(/\.css\??/)}function n(t){this.uri=t,this.cid=e(),this.status=k}function i(e,t){return i.then(e,t).start(),i}function r(e){throw e}function a(e){if(e||f.length)for(var t=0;t<e.task.length;t++){var n=e.task[t];s(n,e)}}function o(e,t){var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e.uri,c.appendChild(i),i=null,e.status=v,n.resolve.call(t)}function s(e,i){function r(t){if("error"===t.type&&(e.status=b),"load"===t.type&&(e.status=v),n.resolve.call(i,e),e.changeStatus){e.changeStatus=!1;for(var r=0;r<C[e.cid].length;r++){var a=C[e.cid][r];n.resolve.call(a.resolver,a.js)}C[e.cid]=null}s.onload=s.onerror=null,c.removeChild(s),s=null}if(g(e.uri))try{e.uri(),e.status=v,n.resolve.call(i)}catch(a){e.status=b,n.resolve.call(i)}else{if(e.status===v)return void n.resolve.call(i);if(t(e.uri))return void o(e,i);if(e.status===y)return e.changeStatus=!0,C[e.cid]=C[e.cid]||[],void C[e.cid].push({js:e,resolver:i});e.status=y;var s=document.createElement("script");s.async=!0,s.src=e.uri,s.onload=s.onerror=r,c.appendChild(s)}}function l(e){var t=u(e);return n.get(t?t:e)}function u(e){return i.alias[e]}var c=document.head||document.getElementsByTagName("head")[0],d={},p=0,f=[],m=utils.isArray,g=utils.isFunction,h=utils.makeArray,v="done",y="inprocess",b="rejected",k="pending",C={};return n.get=function(e){return d[e]||(d[e]=new n(e))},n.resolve=function(e){var t=this;if(t.status++,e&&e.status===b){var n=Error("Source: "+e.uri+" load failed");r(n)}t.status===t.task.length&&setTimeout(function(){t.callback&&t.callback(),t=null,a(f.shift())},7)},i.then=function(e,t){if(!e)return i;m(e)||(e=h(e));for(var n={task:[],callback:t,status:0},r=0;r<e.length;r++)n.task.push(l(e[r]));return f.push(n),i},i.start=function(){return a(f.shift()),i},i.alias={},i}()});var EventCtrl=EC=riot.observable(),iToolkit=itk=riot;riot.tag("itk-calendar",'<div class="itk-calendar-wrapper"> <div class="itk-calendar-head">   <div class="itk-calendar-year" onclick="{ openYearList }">{ year.text } <span class="itk-calendar-select-icon"></span></div> <div class="itk-calendar-month"><span class="itk-calendar-month-left" onclick="{ prevMonth }"></span>{ month.text }<span class="itk-calendar-month-right" onclick="{ nextMonth }"></span></div>   </div> <div class="itk-calendar-body"> <div class="itk-calendar-weeks"> <div class="itk-calendar-week" each="{ text in weekArr }">{ text }</div> </div> <div class="itk-calendar-days"> <div each="{ dayArr }" class="itk-calendar-day { overflow: overflow, selected: parent.showSelected && parent.selectedYear === year && parent.selectedMonth === month && parent.selectedDay === day, today: parent.showToday && parent.toYear === year && parent.toMonth === month && parent.today === day, defuse: !year && !month }" data-year="{ year }" data-month="{ month }" data-day="{ day }" onclick="{ (year && month) ? dayClicked : \'return false;\' }" >{ day }</div> </div> </div> <div class="itk-calendar-years" show="{ openList }"> <div class="itk-calendar-year-item { selected: parent.year.text === i }" each="{ i in yearList }" onclick="{ clickYear }">{ i }</div> </div> </div>','hide="{ !open }"',function(){var e=this;e.i18n={zh_cn:{weekArr:["一","二","三","四","五","六","日"],monthArr:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},en_us:{weekArr:["Mo","Tu","We","Th","Fr","Sa","Su"],monthArr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}};var t=(e.root,["itk-calendar-label","itk-calendar-input","itk-calendar-calendarIcon"]);e.mapping=function(t){if(!utils.isObject(t))throw new TypeError("Config is not a object!");for(var n in t)e[n]=t[n]},window.itkCalendarLanguage=window.itkCalendarLanguage||{},e.langMixin=function(e){if(e){for(var t in e)window.itkCalendarLanguage[t]||(window.itkCalendarLanguage[t]=e[t]);delete e}},e.initWeekList=function(t){var n=e.i18n[t]||window.itkCalendarLanguage[t];if(n)e.weekArr=n.weekArr,e.monthArr=n.monthArr;else if(!e.weekArr||!e.monthArr){var n=e.i18n.zh_cn;e.weekArr=n.weekArr,e.monthArr=n.monthArr}},e.getDaysCount=function(e,t){var n=0;switch(t){case 1:case 3:case 5:case 7:case 8:case 10:case 12:case 0:case 13:n=31;break;case 4:case 6:case 9:case 11:n=30;break;case 2:n=e%4===0&&e%100!==0||e%400===0?29:28;break;default:throw new Error("你算错了")}return n},e.drawDays=function(t){var n;n=t?new Date(t):new Date;var i=n.getMonth(),r=n.getFullYear();e.month={text:e.monthArr[i],val:i+1},e.year={text:r,val:r},i+=1;{var a=e.getDaysCount(r,i),o=e.getDaysCount(r,i-1);e.getDaysCount(r,i+1)}n.setDate(1);var s=n.getDay();n.setDate(a);for(var l=n.getDay(),u=[],c=0,d=s?s-1:6;d>c;c++)u.push({year:"",month:"",day:o-c});u.reverse();for(var c=0,d=a;d>c;c++)u.push({year:r,month:i,day:c+1});for(var c=0,d=l?7-l:0;d>c;c++)u.push({year:"",month:"",day:c+1});switch(u.length/7){case 4:for(var c=0;7>c;c++)u.push({year:"",month:"",day:c+1});e.overflow=!1;break;case 6:e.overflow=!0;break;default:e.overflow=!1}return u},e.initDays=function(t){var n=new Date;e.today=n.getDate(),e.toMonth=n.getMonth()+1,e.toYear=n.getFullYear(),e.defaultSelected&&(e.selectedDay=e.today,e.selectedMonth=e.toMonth,e.selectedYear=e.toYear);for(var i=e.toYear-10,r=e.toYear+11;r>i;i++)e.yearList.push(i);e.dayArr=e.drawDays(t),e.update()},e.getNum=function(e){return e>10?e:"0"+e},e.formatter=function(t){var n,i=new Date(e.selectedYear,e.selectedMonth-1,e.selectedDay,0,0,0),r=i.getTime();switch(t){case"unixTimeStamp":n=e.getUnixTimeStamp(r);break;case"timeStamp":n=e.getTimeStamp(r);break;default:if(!t)var t="yyyy/mm/dd";n=t.replace(/(yyyy|mm|dd|yy|m|d)/gi,function(t){return"yyyy"===t?e.selectedYear:"mm"===t?e.getNum(e.selectedMonth):"dd"===t?e.getNum(e.selectedDay):"yy"===t?e.selectedYear.toString().substr(2,4):"m"===t?e.selectedMonth:"d"===t?e.selectedDay:void 0})}return n},e.dayClicked=function(t){e.selectedDay=t.item.day,e.selectedMonth=t.item.month,e.selectedYear=t.item.year,e.onSelect&&e.onSelect(e.formatter,e.getYear(),e.getMonth(),e.getDay()),e.update()},e.open=!1,e.getAbsPoint=function(e){var t=e.offsetLeft,n=e.offsetTop;for(document.documentElement.offsetHeight,document.documentElement.offsetWidth;e=e.offsetParent;)t+=e.offsetLeft,n+=e.offsetTop;return{x:t,y:n}},e.location=function(){if(e.element){var t=e.getAbsPoint(e.element);e.root.style.position="absolute",e.root.style.top=t.y+e.element.offsetHeight+"px",e.root.style.left=t.x+"px"}},e.closeIt=function(n){var i=n.target.className;n.target===e.element||t.indexOf(i)>-1||i.indexOf("itk-calendar")>-1&&-1===i.indexOf("itk-calendar-day")||(e.open=!1,e.openList=!1,e.update())},e.openIt=function(t){e.open=!0,e.update(),e.location(t)},e.unbindEvent=function(){e.element&&(document.removeEventListener("click",e.closeIt,!1),e.element.removeEventListener("click",e.openIt,!1))},e.on("mount",function(){var n=e.opts.opts||e.opts||{};if(e.yearList=[],e.mapping(n),e.langMixin(e.customLang),e.initWeekList(e.language),e.initDays(e.initTime),e.element){if(!utils.hasClass(e.element,"itk-calendar-input")&&null!==e.element.getAttribute("calendar")){var i=e.element.parentNode,r=document.createElement("label");r.className=t[0],i.insertBefore(r,e.element),utils.addClass(e.element,t[1]),r.appendChild(e.element);var a=document.createElement("span");a.className=t[2],r.appendChild(a),e.element=r}document.addEventListener("click",e.closeIt,!1),e.element.addEventListener("click",e.openIt,!1)}else e.open=!0;e.update()}),e.on("unmount",function(){e.unbindEvent()}),e.getTimeStamp=function(e){return e},e.getUnixTimeStamp=function(e){return Math.ceil(e/1e3).toString()},e.getYear=function(){return e.selectedYear},e.getMonth=function(){return e.selectedMonth},e.isBoundary=function(t,n,i){var r=e.yearList[0],a=e.yearList[e.yearList.length-1];return r>t||t>a||t===r&&0===n&&-1===i||t===a&&13===n&&1===i?!1:[t,n]},e.getDay=function(){return e.selectedDay},e.reset=function(t){e.dayArr=e.drawDays(new Date(t[0],t[1],1).getTime()),e.update()},e.nextMonth=function(){var t=e.year.val,n=e.month.val-1;t=11===n?t+1:t,n=11===n?0:n+1;var i=e.isBoundary(t,n,1);i&&e.reset(i)},e.prevMonth=function(){var t=e.month.val-1,n=e.year.val;n=0===t?n-1:n,t=0===t?11:t-1;var i=e.isBoundary(n,t,-1);i&&e.reset(i)},e.openYearList=function(){e.openList=!e.openList},e.clickYear=function(t){e.openList=!1,e.reset([t.item.i,e.month.val-1])}}),riot.tag("itk-center",'<div class="itk-loading {default: default}" > <yield> </div>',function(){{var e=this;e.opts.opts||e.opts}e.default=!1,e.on("mount",function(){var t=e.root.parentNode,n=window.getComputedStyle(t,null).position;"static"===n&&(t.style.position="relative"),e.childDom=e.root.getElementsByClassName("itk-loading")[0],e.childDom.innerHTML.trim()&&(e.default=!1,e.update());var i=parseInt(window.getComputedStyle(e.childDom,null).height.replace("px",""),10);e.root.style.marginTop="-"+i/2+"px"}),e.root.show=function(){e.childDom&&(e.childDom.style.display="block")},e.root.hide=function(){e.childDom&&(e.childDom.style.display="none")}}),riot.tag("date-picker","<yield>",function(){var e=this,t=e.root,n=e.opts.opts||e.opts,i=document.scripts,r="",a="";if(n.path)r=n.path;else{for(var o=0;o<i.length;o++)if(i[o].src&&/itoolkit.min.js|itoolkit.js/.test(i[o].src)){a=i[o].src.replace(/itoolkit.min.js|itoolkit.js/,"");break}r=a+"plugins/laydate/"}var s=n.theme?n.theme:"default";utils.jsLoader([r+"laydate.min.js",r+"/need/laydate.css",r+"/skins/"+s+"/laydate.css"],function(){for(var n=0;n<t.children.length;n++){var i=t.children[n];i.attributes.pTrigger&&(e.pTrigger=i),i.attributes.media&&(e.media=i)}e.resolve(),e.update()}),this.resolve=function(){if(!e.pTrigger&&!e.media)throw"media and pTrigger property was not found in the element";return e.pTrigger===e.media&&(n.elem=n.pTrigger=e.media),"undefined"==typeof e.pTrigger&&(n.elem=e.media),e.pTrigger&&e.media&&e.pTrigger!==e.media&&(n.pTrigger=e.pTrigger,n.elem=e.media),e.pTrigger&&!e.media&&(n.elem=e.pTrigger,n.justChoose=!0),n.pTrigger?void(n.pTrigger.onclick=function(){laydate(n)}):void laydate(n)}.bind(this)}),riot.tag("itk-div","<yield>",function(){var e=this,t=e.opts.opts||e.opts,n=e.root;for(i in t)e[i]=t[i];e.getData=function(t){var t=t||{};if(n.getAttribute("data-get"))var r="httpGet";else if(n.getAttribute("data-jsonp"))var r="jsonp";utils[r](e.superDivUrl,t,function(t){for(i in t)e.data={},e.data[i]=t[i];e.update()})},e.on("mount",function(){n.style.display="block",e.superDivUrl=n.getAttribute("data-get")||n.getAttribute("data-jsonp"),e.superDivUrl&&e.getData(t.params)}),e.loadData=n.loadData=function(t,n){n=n||"data",e[n]=t,e.update()},e.reload=n.reload=function(){e.superDivUrl?e.getData(t.params):e.update()}}),riot.tag("itk-editor",'<textarea rows="10" cols="80" style="display:none;"></textarea>',function(){var e,t=this,n=t.root,i=t.opts.opts||t.opts,r=document.scripts,a="",o="",s=i.type||"standard",l=i.filebrowserImageUploadUrl;i.initContent&&(e=i.initContent);var u;i.initEditor&&(u=i.initEditor);var c={};if(c.image_previewText="",c.filebrowserImageUploadUrl=l,i.editorConfig){var d=i.editorConfig;for(x in d)"image_previewText"!=x&&"filebrowserImageUploadUrl"!=x&&"initContent"!=x&&"initEditor"!=x&&(c[x]=d[x])}if(i.path)a=i.path;else{for(var p=0;p<r.length;p++)if(r[p].src&&/itoolkit.min.js|itoolkit.js/.test(r[p].src)){o=r[p].src.replace(/itoolkit.min.js|itoolkit.js/,"");break}a=o+"plugins/ckeditor/"}t.on("mount",function(){n.style.visibility="hidden";var i=n.getElementsByTagName("textarea")[0],r=n.getAttribute("id");i.setAttribute("id",n.getAttribute("id")),n.removeAttribute("id"),utils.jsLoader([a+s+"/ckeditor.js"],function(){var i=CKEDITOR.replace(r,c);console.log(c),n.style.visibility="visible",t.update(),e&&i.setData(e),u&&u(i)})})}),riot.tag("itk-form",'<form onsubmit="{ submit }" > <yield> </form>',function(){function e(){o([],this)}function t(e){return Object.prototype.toString.call(e).match(/\ (.*)\]/)[1]}function n(e){var n=t(e);return"Null"===n||"Undefined"===n||"Function"===n?e:new window[n](e)}function r(e){for(var e=e,t=e.attributes,n={},i=0;i<t.length;i++){var r=t[i];n[r.name]=r.value}return n.value=e.value,n}function a(e){for(var t=0;t<d.length;t++)if(e[d[t]])return!0;return!1}function o(e,t){var n=t,i=r(t);if(a(i)){var o=new s.Validation(e,i.name,n);if(i.name){if((i.allowEmpty||i.allowempty)&&""===i.value)return void s.onValidPass(n,s.successTips);s.validEmpty(o,i),i.valid?s.rules[i.valid]?s.valid(i.valid,o,i):p[i.valid.toUpperCase()]&&s.validNumRange(o,i):i.valid||(i.min||i.max)&&s.comparator("string").handler(o,i)}e.length||s.validUnion(o,e,n,i),o.validTip()}}var s=this,l=s.root,u=s.opts.opts||s.opts,c=["insertTip","ajaxSubmit","submit","removeTips","insertTip","removeTip","loadData","getData","setData"],d=["allowEmpty","allowempty","max","min","valid","vr"],p={NON_NEGATIVE_INT:/^0$|^-[1-9]\d*$/,POSITIVE_INT:/^[1-9]\d*$/,NON_POSITIVE_INT:/^[1-9]\d*$|^0$/,NEGATIVE_INT:/^-[1-9]\d*$/,INT:/^-?[1-9]\d*$|^0$/,NON_NEGATIVE_FLOAT:/^(\d)(\.\d+)?$|^([1-9]\d*)(\.\d+)?$|^0$/,POSITIVE_FLOAT:/^(\d)(\.\d+)?$|^([1-9]\d*)(\.\d+)?$/,NON_POSITIVE_FLOAT:/^(-\d)(\.\d+)?$|^(-[1-9]\d*)(\.\d+)?$|^0$/,NEGATIVE_FLOAT:/^(-\d)(\.\d+)?$|^(-[1-9]\d*)(\.\d+)?$/,FLOAT:/^(-?\d)(\.\d+)?$|^(-?[1-9]\d*)(\.\d+)?$|^0$/};s.presentWarning="必填",s.emailWarning="邮箱格式错误",s.mobileWarning="手机格式错误",s.urlWarning="网址格式错误",s.successTips=u.successTipsText||"通过",s.regexpWarning="字段不符合验证规则",s.numWarning="数字格式错误",s.passClass=u.passClass||"valid-pass",s.failedClass=u.failedClass||"valid-failed",s.comparator=function(e){return{handler:function(t,n){switch(e){case"number":return s.numComparator(t,n);case"string":default:return s.strCompatator(t,n)}}}},s.strCompatator=function(e,t){var n=parseInt(t.min,10),i=parseInt(t.max,10),r=isNaN(n),a=isNaN(i),o=t.value.length;return r||a?(!r&&n>o&&e.msg.push(s.minWarning(n)),!a&&o>i&&e.msg.push(s.maxWarning(i))):(o>i||n>o)&&e.msg.push(s.bpWarning(n,i)),e},s.numComparator=function(e,t){var n=parseInt(t.min,10),i=parseInt(t.max,10),r=isNaN(n),a=isNaN(i),o=+t.value;return r||a?(!r&&n>o&&e.msg.push(s.minNumWarning(n)),!a&&o>i&&e.msg.push(s.maxNumWarning(i))):(o>i||n>o)&&e.msg.push(s.numBpWarning(n,i)),e},s.one("mount",function(){if(l.style.display="block",u.realTime&&u.valid)for(var t=s.root.getElementsByTagName("form")[0].elements,n=0,i=t.length;i>n;n++){var r=t[n].type;("submit"!==r||"button"!==r)&&(t[n].addEventListener("input",e,!1),t[n].addEventListener("change",e,!1))}}),l.loadData=function(e,t){if(utils.isObject(e))for(var i in e)e[i]=n(e[i]);else e=n(e);t=t||"data",s[t]=e,s.update()},l.setData=function(e,t){s.data[t]=n(e),s.update()},s.checkExistKey=function(e,t,n){if(e.hasOwnProperty(t))if(utils.isArray(e[t]))e[t].push(n);else{var i=[];i.push(e[t]),i.push(n),e[t]=i}else e[t]=n},s.getData=l.getData=function(){for(var e=s.root.getElementsByTagName("form")[0].elements,t={},n=0;n<e.length;n++)if(e[n].name){var i;if("SELECT"===e[n].tagName)for(var r=e[n].options,a=0;a<r.length;a++)r[a].selected&&(i=r[a].value,s.checkExistKey(t,e[n].name,encodeURIComponent(i)));else"checkbox"===e[n].type||"radio"===e[n].type?e[n].checked&&(i=e[n].value,s.checkExistKey(t,e[n].name,encodeURIComponent(i))):(i=e[n].value,s.checkExistKey(t,e[n].name,encodeURIComponent(i)))}return t},s.submitingText=u.submitingText||"提交中...",void 0===u.valid&&(u.valid=!0),s.maxWarning=u.maxWarning||function(e){return"不得超过"+e+"个字符"},s.minWarning=u.minWarning||function(e){return"不得小于"+e+"个字符"},s.bpWarning=u.bpWarning||function(e,t){return"只允许"+e+"-"+t+"个字符"},s.minNumWarning=u.minNumWarning||function(e){return"不得小于"+e},s.maxNumWarning=u.maxNumWarning||function(e){return"不得大于"+e},s.numBpWarning=u.numBpWarning||function(e,t){return"输入数字应在"+e+"-"+t+"之间"},s.removeTips=l.removeTips=function(){function e(){for(r=0;r<i.length;r++)i[r].parentNode.removeChild(i[r]),i.length&&e()}var t=s.root,n=t.getElementsByTagName("form")[0].elements,i=t.getElementsByClassName("tip-container");i&&i.length&&e();for(var r=0;r<n.length;r++)utils.removeClass(n[r],s.passClass),utils.removeClass(n[r],s.failedClass)},s.removeTipNode=function(e){var t=e.nextElementSibling;t&&t.className.match(/tip-container/)&&e.parentNode.removeChild(t)},s.removeTip=l.removeTip=function(e){s.removeTipNode(e),utils.removeClass(e,s.passClass),utils.removeClass(e,s.failedClass)},s.insertTip=l.insertTip=function(e,t,n){s.removeTipNode(e);var i=document.createElement("span");
i.className=n,i.innerHTML=t,utils.insertAfterText(i,e)},s.onValidRefuse=l.onValidRefuse=u.onValidRefuse||function(e,t){s.insertTip(e,t,"tip-container"),utils.removeClass(e,s.passClass),utils.addClass(e,s.failedClass)},s.onValidPass=l.onValidPass=u.onValidPass||function(e,t){s.insertTip(e,t,"tip-container success"),utils.removeClass(e,s.failedClass),utils.addClass(e,s.passClass)},s.ajaxSubmit=function(e,t){for(var n="",i=0;i<e.length;i++){if(e[i].name){var r;if("SELECT"===e[i].tagName)for(var a=e[i].options,o=0;o<a.length;o++)a[o].selected&&(r=a[o].value,n+=e[i].name+"="+encodeURIComponent(r)+"&");else"checkbox"===e[i].type||"radio"===e[i].type?e[i].checked&&(r=e[i].value,n+=e[i].name+"="+encodeURIComponent(r)+"&"):(r=e[i].value,n+=e[i].name+"="+encodeURIComponent(r)+"&")}if("submit"===e[i].type){var l=e[i],c="BUTTON"===l.tagName?"innerHTML":"value",d=l[c];l.disabled="disabled",l[c]=s.submitingText}}var p=new XMLHttpRequest;p.open("POST",t,!0),p.setRequestHeader("Content-type","application/x-www-form-urlencoded"),p.send(n),p.onreadystatechange=function(){if(4===p.readyState)if(s.removeTips(),l[c]=d,l.disabled=!1,u.complete&&"function"==typeof u.complete&&u.complete(),200===p.status)try{var e=JSON.parse(p.responseText);u.callback&&u.callback(e),EC.trigger("submit_success",e)}catch(t){throw new Error(t.message)}else u.errCallback&&u.errCallback(n),EC.trigger("submit_error",n)}},this.submit=function(e){var t=[],n=s.root.getElementsByTagName("form")[0].elements,i=s.action||s.root.getAttribute("action"),r=i;if(u.valid)for(var a=0;a<n.length;a++)o(t,n[a]);if(!t.length)try{u.beforeSubmit&&u.beforeSubmit(t)}catch(e){t.push(e)}return console.log(t),t.length?!1:u.normalSubmit?(s.root.firstChild.setAttribute("action",i),!0):(e.preventDefault(),void s.ajaxSubmit(n,r))}.bind(this),s.Validation=function(e,t,n){this.msg=[],this.validTip=function(){this.msg.length?(s.onValidRefuse(n,this.msg[0]),e.push(t)):u.forbidTips?s.removeTip(n):s.onValidPass(n,s.successTips)}},s.rulesConfig={email:{regexp:/^([a-zA-Z0-9_\-\.])+\@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/,msg:s.emailWarning},present:{regexp:/\S+/,msg:s.presentWarning},url:{regexp:/((http|ftp|https|file):\/\/([\w\-]+\.)+[\w\-]+(\/[\w\u4e00-\u9fa5\-\.\/?\@\%\!\&=\+\~\:\#\;\,]*)?)/,msg:s.urlWarning},mobile:{regexp:/^1[3|4|5|8][0-9]\d{4,8}$/,msg:s.mobileWarning}},s.valid=function(e,t,n){if(s.rules[e]){var i=s.rules[e](n);return i===!0?s.comparator("string").handler(t,n):t.msg.push(i),t}},s.validNumRange=function(e,t){var n=p[t.valid.toUpperCase()];return n.test(t.value)?s.comparator("number").handler(e,t):e.msg.push(s.numWarning),e},s.validUnion=function(e,t,n,i){if(i.vr){var r=i.vr.split("::"),a=r[0],o=r[1]?r[1].split(","):void 0,s=!1;try{s=iToolkit[a].apply(n,o)}catch(l){throw s=!1,l}s||e.msg.push("")}return e},s.validEmpty=function(e,t){return""===t.value&&e.msg.push(s.presentWarning),e},s.on("mount",function(){s.init()}),s.init=function(){for(i in u)c.indexOf(i)<0&&(s[i]=s.hasOwnProperty(i)?utils.deepCopy(u[i],s[i]):u[i]);s.data=u.data,s.rules={};for(ruleConfig in s.rulesConfig)utils.isObject(s.rulesConfig[ruleConfig])?!function(e){s.rules[e]=function(t){return t.value.match(s.rulesConfig[e].regexp)?!0:s.rulesConfig[e].msg}}(ruleConfig):utils.isFunction(s.rulesConfig[ruleConfig])&&(s.rules[ruleConfig]=s.rulesConfig[ruleConfig])}}),riot.tag("itk-keyboard","<yield></yield>",function(){var e,t=this,n=(t.root,t.opts.opts||t.opts);e=n.keyboardTriggerId?t[n.keyboardTriggerId]?t[n.keyboardTriggerId]:document.getElementById(n.keyboardTriggerId):window,t.keyboardTrigger=e,t.mixin("itk-keyboard");for(x in n.handleMap)t.on(x,n.handleMap[x])}),riot.tag("itk-modal",'<div class="itk-modal-dialog" riot-style="width:{width}; height:{height}"> <div class="itk-modal-title"> <span>{ title }</span> <div class="itk-modal-close-wrap" onclick="{ close }"> <div class="itk-modal-close"></div> </div> </div> <div class="itk-modal-container"> <yield> </div> <div class="itk-modal-footer"> <button class="itk-cancle-btn" onclick="{ close }">取消</button> <button class="itk-submit-btn" onclick="{ confirm }">确认</button> </div> </div>',function(){{var e=this,t=e.opts.opts||e.opts;e.root}for(i in t)e[i]=t[i];e.width=t.width||600,e.height=t.height||"auto",e.on("mount",function(){var n=e.root.querySelector(".itk-modal-container"),i=e.root.querySelector(".itk-modal-title"),r=e.root.querySelector(".itk-modal-footer");e.hideFooter&&(r.style.display="none");var a=parseInt(window.getComputedStyle(i,null).height.replace("px","")),o=parseInt(window.getComputedStyle(r,null).height.replace("px",""));t.height&&(n.style.height=e.height-o-a-2+"px")}),document.querySelector("[modal-open-target='"+e.root.id+"']")&&(document.querySelector("[modal-open-target='"+e.root.id+"']").onclick=function(){e.root.style.display="block",e.onOpen&&e.onOpen()}),e.root.open=function(){e.root.style.display="block",e.onOpen&&e.onOpen()},e.close=e.root.close=function(){e.root.style.display="none",e.onClose&&e.onClose()},e.loadData=e.root.loadData=function(t,n){n=n||"data",e[n]=t,e.update()},e.confirm=e.root.confirm=function(){e.close(),e.onSubmit&&e.onSubmit()}}),riot.tag("itk-paginate",'<div onselectstart="return false" ondragstart="return false"> <div class="itk-paginate"> <li onclick="{ goFirst }">«</li> <li onclick="{ goPrev }">‹</li> </div> <ul class="itk-paginate"> <li each="{ pages }" onclick="{ parent.changePage }" class="{ active: parent.currentPage == page }">{ page }</li> </ul> <div class="itk-paginate"> <li onclick="{ goNext }">›</li> <li onclick="{ goLast }">»</li> </div> <div class="itk-paginate"> <form onsubmit="{ redirect }" style="position:relative;"> <span class="redirect" if="{ redirect }">跳转到<input class="jumpPage" name="page" riot-type={"number"} style="width: 40px;">页 </span> <div class="itk-paginate-tips" riot-style="top: { tipsTop }; left: { tipsLeft }; display: { showTip }"> 请输入1～{ pageCount }之间的数字 </div> <span class="page-sum" if="{ showPageCount }"> 共<em>{ pageCount }</em>页 </span> <span class="item-sum" if="{ showItemCount }"> <em>{ count }</em>条 </span> <input type="submit" style="display: none;"> </form> </div> </div>',function(){var e=this,t=e.root,n=e.opts.opts||e.opts;if(e.showTip="none",e.count=n.count||0,e.pagesize=n.pagesize||20,e.pageCount=n.pageCount||Math.ceil(e.count/e.pagesize)||1,e.currentPage=n.currentPage||1,e.url=n.url||"",e.showNumber=n.showNumber||5,e.redirect=n.redirect||!0,e.showPageCount=n.showPageCount||!0,e.showItemCount=n.showItemCount||!0,e.needInit=n.needInit||!1,e.updateCurrentPage=function(){if(e.currentPage>Math.ceil(e.showNumber/2)&&e.pageCount>e.showNumber){if(e.pages=[],e.pageCount-e.currentPage>2)var t=e.currentPage-Math.ceil(e.showNumber/2),n=e.currentPage+Math.floor(e.showNumber/2);else var n=e.pageCount,t=e.pageCount-e.showNumber;for(i=t;n>i;i++)e.pages.push({page:i+1}),e.update()}else if(e.currentPage<Math.ceil(e.showNumber/2)+1&&e.pageCount>e.showNumber){for(e.pages=[],i=0;i<e.showNumber;i++)e.pages.push({page:i+1});e.pages.push({page:"..."})}},t.addCount=function(t){var i=e.count+t,r=e.pageCount;if(e.count=0>i?0:i,e.pageCount=Math.ceil(e.count/e.pagesize)||1,e.currentPage=e.currentPage>e.pageCount?e.pageCount:e.currentPage,e.pageCount<=e.showNumber){e.pages=[];for(var a=0;a<e.pageCount;a++)e.pages.push({page:a+1})}(e.needInit||e.pageCount<r&&e.currentPage<=e.pageCount)&&n.callback(e.currentPage),e.pageChange(e.currentPage),e.update()},e.pages=[],e.pageCount<e.showNumber+1)for(i=0;i<e.pageCount;i++)e.pages.push({page:i+1});else{for(i=0;i<e.showNumber;i++)e.pages.push({page:i+1});e.pages.push({page:"..."})}e.needInit&&n.callback(e.currentPage),e.updateCurrentPage(),e.update(),this.goFirst=function(){e.pageChange(1)}.bind(this),this.goPrev=function(){e.currentPage>1&&e.pageChange(e.currentPage-1)}.bind(this),this.goNext=function(){e.currentPage<e.pageCount&&e.pageChange(e.currentPage+1)}.bind(this),this.goLast=function(){e.pageChange(e.pageCount)}.bind(this),this.redirect=function(){var t=parseInt(e.page.value,10);t&&t<e.pageCount+1&&t>0?e.pageChange(parseInt(t,10)):(e.tipsLeft=e.page.offsetLeft,e.tipsTop=e.page.offsetTop+e.page.offsetHeight+8,e.showTip="block",setTimeout(function(){e.showTip="none",e.update()},1500),e.update())}.bind(this),this.changePage=function(t){var n=t.item.page;return"string"==typeof n?!1:void e.pageChange(n)}.bind(this),e.pageChange=function(t){e.currentPage!=t&&(e.currentPage=t,n.callback(t)),e.updateCurrentPage()}}),riot.tag("itk-select",'<yield></yield> <ul class="itk-selected-container" onmousedown="{ showOptions }"> <li class="itk-selected-option" each="{realData }" if="{ selected && parent.mutiple}"> { name } <span class="itk-close" onmousedown="{ cancel }" >×</span> </li> <li class="itk-single-option" each="{ realData }" if="{ selected && !parent.mutiple}"> { name } </li> <li class="itk-search-wrap"> <input type="text" class="form-control itk-select-search" oninput="{ filter }" onfocus="{ filter }" onkeyup="{ keyboardHandle }"> </li> </ul> <ul class="itk-options-container"> <li class="itk-options" each="{ realData }" onmousedown="{ toggle }" if="{ !hide }"> <span class="itk-option-check" if="{ selected }"></span> <span class="empty-icon" if="{ !selected }"></span> { name } </li> <li class="no-result" if="{ noResult }">无搜索结果</li> </ul>',function(){var e=this,t=e.opts.opts||e.opts;e.gotOptions=!1,e.chooseOnce=!0,e.init=e.root.init=function(){e.gotOptions=!1,e.update()},e.realData=[],e.root.exportData=e.realData,e.initData=e.root.initData=function(){if(e.root.querySelector("select")){var t=e.root.querySelector("select").querySelectorAll("option"),n=e.root.querySelector("select").hasAttribute("mutiple");n?e.mutiple=!0:(e.mutiple=!1,e.noSearch=!0)}if(t&&t.length&&!e.gotOptions){for(e.options=t,e.searchInput=e.root.querySelector(".itk-select-search"),e.optionsWrap=e.root.querySelector(".itk-options-container"),e.realData=[],i=0;i<t.length;i++)e.realData.push({name:t[i].innerHTML,value:t[i].getAttribute("value"),selected:t[i].getAttribute("selected"),index:i});e.searchInput.onfocus=function(){e.optionsWrap.style.display="block"},e.searchInput.onblur=function(){e.optionsWrap.style.display="none",e.searchInput.value="",e.resetSelectOpt()},e.noSearch&&(e.searchInput.style.width="0px"),e.gotOptions=!0,e.update()}},e.on("update",function(){setTimeout(function(){e.initData()},0)}),e.on("mount",function(){if(t){for(var n in t)e[n]=t[n];e.update()}}),e.filter=function(t){e.resetSelectOpt();var n=t.target.value;t.target.style.width=.9*n.length+1+"em";var r;for(i=0;i<e.realData.length;i++)e.realData[i].name.match(n)?(e.realData[i].hide=!1,r=!0):e.realData[i].hide=!0;e.noResult=!r},e.toggle=function(t){if(e.mutiple)t.item.selected?(t.item.selected=!1,e.options[t.item.index].selected=!1):(t.item.selected=!0,e.options[t.item.index].selected=!0);else{for(i=0;i<e.realData.length;i++)e.realData[i].selected=!1,e.options[i].selected=!1;t.item.selected=!0,e.options[t.item.index].selected=!0}e.update(),e.chooseOnce&&e.searchInput.blur()},e.cancel=function(t){t.stopPropagation(),t.item.selected=!1,e.options[t.item.index].selected=!1,e.update()},e.showOptions=function(){e.searchInput&&e.searchInput!==document.activeElement?e.searchInput.focus():e.searchInput.blur()},e.keyboardHandle=function(t){var n=t.target;n.options=e.root.querySelectorAll(".itk-options"),void 0===n.seletedIndex&&(n.seletedIndex=-1);var i=t.keyCode;37===i||38===i?(e.clearSelectedOpt(n),n.seletedIndex--,n.seletedIndex<0&&(n.seletedIndex=n.options.length-1),e.setSelectedOpt(n)):39===i||40===i?(e.clearSelectedOpt(n),n.seletedIndex++,n.seletedIndex>=n.options.length&&(n.seletedIndex=0),e.setSelectedOpt(n)):13===i?e.chooseByKeyboard(n):27===i&&e.searchInput.blur()},e.chooseByKeyboard=function(e){var t=document.createEvent("MouseEvents"),n=e.options[e.seletedIndex];t.initEvent("mousedown",!0,!0),n&&n.dispatchEvent(t)},e.clearSelectedOpt=function(e){if(e.options){var t=e.options[e.seletedIndex];e.seletedIndex>=0&&t&&(t.style.background="",t.scrollIntoView())}},e.resetSelectOpt=function(){e.clearSelectedOpt(e.searchInput),e.searchInput.seletedIndex=-1},e.setSelectedOpt=function(e){var t=e.options[e.seletedIndex];t&&(t.style.background="#eff3f8",t.scrollIntoView())}}),riot.tag("itk-slide"," <yield>",function(){for(var e=this,t=e.root,n=e.opts.opts||e.opts,i=document.scripts,r="",a="",o=0;o<i.length;o++)if(i[o].src&&/itoolkit.min.js|itoolkit.js/.test(i[o].src)){a=i[o].src.replace(/itoolkit.min.js|itoolkit.js/,"");break}r=a+"plugins/",e.loadSource=function(e){utils.jsLoader([e+"slick/slick.css",e+"slick/slick-theme.css",e+"slick/slick.js"],function(){$(t).slick(n),t.style.visibility="visible"})},"undefined"==typeof jQuery?utils.jsLoader([r+"jquery/jquery-1.12.0.min.js"],function(){e.loadSource(r)}):e.loadSource(r)}),riot.tag("itk-table","<yield>",function(){var e=this,t=e.opts.opts||e.opts,n=e.root;e.init=function(){n.style.display="block";for(i in t)e[i]||(e[i]=t[i]);e.originData=utils.deepCopy(e.data),e.update()},e.on("mount",function(){e.init()}),e.compare=function(t,n){return t[e.orderkeyName]>n[e.orderkeyName]?1:t[e.orderkeyName]===n[e.orderkeyName]?0:-1},e.clearOrder=function(){e.ordered=!1,e.reversed=!1},e.loadData=n.loadData=function(t){return e.data=t,e.originData=utils.deepCopy(t),e.update(),e.data},e.exportData=n.exportData=function(){return e.data},e.reset=n.reset=function(){e.data=utils.deepCopy(e.originData),e.update()},e.orderBy=function(t){return function(){return e.orderkeyName=t,e.ordered!==t&&(e.data=e.reversed!==t?e.data.sort(e.compare):e.data.reverse(),e.ordered=t,e.reversed=!1,e.update()),e.data}},n.orderBy=function(t){e.orderBy(t)()},e.reverseBy=function(t){return function(){return e.orderkeyName=t,e.reversed!==t&&(e.ordered!==t?(e.data=e.data.sort(e.compare),e.data=e.data.reverse()):e.data=e.data.reverse(),e.ordered=!1,e.reversed=t,e.update()),e.data}},n.reverseBy=function(t){e.reverseBy(t)()},e.toggleBy=function(t){return e.ordered===t?e.reverseBy(t):e.orderBy(t)},n.toggleBy=function(t){e.ordered===t?n.reverseBy(t):n.orderBy(t)},e.append=function(t){return function(){e.clearOrder(),utils.isObject(t)?e.data.push(t):utils.isArray(t)&&(e.data=e.data.concat(t)),e.update()}},n.append=function(t){e.append(t)()},e.prepend=function(t){return function(){e.clearOrder(),utils.isObject(t)?e.data.unshift(t):utils.isArray(t)&&(e.data=t.concat(e.data)),e.update()}},n.prepend=function(t){e.prepend(t)()},e.deleteBy=function(t,n){return function(){if(t&&n){e.clearOrder();for(var i=0;i<e.data.length;i++)e.data[i][t]===n&&(e.data.splice(i,1),i-=1);e.update()}}},n.deleteBy=function(t,n){e.deleteBy(t,n)()}}),riot.tag("itk-tree-item",'<input type="checkbox" __checked="{ item.selected }" if="{ parent.rootConfig.showCheck }" onchange="{ checkHandle }"> <i class="tree-item-{ iconType } { open: item.opened }" onclick="{ toggle }" if="{ item.children }"></i> <i class="tree-item-icon" if="{ item.children }"></i> <i class="tree-no-{ iconType }" if="{ !item.children }"></i> <div onclick="{ leftClick }">{ item.name }</div>',function(){var e=this;e.iconType=e.parent.rootConfig.iconType||"arrow",e.selectchildren=function(t,n){var i=function(e){if(e&&e.children)for(var t=0;t<e.children.length;t++)e.children[t].selected=n,i(e.children[t])};i(t,n),e.parent.treeroot.update()},e.cancelParent=function(t){var n=function(e){e&&e.pnode&&(e.pnode.selected=!1,n(e.pnode))};n(t),e.parent.treeroot.update()},this.checkHandle=function(t){var n=e.parent.rootConfig,i=n.onCheck,r=n.onUnCheck;e.item.selected?(e.item.selected=!1,r&&r(e.item,t.target),n.link&&(e.selectchildren(e.item,!1),e.cancelParent(e.item))):e.item.selected||(e.item.selected=!0,i&&i(e.item,t.target),n.link&&e.selectchildren(e.item,!0))}.bind(this),this.toggle=function(){e.item.opened=e.item.opened===!0?!1:!0,e.parent.treeroot.update()}.bind(this),this.leftClick=function(t){var n=e.parent.rootConfig;if(n.folder&&n.children)e.item.opened=e.item.opened===!0?!1:!0;else{var i=n.onLeftClick;i&&i(e.item,t.target)}}.bind(this)}),riot.tag("itk-tree",'<div class="tree-item-wrap" each="{ item, i in data }" onselectstart="return false" ondragstart="return false"> <itk-tree-item class="tree-item-row { root: item.level==1 }" riot-style="padding-left: { countPadding(item.level) }"></itk-tree-item> <ul class="tree-child-wrap" if="{ item.opened && item.children }"> <itk-tree data="{ item.children }"></itk-tree> </ul> </div>',function(){var e=this;if(e.config=e.opts.opts||e.opts,e.dataHandle=function(t,n,i){var t=t||[],r=n||"id",a=i||"pid",o={};t.forEach(function(t){e.config.name&&(t.name=t[e.config.name]),o[t[r]]=t});var s=[];t.forEach(function(e){var t=o[e[a]];t?(t.children||(t.children=[]),e.pnode=t,t.children.push(e)):s.push(e)});var l=function(t,n){var n=n+1;t.forEach(function(t){t.level=n-1,t.level<e.config.openLevel+1&&(t.opened=!0),t.children&&l(t.children,n)})};return l(s,1),s},e.parent&&"ITK-TREE"===e.parent.root.tagName)e.data=e.config.data,e.rootConfig=e.parent.rootConfig||e.parent.parent.rootConfig,e.treeroot=e.parent.treeroot||e.parent.parent.treeroot;else{if(e.config.handleData){var t=e.dataHandle(e.config.data);e.data=t}e.rootConfig=e.config,e.treeroot=e}e.treeroot.update(),this.countPadding=function(t){var n=e.rootConfig.padding||20;return(t-1)*n+"px"}.bind(this)}),riot.tag("itk-uploader",'<yield> <div class="itk-uploader-btn" name="uploadBtn"> <span class="icon"></span> <span class="text">{ text }</span> </div>',function(){var e=this,t=e.root,n=e.opts.opts||e.opts;e.text=n.buttonText||"上传文件",e.mixin("itk-keyboard"),e.on("Backspace",function(){alert("外面的 enter")}),e.on("space",function(){alert("外面的 space")});for(var i=document.scripts,r="",a=0;a<i.length;a++)if(i[a].src&&/itoolkit.min.js|itoolkit.js/.test(i[a].src)){r=i[a].src.replace(/itoolkit.min.js|itoolkit.js/,"");break}path=r+"plugins/uploader/";var o=[path+"SimpleAjaxUploader.min.js"];e.on("mount",function(){var e=t.querySelector(".itk-uploader-btn");t.firstElementChild!==e||n.btn?t.firstElementChild===e||n.btn||(e=t.firstElementChild):e.style.display="inline-block",utils.jsLoader(o,function(){var t={};t.button=n.btn||e,t.url=n.url?n.url:"",t.name=n.name?n.name:"",t.multipart=n.multipart?n.multipart:!0,t.responseType=n.responseType?n.responseType:"",t.startXHR=n.startXHR?n.startXHR:null,t.onSubmit=n.onSubmit?n.onSubmit:null,t.onComplete=n.onComplete?n.onComplete:null,t.onError=n.onError?n.onError:null;new ss.SimpleUpload(t)})})}),riot.mixin("itk-keyboard",{init:function(){var e=this,t={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Caps Lock",27:"Escape",32:"Space",33:"Page Up",34:"Page Down",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",42:"Print Screen",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Windows",93:"Right Click",96:"Numpad 0",97:"Numpad 1",98:"Numpad 2",99:"Numpad 3",100:"Numpad 4",101:"Numpad 5",102:"Numpad 6",103:"Numpad 7",104:"Numpad 8",105:"Numpad 9",106:"Numpad *",107:"Numpad +",109:"Numpad -",110:"Numpad .",111:"Numpad /",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Num Lock",145:"Scroll Lock",182:"My Computer",183:"My Calculator",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"};riot.observable(e);var n;n=e.keyboardTrigger?e.keyboardTrigger:window,n.addEventListener("keydown",function(n){if(n.ctrlKey||n.altKey||n.shiftKey){var i=[];n.ctrlKey&&i.push("Ctrl"),n.altKey&&i.push("Alt"),n.shiftKey&&i.push("Shift");var r="";if(16!=n.which&&17!=n.which&&18!=n.which){for(var a=0;a<i.length;a++)"Ctrl"===i[a]&&(r+="Ctrl+");for(var a=0;a<i.length;a++)"Alt"===i[a]&&(r+="Alt+");for(var a=0;a<i.length;a++)"Shift"===i[a]&&(r+="Shift+");r+=t[n.which],console.log("键盘组合的 string 是:"+r+",触发这个事件"),e.trigger(r)}}else for(x in t)n.which==x&&e.trigger(t[x])})}});