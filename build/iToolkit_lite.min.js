/**
 * iToolkit-lite v1.0.0
 * Revised in 2015-08-27 14:49:32
 * Released under the ISC License.
 */

!function(e){"use strict";function t(e){var t=$(0),n=e.slice(t.length).match(/\s*(\S+?)\s*(?:,\s*(\S)+)?\s+in\s+(.+)/);return n?{key:n[1],pos:n[2],val:t+n[3]}:{val:e}}function n(e,t,n){var i={};return i[e.key]=t,e.pos&&(i[e.pos]=n),i}function i(e,i,r){d(e,"each");var a,s=e.outerHTML,u=e.parentNode,l=document.createComment("riot placeholder"),c=[],f=k(e);u.insertBefore(l,e),r=t(r),i.one("premount",function(){u.stub&&(u=i.root),e.parentNode.removeChild(e)}).on("update",function(){var t,d=W(r.val,i);if(!M(d)){if(t=a,a=d?JSON.stringify(d):"",a===t)return;d=d?Object.keys(d).map(function(e){return n(r,e,d[e])}):[]}for(var p=document.createDocumentFragment(),g=c.length,v=d.length;g>v;)c[--g].unmount();for(c.length=v,t=!a&&!!r.key,g=0;v>g;++g){var h=t?n(r,d[g],g):d[g];c[g]||((c[g]=new o({tmpl:s},{parent:i,isLoop:!0,root:u,item:h})).mount(),p.appendChild(c[g].root)),c[g]._item=h,c[g].update(h)}u.insertBefore(p,l),f&&(i.tags[m(e)]=c)}).one("updated",function(){var e=Object.keys(i);h(u,function(t){1!=t.nodeType||t.isLoop||t._looped||(t._visited=!1,t._looped=!0,x(t,i,e))})})}function r(e,t,n){h(e,function(e){if(1==e.nodeType){e.isLoop=e.parentNode&&e.parentNode.isLoop||e.getAttribute("each")?1:0;var i=k(e);if(i&&!e.isLoop){for(var r,a=new o(i,{root:e,parent:t},e.innerHTML),s=m(e),u=t;!k(u.root)&&u.parent;)u=u.parent;a.parent=u,r=u.tags[s],r?(M(r)||(u.tags[s]=[r]),u.tags[s].push(a)):u.tags[s]=a,e.innerHTML="",n.push(a)}e.isLoop||x(e,t,[])}})}function a(e,t,n){function r(e,t,i){if(t.indexOf($(0))>=0){var r={dom:e,expr:t};n.push(g(r,i))}}h(e,function(e){var n=e.nodeType;if(3==n&&"STYLE"!=e.parentNode.tagName&&r(e,e.nodeValue),1==n){var a=e.getAttribute("each");return a&&a.match(/\{[\s\S]+\}/)?(i(e,t,a),!1):(c(e.attributes,function(t){var n=t.name,i=n.split("__")[1];return r(e,t.value,{attr:i||n,bool:i}),i?(d(e,n),!1):void 0}),k(e)?!1:void 0)}})}function o(e,t,n){function i(){c(E.attributes,function(e){f[e.name]=W(e.value,m||u)}),c(Object.keys(k),function(e){f[e]=W(k[e],m||u)})}function o(e){if(c(x,function(t){t[e?"mount":"unmount"]()}),m){var t=e?"on":"off";h?m[t]("unmount",u.unmount):m[t]("update",u.update)[t]("unmount",u.unmount)}}var s,u=_.observable(this),f=N(t.opts)||{},d=v(e.tmpl),m=t.parent,h=t.isLoop,y=t.item,C=[],x=[],E=t.root,w=e.fn,A=E.tagName.toLowerCase(),k={},S=/([\w\-]+)\s?=\s?['"]([^'"]+)["']/gim;if(w&&E._tag&&E._tag.unmount(!0),this.isMounted=!1,e.attrs){var L=e.attrs.match(S);c(L,function(e){var t=e.split(/\s?=\s?/);E.setAttribute(t[0],t[1].replace(/['"]/g,""))})}E._tag=this,this._id=p(~~((new Date).getTime()*Math.random())),g(this,{parent:m,root:E,opts:f,tags:{}},y),c(E.attributes,function(e){var t=e.value;$(/\{.*\}/).test(t)&&(k[e.name]=t)}),d.innerHTML&&!/select|select|optgroup|tbody|tr/.test(A)&&("TABLE-VIEW"!==E.tagName,d.innerHTML=T(d.innerHTML,n)),this.update=function(e){g(u,e),i(),u.trigger("update",e),l(C,u,e),u.trigger("updated")},this.mixin=function(){c(arguments,function(e){e="string"==typeof e?_.mixin(e):e,c(Object.keys(e),function(t){"init"!=t&&(u[t]="function"==typeof e[t]?e[t].bind(u):e[t])}),e.init&&e.init.bind(u)()})},this.mount=function(){if(i(),w&&w.call(u,f),o(!0),a(d,u,C),u.parent||u.update(),u.trigger("premount"),h)u.root=E=s=d.firstChild;else{for(;d.firstChild;)E.appendChild(d.firstChild);E.stub&&(u.root=E=m.root)}!u.parent||u.parent.isMounted?(u.isMounted=!0,u.trigger("mount")):u.parent.one("mount",function(){b(u.root)||(u.parent.isMounted=u.isMounted=!0,u.trigger("mount"))})},this.unmount=function(e){var t=s||E,n=t.parentNode;if(n){if(m)M(m.tags[A])?c(m.tags[A],function(e,t){e._id==u._id&&m.tags[A].splice(t,1)}):m.tags[A]=void 0;else for(;t.firstChild;)t.removeChild(t.firstChild);e||n.removeChild(t)}u.trigger("unmount"),o(),u.off("*"),E._tag=null},r(d,this,x)}function s(t,n,i,r,a){i[t]=function(t){t=t||e.event,t.which||(t.which=t.charCode||t.keyCode),t.target||(t.target=t.srcElement);try{t.currentTarget=i}catch(o){}if(t.item=r._item?r._item:a,n.call(r,t)===!0||/radio|check/.test(i.type)||(t.preventDefault&&t.preventDefault(),t.returnValue=!1),!t.preventUpdate){var s=a?r.parent:r;s.update()}}}function u(e,t,n){e&&(e.insertBefore(n,t),e.removeChild(t))}function l(e,t,n){c(e,function(e,i){var r=e.dom,a=e.attr,o=W(e.expr,t),l=e.dom.parentNode;if(null==o&&(o=""),l&&"TEXTAREA"==l.tagName&&(o=o.replace(/riot-/g,"")),e.value!==o){if(e.value=o,!a)return r.nodeValue=o.toString();if(d(r,a),"function"==typeof o)s(a,o,r,t,n);else if("if"==a){var c=e.stub;o?c&&(u(c.parentNode,c,r),r.inStub=!1,b(r)||h(r,function(e){e._tag&&!e._tag.isMounted&&(e._tag.isMounted=!!e._tag.trigger("mount"))})):(c=e.stub=c||document.createTextNode(""),u(r.parentNode,r,c),r.inStub=!0)}else if(/^(show|hide)$/.test(a))"hide"==a&&(o=!o),r.style.display=o?"":"none";else if("value"==a)r.value=o;else if("riot-"==a.slice(0,5)&&"riot-tag"!=a)a=a.slice(5),o?r.setAttribute(a,o):d(r,a);else{if(e.bool){if(r[a]=o,!o)return;o=a}"object"!=typeof o&&r.setAttribute(a,o)}}})}function c(e,t){for(var n,i=0,r=(e||[]).length;r>i;i++)n=e[i],null!=n&&t(n,i)===!1&&i--;return e}function f(e){return"function"==typeof e||!1}function d(e,t){e.removeAttribute(t)}function p(e){return(e^e>>31)-(e>>31)}function m(e){var t=k(e),n=e.getAttribute("name"),i=n&&n.indexOf($(0))<0?n:t.name;return i}function g(e){for(var t,n=arguments,i=1;i<n.length;++i)if(t=n[i])for(var r in t)e[r]=t[r];return e}function v(e){var t=O&&10>O,n=/^\s*<([\w-]+)/.exec(e),i=n?n[1].toLowerCase():"",r="th"===i||"td"===i?"tr":"tr"===i?"tbody":"div",a=y(r);return a.stub=!0,t&&("optgroup"===i?A(a,e):"option"===i?w(a,e):"div"!==r?E(a,e,i):t=0),t||(a.innerHTML=e),a}function h(e,t){if(e)if(t(e)===!1)h(e.nextSibling,t);else for(e=e.firstChild;e;)h(e,t),e=e.nextSibling}function b(e){for(;e;){if(e.inStub)return!0;e=e.parentNode}return!1}function y(e){return document.createElement(e)}function T(e,t){return e.replace(/<(yield)\/?>(<\/\1>)?/gim,t||"")}function C(e,t){return(t||document).querySelectorAll(e)}function N(e){function t(){}return t.prototype=e,new t}function x(e,t,n){c(e.attributes,function(i){if(!e._visited&&("id"===i.name||"name"===i.name)){e._visited=!0;var r,a=i.value;if(~n.indexOf(a))return;r=t[a],r?M(r)?r.push(e):t[a]=[r,e]:t[a]=e}})}function E(e,t,n){var i,r=y("div"),a=/td|th/.test(n)?3:2;for(r.innerHTML="<table>"+t+"</table>",i=r.firstChild;a--;)i=i.firstChild;e.appendChild(i)}function w(e,t){var n=y("option"),i=/value=[\"'](.+?)[\"']/,r=/selected=[\"'](.+?)[\"']/,a=/each=[\"'](.+?)[\"']/,o=/if=[\"'](.+?)[\"']/,s=/>([^<]*)</,u=t.match(i),l=t.match(r),c=t.match(s),f=t.match(a),d=t.match(o);n.innerHTML=c?c[1]:t,u&&(n.value=u[1]),l&&n.setAttribute("riot-selected",l[1]),f&&n.setAttribute("each",f[1]),d&&n.setAttribute("if",d[1]),e.appendChild(n)}function A(e,t){var n=y("optgroup"),i=/label=[\"'](.+?)[\"']/,r=/^<([^>]*)>/,a=/^<([^ \>]*)/,o=t.match(i),s=t.match(r),u=t.match(a),l=t;if(s){var c=t.slice(s[1].length+2,-u[1].length-3).trim();l=c}if(o&&n.setAttribute("riot-label",o[1]),l){var f=y("div");w(f,l),n.appendChild(f.firstChild)}e.appendChild(n)}function k(e){return I[e.getAttribute(H)||e.tagName.toLowerCase()]}function S(e){if(R=R||y("style"),document.head){if(R.styleSheet?R.styleSheet.cssText+=e:R.innerHTML+=e,!R._rendered)if(R.styleSheet)document.body.appendChild(R);else{var t=C("style[type=riot]")[0];t?(t.parentNode.insertBefore(R,t),t.parentNode.removeChild(t)):document.head.appendChild(R)}R._rendered=!0}}function L(e,t,n){var i=I[t],r=e._innerHTML=e._innerHTML||e.innerHTML;return e.innerHTML="",i&&e&&(i=new o(i,{root:e,opts:n},r)),i&&i.mount?(i.mount(),D.push(i),i.on("unmount",function(){D.splice(D.indexOf(i),1)})):void 0}var _={version:"v2.2.1",settings:{}},V="string",j="object",M=Array.isArray||function(){var e=Object.prototype.toString;return function(t){return"[object Array]"===e.call(t)}}(),O=function(e){return 0|(e&&e.document||{}).documentMode}(e);_.observable=function(e){e=e||{};var t={},n=0;return e.on=function(i,r){return f(r)&&(r._id="undefined"==typeof r._id?n++:r._id,i.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(r),r.typed=n>0})),e},e.off=function(n,i){return"*"==n?t={}:n.replace(/\S+/g,function(e){if(i)for(var n,r=t[e],a=0;n=r&&r[a];++a)n._id==i._id&&(r.splice(a,1),a--);else t[e]=[]}),e},e.one=function(t,n){function i(){e.off(t,i),n.apply(e,arguments)}return e.on(t,i)},e.trigger=function(n){for(var i,r=[].slice.call(arguments,1),a=t[n]||[],o=0;i=a[o];++o)i.busy||(i.busy=1,i.apply(e,i.typed?[n].concat(r):r),a[o]!==i&&o--,i.busy=0);return t.all&&"all"!=n&&e.trigger.apply(e,["all",n].concat(r)),e},e},_.mixin=function(){var e={};return function(t,n){return n?void(e[t]=n):e[t]}}(),function(e,t,n){function i(){return s.href.split("#")[1]||""}function r(e){return e.split("/")}function a(e){e.type&&(e=i()),e!=o&&(u.trigger.apply(null,["H"].concat(r(e))),o=e)}if(n){var o,s=n.location,u=e.observable(),l=n,c=!1,f=e.route=function(e){e[0]?(s.hash=e,a(e)):u.on("H",e)};f.exec=function(e){e.apply(null,r(i()))},f.parser=function(e){r=e},f.stop=function(){c&&(l.removeEventListener?l.removeEventListener(t,a,!1):l.detachEvent("on"+t,a),u.off("*"),c=!1)},f.start=function(){c||(l.addEventListener?l.addEventListener(t,a,!1):l.attachEvent("on"+t,a),c=!0)},f.start()}}(_,"hashchange",e);var R,$=function(e){var t,n,i,r=/[{}]/g;return function(a){var o=_.settings.brackets||e;return t!==o&&(t=o,i=o.split(" "),n=i.map(function(e){return e.replace(/(?=.)/g,"\\")})),a instanceof RegExp?o===e?a:new RegExp(a.source.replace(r,function(e){return n[~~("}"===e)]}),a.global?"g":""):i[a]}}("{ }"),W=function(){function t(e,t){return e=(e||$(0)+$(1)).replace($(/\\{/g),"￰").replace($(/\\}/g),"￱"),t=r(e,a(e,$(/{/),$(/}/))),new Function("d","return "+(t[0]||t[2]||t[3]?"["+t.map(function(e,t){return t%2?n(e,!0):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")':n(t[1])).replace(/\uFFF0/g,$(0)).replace(/\uFFF1/g,$(1))+";")}function n(e,t){return e=e.replace(/\n/g," ").replace($(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),""),/^\s*[\w- "']+ *:/.test(e)?"["+a(e,/["' ]*[\w- ]+["' ]*:/,/,(?=["' ]*[\w- ]+["' ]*:)|}|$/).map(function(e){return e.replace(/^[ "']*(.+?)[ "']*: *(.+?),? *$/,function(e,t,n){return n.replace(/[^&|=!><]+/g,i)+'?"'+t+'":"",'})}).join("")+'].join(" ").trim()':i(e,t)}function i(t,n){return t=t.trim(),t?"(function(v){try{v="+(t.replace(s,function(t,n,i){return i?"(d."+i+"===undefined?"+("undefined"==typeof e?"global.":"window.")+i+":d."+i+")":t})||"x")+"}catch(e){}finally{return "+(n===!0?'!v&&v!==0?"":v':"v")+"}}).call(d)":""}function r(e,t){var n=[];return t.map(function(t,i){i=e.indexOf(t),n.push(e.slice(0,i),t),e=e.slice(i+t.length)}),n.concat(e)}function a(e,t,n){var i,r=0,a=[],o=new RegExp("("+t.source+")|("+n.source+")","g");return e.replace(o,function(t,n,o,s){!r&&n&&(i=s),r+=n?1:-1,r||null==o||a.push(e.slice(i,s+o.length))}),a}var o={},s=/(['"\/]).*?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_$]\w*)/gi;return function(e,n){return e&&(o[e]=o[e]||t(e))(n)}}(),D=[],I={},H="riot-tag";_.tag=function(e,t,n,i,r){return f(i)&&(r=i,/^[\w\-]+\s?=/.test(n)?(i=n,n=""):i=""),n&&(f(n)?r=n:S(n)),I[e]={name:e,tmpl:t,attrs:i,fn:r},e},_.mount=function(e,t,n){function i(e){var t="";return c(e,function(e){t+=', *[riot-tag="'+e.trim()+'"]'}),t}function r(){var e=Object.keys(I);return e+i(e)}function a(e){if(e.tagName){t&&!e.getAttribute(H)&&e.setAttribute(H,t);var i=L(e,t||e.getAttribute(H)||e.tagName.toLowerCase(),n);i&&u.push(i)}else e.length&&c(e,a)}var o,s,u=[];if(typeof t===j&&(n=t,t=0),typeof e===V?("*"===e?e=s=r():e+=i(e.split(",")),o=C(e)):o=e,"*"===t){if(t=s||r(),o.tagName)o=C(t,o);else{var l=[];c(o,function(e){l.push(C(t,e))}),o=l}t=0}return o.tagName?a(o):c(o,a),u},_.update=function(){return c(D,function(e){e.update()})},_.mountTo=_.mount,_.util={brackets:$,tmpl:W},"object"==typeof exports?module.exports=_:"function"==typeof define&&define.amd?define(function(){return _}):e.riot=_}("undefined"!=typeof window?window:void 0);var utils={httpGet:function(e,t,n,i){var r=new XMLHttpRequest,e=utils.concatParams(e,t);r.open("GET",e,!0),r.send(null),r.onreadystatechange=function(){if(4===r.readyState&&(i&&"function"==typeof i&&i(),200===r.status)){var e=r.responseText;try{if("string"==typeof e)var t=JSON.parse(e);else var t=e}catch(a){alert("解析错误")}n(t)}}},httpPost:function(e,t,n,i){var r=new XMLHttpRequest;r.open("POST",e,!0),r.setRequestHeader("Content-type","application/json"),r.send(t),r.onreadystatechange=function(){if(4===r.readyState)if(i&&"function"==typeof i&&i(),200===r.status){try{var e=JSON.parse(r.responseText)}catch(t){console.log("解析错误")}n(e)}else console.log("网络错误")}},jsonp:function(e,t,n){var i=Date.now(),r=document.createElement("script"),a=document.getElementsByTagName("head")[0],e=utils.concatParams(e,t);if(t.callback)var o=e,s=t.callback;else{if(e.match(/\?/))var o=e+"&callback=jsonpCallback"+i;else var o=e+"?callback=jsonpCallback"+i;var s="jsonpCallback"+i}r.src=o,a.appendChild(r),window[s]=function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}n(e)},r.onerror=function(){console.log("jsonp error")},r.onload=function(){a.removeChild(r)}},htmlEncode:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText},concatParams:function(e,t){if(e.match(/\?/))var n="&";else var n="?";for(i in t)n=n+i+"="+t[i]+"&";return n=n.replace(/&$/,""),e+n},setCookie:function(e,t,n,i){var r=new Date,i=i||"/";r.setTime(r.getTime()+n),document.cookie=e+"="+escape(t)+";path="+i+";expires="+r.toGMTString()},transBytes:function(e){var t=["B","KB","MB","GB","TB"];if(0==e)return"n/a";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return 0==n?e+t[n]:(e/Math.pow(1024,n)).toFixed(1)+t[n]},transTimes:function(e){var e=parseInt(e,10),t=new Date(1e3*e),n=(new Date).getTime()/1e3,i=n-e;if(86400>i)return t.getHours()+":"+t.getMinutes();if(i>86400&&172800>i)return"昨天";if(i>172800){var r=(t.getFullYear()+"-").substring(2),a=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",o=t.getDate()<10?"0"+t.getDate():t.getDate();return r+a+o}},hasClass:function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(e,t){e.className.trim(),this.hasClass(e,t)||(e.className+=" "+t)},removeClass:function(e,t){if(utils.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},toggleClass:function(e,t){if(utils.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}else e.className+=" "+t},insertAfter:function(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)},insertAfterText:function(e,t){var n=t.parentNode;if(n.lastChild==t)n.appendChild(e);else{var i=t.nextSibling;3===i.nodeType&&(i=i.nextSibling),n.insertBefore(e,i)}},isType:function(e){return function(t){return toString.call(t)==="[object "+e+"]"}},makeArray:function(){return Array.prototype.concat(obj)},extend:function(e,t){for(var n in t)e[n]||(e[n]=t[n])}};utils.extend(utils,{isArray:utils.isType("Array"),isObject:utils.isType("Object"),isFunction:utils.isType("Function"),isElement:function(e){return-1!==toString.call(e).indexOf("Element")}}),utils.extend(utils,{jsLoader:function(){function e(){return d++}function t(e){return e.match(/\.css\??/)}function n(t){this.uri=t,this.cid=e(),this.status=T}function i(e,t){return i.then(e,t).start(),i}function r(e){throw e}function a(e){if(e||p.length)for(var t=0;t<e.task.length;t++){var n=e.task[t];s(n,e)}}function o(e,t){var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e.uri,c.appendChild(i),i=null,e.status=h,n.resolve.call(t)}function s(e,i){function r(t){if("error"===t.type&&(e.status=y),"load"===t.type&&(e.status=h),n.resolve.call(i,e),e.changeStatus){e.changeStatus=!1;for(var r=0;r<C[e.cid].length;r++){var a=C[e.cid][r];n.resolve.call(a.resolver,a.js)}C[e.cid]=null}s.onload=s.onerror=null,c.removeChild(s),s=null}if(g(e.uri))try{e.uri(),e.status=h,n.resolve.call(i)}catch(a){e.status=y,n.resolve.call(i)}else{if(e.status===h)return void n.resolve.call(i);if(t(e.uri))return void o(e,i);if(e.status===b)return e.changeStatus=!0,C[e.cid]=C[e.cid]||[],void C[e.cid].push({js:e,resolver:i});e.status=b;var s=document.createElement("script");s.async=!0,s.src=e.uri,s.onload=s.onerror=r,c.appendChild(s)}}function u(e){var t=l(e);return n.get(t?t:e)}function l(e){return i.alias[e]}var c=document.head||document.getElementsByTagName("head")[0],f={},d=0,p=[],m=utils.isArray,g=utils.isFunction,v=utils.makeArray,h="done",b="inprocess",y="rejected",T="pending",C={};return n.get=function(e){return f[e]||(f[e]=new n(e))},n.resolve=function(e){var t=this;if(t.status++,e&&e.status===y){var n=Error("Source: "+e.uri+" load failed");r(n)}t.status===t.task.length&&setTimeout(function(){t.callback&&t.callback(),t=null,a(p.shift())},7)},i.then=function(e,t){if(!e)return i;m(e)||(e=v(e));for(var n={task:[],callback:t,status:0},r=0;r<e.length;r++)n.task.push(u(e[r]));return p.push(n),i},i.start=function(){return a(p.shift()),i},i.alias={},i}()});var EventCtrl=EC=riot.observable(),iToolkit={};iToolkit.methodRegister=function(e,t){for(var n in iToolkit)if(e===n)return;iToolkit[e]=t},iToolkit.tableExtend={},riot.tag("super-div","<yield>","super-div{ display: block; }",function(e){var t=this,n=t.opts.opts||t.opts,r=t.root;for(i in n)t[i]=n[i];t.getData=function(e){var e=e||{};if(r.getAttribute("data-get"))var n="httpGet";else if(r.getAttribute("data-jsonp"))var n="jsonp";utils[n](t.superDivUrl,e,function(e){for(i in e)t.data={},t.data[i]=e[i];t.update()})},t.on("mount",function(){r.style.display="block",t.superDivUrl=r.getAttribute("data-get")||r.getAttribute("data-jsonp"),t.superDivUrl&&t.getData(n.params)}),t.loadData=r.loadData=function(e,n){n=n||"data",t[n]=e,t.update()},t.reload=r.reload=function(){t.superDivUrl?t.getData(n.params):t.update()}}),riot.tag("super-form",'<form onsubmit="{ submit }" > <yield> </form>',function(e){function t(e,t,n,i,r,a){var o=isNaN(e),s=isNaN(t),l=i.length;o||s?(o||(e>l?(r.push(a),u.onValidRefuse(n,u.minWarning(e))):u.onValidPass(n,u.successTips)),s||(l>t?(r.push(a),u.onValidRefuse(n,u.maxWarning(t))):u.onValidPass(n,u.successTips)),s&&o&&u.onValidPass(n,u.successTips)):l>t||e>l?(r.push(a),u.onValidRefuse(n,u.bpWarning(e,t))):u.onValidPass(n,u.successTips)}function n(e,t,n,i,r,a){var o=isNaN(e),s=isNaN(t),i=+i;o||s?(o||(e>i?(r.push(a),u.onValidRefuse(n,u.minNumWarning(e))):u.onValidPass(n,u.successTips)),s||(i>t?(r.push(a),u.onValidRefuse(n,u.maxNumWarning(t))):u.onValidPass(n,u.successTips)),s&&o&&u.onValidPass(n,u.successTips)):i>t||e>i?(r.push(a),u.onValidRefuse(n,u.numBpWarning(e,t))):u.onValidPass(n,u.successTips)}function r(e){s([],this)}function a(e){return toString.call(e).match(/\ (.*)\]/)[1]}function o(e){var t=a(e);return"Null"===t||"Undefined"===t||"Function"===t?e:new window[t](e)}function s(e,t){var t=t,n=t.getAttribute("valid"),i=t.getAttribute("customValid"),r=t.getAttribute("vr"),a=t.getAttribute("orient"),o=parseInt(t.getAttribute("max"),10),s=parseInt(t.getAttribute("min"),10),c=t.type,f=t.getAttribute("allowEmpty"),m=t.value,g=t.name,v=t;if(null!==f||!isNaN(o)||!isNaN(s)||null!==n||null!==i||null!==r||null!==a){if(f&&(""===m||"string"!=typeof m))return void u.onValidPass(v,u.successTips);if(g&&n){if("email"===n)m.match(/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/)?u.onValidPass(v,u.successTips):(e.push(g),u.onValidRefuse(v,u.emailWarning));else if("mobile"===n)m.match(/^1[3|4|5|8][0-9]\d{4,8}$/)?u.onValidPass(v,u.successTips):(e.push(g),u.onValidRefuse(v,u.mobileWarning));else if("url"===n)m.match(/((http|ftp|https|file):\/\/([\w\-]+\.)+[\w\-]+(\/[\w\u4e00-\u9fa5\-\.\/?\@\%\!\&=\+\~\:\#\;\,]*)?)/)?u.onValidPass(v,u.successTips):(e.push(g),u.onValidRefuse(v,u.urlWarning));else if("present"===n)m=m.replace(" ",""),m.length?p("string").handler(s,o,v,m,e,g):(e.push(g),u.onValidRefuse(v,u.presentWarning));else if(n.match(/^\/\S+\/$/)){n=n.replace(/^\//,""),n=n.replace(/\/$/,"");var h=new RegExp(n);h.test(m)?p("string").handler(s,o,v,m,e,g):(e.push(g),u.onValidRefuse(v,u.regWarning))}else if(d[n.toUpperCase()]){var h=d[n.toUpperCase()];h.test(m)?p("number").handler(s,o,v,m,e,g):(e.push(g),u.onValidRefuse(v,u.numWarning))}}else if(g&&!n)if(i){if(window[i]){var h=window[i].regExp,b=window[i].message||u.regWarning;h&&h.test(m)?p("string").handler(s,o,v,m,e,g):(e.push(g),u.onValidRefuse(v,b))}}else"text"===c&&p("string").handler(s,o,v,m,e,g);if(a){var y=l.querySelector(a);if(t===y||!y)return;t=y,r=t.getAttribute("vr")}if(!e.length&&r){var T=r.split("::"),C=T[0],N=T[1]?T[1].split(","):void 0,x=!1;try{iToolkit[C]&&(x=iToolkit[C].apply(t,N))}catch(E){throw x=!1,E}x||e.push("fail")}}}var u=this,l=u.root,c=u.opts.opts||u.opts,f=["insertTip","ajaxSubmit","submit","removeTips","insertTip","removeTip","loadData","getData","setData"],d={NON_NEGATIVE_INT:/^0$|^-[1-9]\d*$/,POSITIVE_INT:/^[1-9]\d*$/,NON_POSITIVE_INT:/^[1-9]\d*$|^0$/,NEGATIVE_INT:/^-[1-9]\d*$/,INT:/^-?[1-9]\d*$|^0$/,NON_NEGATIVE_FLOAT:/^(\d)(\.\d+)?$|^([1-9]\d*)(\.\d+)?$|^0$/,POSITIVE_FLOAT:/^(\d)(\.\d+)?$|^([1-9]\d*)(\.\d+)?$/,NON_POSITIVE_FLOAT:/^(-\d)(\.\d+)?$|^(-[1-9]\d*)(\.\d+)?$|^0$/,NEGATIVE_FLOAT:/^(-\d)(\.\d+)?$|^(-[1-9]\d*)(\.\d+)?$/,FLOAT:/^(-?\d)(\.\d+)?$|^(-?[1-9]\d*)(\.\d+)?$|^0$/};u.presentWarning="必填",u.emailWarning="邮箱格式错误",u.mobileWarning="手机格式错误",u.urlWarning="网址格式错误",u.successTips="通过",u.regWarning="字段不符合验证规则",u.numWarning="数字格式错误",u.passClass=c.passClass||"valid-pass",u.failedClass=c.failedClass||"valid-failed";var p=function(e){return{handler:function(i,r,a,o,s,u){switch(e){case"number":return n(i,r,a,o,s,u);case"string":default:return t(i,r,a,o,s,u)}}}};u.one("mount",function(){if(l.style.display="block",c.realTime&&c.valid)for(var e=u.root.getElementsByTagName("form")[0].elements,t=0,n=e.length;n>t;t++){var i=e[t].type;("submit"!==i||"button"!==i)&&(e[t].addEventListener("input",r,!1),("checkbox"===i||"radio"===i)&&e[t].addEventListener("change",r,!1),e[t].addEventListener("input",r,!1))}}),l.loadData=function(e,t){if(utils.isObject(e))for(var n in e)e[n]=o(e[n]);else e=o(e);t=t||"data",u[t]=e,u.update()},l.setData=function(e,t){u.data[t]=o(e),u.update()},u.checkExistKey=function(e,t,n){if(e.hasOwnProperty(t))if(utils.isArray(e[t]))e[t].push(n);else{var i=[];i.push(e[t]),i.push(n),e[t]=i}else e[t]=n},u.getData=l.getData=function(){for(var e=u.root.getElementsByTagName("form")[0].elements,t={},n=0;n<e.length;n++)if(e[n].name)if("SELECT"===e[n].tagName){var i=e[n].selectedOptions;for(j=0;j<i.length;j++)value=i[j].value,u.checkExistKey(t,e[n].name,encodeURIComponent(value))}else"checkbox"===e[n].type||"radio"===e[n].type?e[n].checked&&(value=e[n].value,u.checkExistKey(t,e[n].name,encodeURIComponent(value))):(value=e[n].value,u.checkExistKey(t,e[n].name,encodeURIComponent(value)));return t};for(i in c)f.indexOf(i)<0&&(u[i]=c[i]);u.data=c.data,u.submitingText=c.submitingText||"提交中...",void 0===c.valid&&(c.valid=!0),u.maxWarning=c.maxWarning||function(e){return"不得超过"+e+"个字符"},u.minWarning=c.minWarning||function(e){return"不得小于"+e+"个字符"},u.bpWarning=c.bpWarning||function(e,t){return"只允许"+e+"-"+t+"个字符"},u.minNumWarning=c.minNumWarning||function(e){return"不得小于"+e},u.maxNumWarning=c.maxNumWarning||function(e){return"不得大于"+e},u.numBpWarning=c.numBpWarning||function(e,t){return"输入数字应在"+e+"-"+t+"之间"},u.removeTips=l.removeTips=function(){function e(){for(r=0;r<i.length;r++)i[r].parentNode.removeChild(i[r]),i.length&&e()}var t=u.root,n=t.getElementsByTagName("form")[0].elements,i=t.getElementsByClassName("tip-container");i&&i.length&&e();for(var r=0;r<n.length;r++)utils.removeClass(n[r],u.passClass),utils.removeClass(n[r],u.failedClass)},u.removeTip=l.removeTip=function(e){var t=e.nextElementSibling;t&&t.className.match(/tip-container/)&&e.parentNode.removeChild(t),utils.removeClass(e,u.passClass),utils.removeClass(e,u.failedClass)},u.insertTip=l.insertTip=function(e,t,n){var i=e.nextElementSibling;i&&i.className.match(/tip-container/)&&e.parentNode.removeChild(i);var r=document.createElement("span");r.className=n,r.innerHTML=t,utils.insertAfterText(r,e)},u.onValidRefuse=l.onValidRefuse=c.onValidRefuse||function(e,t){u.insertTip(e,t,"tip-container"),utils.removeClass(e,u.passClass),utils.addClass(e,u.failedClass)},u.onValidPass=l.onValidPass=c.onValidPass||function(e,t){u.insertTip(e,t,"tip-container success"),utils.removeClass(e,u.failedClass),utils.addClass(e,u.passClass)},u.ajaxSubmit=function(e,t){for(var n="",i=0;i<e.length;i++){if(e[i].name)if("SELECT"===e[i].tagName){var r=e[i].selectedOptions;for(j=0;j<r.length;j++)value=r[j].value,n+=e[i].name+"="+encodeURIComponent(value)+"&"}else"checkbox"===e[i].type||"radio"===e[i].type?e[i].checked&&(value=e[i].value,n+=e[i].name+"="+encodeURIComponent(value)+"&"):(value=e[i].value,n+=e[i].name+"="+encodeURIComponent(value)+"&");if("submit"===e[i].type)if("BUTTON"===e[i].tagName){var a=e[i],o=a.innerHTML;a.disabled="disabled",a.innerHTML=u.submitingText}else{var a=e[i],o=a.value;a.disabled="disabled",a.value=u.submitingText}}var s=new XMLHttpRequest;s.open("POST",t,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(n),s.onreadystatechange=function(){if(4===s.readyState)if(u.removeTips(),"BUTTON"===a.tagName?a.innerHTML=o:a.value=o,a.disabled=!1,c.complete&&"function"==typeof c.complete&&c.complete(),200===s.status)try{var e=JSON.parse(s.responseText);c.callback&&c.callback(e),EC.trigger("submit_success",e)}catch(t){throw new Error(t.message)}else c.errCallback&&c.errCallback(n),EC.trigger("submit_error",n)}},this.submit=function(e){var t=[],n=u.root.getElementsByTagName("form")[0].elements,i=u.action||u.root.getAttribute("action"),r=i;if(c.valid)for(var a=0;a<n.length;a++)s(t,n[a]);if(!t.length)try{c.beforeSubmit&&c.beforeSubmit(t)}catch(e){t.push(e)}return t.length?!1:c.normalSubmit?(u.root.firstChild.setAttribute("action",i),!0):(e.preventDefault(),void u.ajaxSubmit(n,r))}.bind(this)});